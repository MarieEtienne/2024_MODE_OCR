---

title: "Modèles matriciels et applications"
group: "Rudy, Tanguy, Manon, Garan, Anaëlle, Oceane, Victor" 

bibliography: references.bib
execute: 
  freeze: auto
output: 
  html_document:
   toc: true
   toc_float: true
---

Le lien du site : https://zenodo.org/records/8251495 


Pistes 

Calcul 

Taux de succès 
Taux de survie

voir si habitat préférentiel, région,…
voir quelles facteurs expliquent taux de succès

voir si décalages entre dates de départ du nid -> facteurs expliquant 

voir si habitat préferentiel 

MAIS ATTENTION à ne pas être biaisé : du genre que des oiseaux d’une certaines espèces ne soit présents que dans un habitat

refaire analyse de bases cf ASA 

# Document R modifié et avec ajouts

## Import des données

**Do not forget to set your working directory in the right place**
**Menu : Session/Set Working Directory/Choose directory**
*And indicate Git/2024_MODE_OCR*


```{r}
# Datatset import under the name of "data"
data <- read.table("Bird_dataset.csv", sep=";", header = TRUE)
```

```{r}
# Charge the librairies
library(ggplot2)
library(corrplot)
library(dplyr)
```

```{r}
# View the firsts lignes of the dataset
head(data)
```


# ANOVA (Oceane  G.)


Analysis of variance (ANOVA) is one of the most widely used statistical methods in various disciplines. It allows to model the relationship between a quantitative dependent variable $Y$ according to the different modalities of one or more qualitative explanatory variables $Xs$.

We will performing an ANOVA to see the effect of qualitatives variables (state, habitat, species, year) on the quantitatives (initiation_date, number_fledged, nest_end_date) variables in the Bird_dataset.csv dataset.

  
## Effect on Initiation_date
  
```{r global data, echo=TRUE,include=TRUE}
# Dataset : variables as factors

data$State<-as.factor(data$State)
data$Habitat<-as.factor(data$Habitat)
data$Species<-as.factor(data$Species)
data$Year<-as.factor(data$Year)
str(data)

# Checking for missing data

colSums(is.na(data))  # No missing data here
```
  
Before any modeling, we must explore the data in order to avoid possible errors. 
Below we present the list of steps to follow before proceeding to the modeling:

- 1: Check for the presence of outliers in $Y$ and the distribution of the 
values of $Y$

- 2: If $X$ is a **quantitative** explanatory variable, check for the presence 
of outliers and the distribution of the values of $X$ **OR/AND** 
If $X$ is a **qualitative** explanatory variable, analyze the number of 
modalities and the number of individuals per modality

- 3: Analyze the potential relationship between $Y$ and the $X_{s}$

- 4: Check for the presence of possible interactions between the $X_{s}$

- 5: Check for the presence of possible collinearity between the $X_{s}$
  
  
### Outliers in $Y$ and distribution of values of $Y$

```{r datahist, include=TRUE, fig.height=5, fig.width=5}
par(mfrow=c(2,2))
# Boxplot
boxplot(data$Initiation_Date,col='dodgerblue3',ylab='Initiation date')
# Cleveland plot
dotchart(data$Initiation_Date,pch=16,col='dodgerblue3',xlab='Initiation date')
# Histogram
hist(data$Initiation_Date,col='dodgerblue3',xlab="Initiation date",main="")
# Quantile-Quantile plot
qqnorm(data$Initiation_Date,pch=16,col='dodgerblue3',xlab='')
qqline(data$Initiation_Date,col='red',lwd=2)
```
  
  
The different graphs show us no outliers for Initiation_Date. In addition, our 
Y variable seems to follow a Normal Distribution.
  
  
  
### Outliers and distribution of the values of $X$

The four $Xs$ are factors. We can analyze the number of modalities and the number of 
individuals per modality. 

```{r datafact, include=TRUE}
# Factor State
summary(data$State)
# Factor Habitat
summary(data$Habitat)
# Factor Species
summary(data$Species)
# Factor Year
summary(data$Year)
```

Factor State: The experimental design is not balanced (1071 and 2150 data), but
the analysis can be performed because there are enough data in each modality (> 10).

Factor Habitat: The experimental design is not balanced (from 392 to 1683 data), but
the analysis can be performed because there are enough data in each modality (> 10).

Factor Species: The experimental design is not balanced. Several species have less than 10
data per modality. It will therefore be necessary to remove these data before continuing
the analysis

Factor Year: The experimental design is not balanced (from 24 to 448 data), but
the analysis can be performed because there are enough data in each modality (> 10).


### Removal of poorly represented modalities (< 10 data)

```{r delete_modalites, include=TRUE}

# Count the number of occurrences for each modality in data$Species
species_count <- table(data$Species)

# Keep only terms with 10 or more occurrences
data <- data %>% filter(Species %in% names(species_count[species_count >= 10]))

# Show filtered data
head(data)
summary(data$Species)
```
  
  
### Analyzing the potential relationship between Y vs Xs

We can graphically analyze the possible relationships between Y and X. This 
graphical analysis of the relationships between Y and X **does not allow us to predict the significance of the relationship**. Statistical modeling remains the only available means to identify whether a relationship exists or not.


```{r datagraph, include=TRUE, fig.height=3, fig.width=6}
# Boxplot 
par(mfrow=c(2,2))
boxplot(data$Initiation_Date~data$State, varwidth = TRUE, ylab = "Initiation date", xlab = "State", col='darkgrey', main = "")
boxplot(data$Initiation_Date~data$Habitat, varwidth = TRUE, ylab = "Initiation date", xlab = "Habitat", col='darkgrey', main = "")
boxplot(data$Initiation_Date~data$Species, varwidth = TRUE, ylab = "Initiation date", xlab = "Species", col='darkgrey', main = "")
boxplot(data$Initiation_Date~data$Year, varwidth = TRUE, ylab = "Initiation date", xlab = "Year", col='darkgrey', main = "")
```

From the first visualizations, we could make the hypothesis that Year and Species
influence Initiation_Date.


### Analysis of possible interactions between the four Xs

The interaction between two factors can only be tested if the factors are
crossed (all the modalities of one factor are represented in all
the modalities of the other factor and vice versa = a complete factorial design).
To estimate the presence of interactive effects, we will develop a graphical approach.


```{r dataInter, include=TRUE, fig.height=4, fig.width=7}
# Interaction table
table(data$State,data$Habitat)
table(data$State,data$Species)
table(data$State,data$Year)
table(data$Habitat,data$Species)
table(data$Habitat,data$Year)
table(data$Species,data$Year)

```


Subsequently, we will not analyze the interactions between the factors since 
the factors are not crossed.

  
