---

title: "Modèles matriciels et applications"

group: "Rudy, Tanguy, Manon, Garan, Anaëlle, Oceane, Victor" 


bibliography: references.bib
execute: 
  freeze: auto
output: 
  html_document:
   toc: true
   toc_float: true
---

Le lien du site : https://zenodo.org/records/8251495 


Pistes 

Calcul 

Taux de succès 
Taux de survie

voir si habitat préférentiel, région, …
voir quelles facteurs expliquent taux de succès

voir si décalages entre dates de départ du nid -> facteurs expliquant 

voir si habitat préferentiel 

MAIS ATTENTION à ne pas être biaisé : du genre que des oiseaux d’une certaines espèces ne soit présents que dans un habitat

refaire analyse de bases cf ASA 

# Document R modifié et avec ajouts


# Variables presentation:

- Nest_ID : the code to identify each nest.
- State : the state in which the nest has been found. 2 levels factor : Illinois and Wisconsin.
- County : the county in the state where the state has been found. 14 levels factor.
- Habitat : the type of habitat in which the nest has been found. 4 levels factor.
- Species : the species of the bird that has build the nest. 8 levels factor.
- Year : the year of the nest building. 21 levels factor.
- Nest_Fate : variable that says if there is a least one bird hatch in the nest (1) or not (0).
- Initiation_Date : the date when the bird hatch from the 1st of April (1), May the 1st (31), June the 1st (62), etc.
- Number_Fledged : the number of birds that hatch on the nest when they hatch. Quantitative variable.
- Nest-End_Date : the date where the nest either failed of the birds successfully hatch.



## Import des données

**Do not forget to set your working directory in the right place**
**Menu : Session/Set Working Directory/Choose directory**
*And indicate Git/2024_MODE_OCR*


```{r}
# Dataset import under the name of "data"
data <- read.csv("Bird_dataset.csv", sep=";", header = TRUE, stringsAsFactors = TRUE)
data$Nest_Fate <- as.factor(data$Nest_Fate)
data$Year <- as.factor(data$Year)

# Checking if there are missing data
colSums(is.na(data))
```

```{r}
# Charge the librairies
library(ggplot2)
```

```{r}
# View the firsts lines of the dataset
head(data)
```

We want to study the impact of the habitat, the county, the species and the year over the number of young hatched in the nest. 


## Data exploration

### Outlayer values in the response variable $Y$ and values distribution:

```{r datahist, include=TRUE, fig.height=5, fig.width=5}
par(mfrow=c(2,2))
# Boxplot
boxplot(data$Number_Fledged,col='dodgerblue3',ylab='Number of young in nest')
# Cleveland plot
dotchart(data$Number_Fledged,pch=16,col='dodgerblue3',xlab='Number of young in nest')
# Histogram
hist(data$Number_Fledged,col='dodgerblue3',xlab="Number of young in nest",main="")
# Quantile-Quantile plot
qqnorm(data$Number_Fledged,pch=16,col='dodgerblue3',xlab='')
qqline(data$Number_Fledged,col='red',lwd=2)
```



### Outlayer values in the explanatory variable $Xs$ and values distribution:

```{r datafact, include=TRUE}
# Factor County
summary(data$County)
# Factor Habitat
summary(data$Habitat)
# Factor Species
summary(data$Species)
# Factor Year
summary(data$Year)
```
Problem: there aren't the same number of observations in each level of each factors.
Suggestion: normalize by the number of observation for each level.


### Analyze the relation between Y and Xs

```{r datagraph, include=TRUE, fig.height=7, fig.width=7}

par(mfrow=c(2,2))

# County
plot(data$Number_Fledged~data$County,pch=16,col='dodgerblue3',xlab='County',ylab='Number of young in nest')

# Habitat
plot(data$Number_Fledged~data$Habitat,pch=16,col='dodgerblue3',xlab='Habitat',ylab='Number of young in nest')

# Species
plot(data$Number_Fledged~data$Species,pch=16,col='dodgerblue3',xlab='Species',ylab='Number of young in nest')

# Year
plot(data$Number_Fledged~data$Year,pch=16,col='dodgerblue3',xlab='Year',ylab='Number of young in nest')
```


# Repartition of the data through time


```{r}
# Evolution of nest build according to the year

# Counting the number of individuals for each year
library(dplyr)
year_count <- data %>%
  group_by(Year) %>%
  summarise(nb_individus = n())

# Creation of the graph
library(ggplot2)
ggplot(year_count, aes(x = Year, y = nb_individus)) + 
  geom_bar(stat = "identity", fill = "blue") +
  labs(title = "Number of nest built by year", x = "Year", y = "Number of individuals")

```


```{r}

#Calculer le nombre total de petits par espèce
young_count <- aggregate(Number_Fledged ~ Species, data = data, sum)

#Créer un graphique en barres avec ggplot2
library(ggplot2)
ggplot(young_count, aes(x = Species, y = Number_Fledged)) + 
  geom_bar(stat = "identity", fill = "blue") +
  labs(title = "Nombre de petits par espèce", x = "Espèce", y = "Nombre de petits") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```



