[
  {
    "objectID": "README_Variables_explanation.html",
    "href": "README_Variables_explanation.html",
    "title": "Nest initiation and end dates for eight grassland bird species in Wisconsin and Illinois",
    "section": "",
    "text": "We used nest records from published grassland bird studies done in Wisconsin and Illinois to compile a dataset for 8 obligate grassland bird species Study sites were clustered in southwestern Wisconsin near Mt. Horeb (43.0167N, 89.7500W); sites were located in Dane, Grant, Green, Iowa, Lafayette, Monroe, and Rock counties. In northern Illinois, study sites were located in Lee, Ogle, Will, Grundy, Carroll, and Jo Daviess counties (40.9822 to 42.2356N, -87.5433 to -90.3489W).The dataset consists of 3257 nests with observations on nest initiation date (date first egg laid), nest fate (success, failure), number of fledglings, and nest end date (date the nest either failed or fledged at least one nestling). The species were Bobolink, Dickcissel, Eastern Meadowlark, Grasshopper Sparrow, Henslow’s Sparrow, Savannah Sparrow, Vesper Sparrow, and Western Meadowlark.\nNest data from all studies were put into a common format of nest initiation date (date first egg laid), nest fate, number of nestlings, and nest end date (date the nest either failed or fledged at least one nestling). We used the fate (success or failure) as assigned by the original researchers. We used the nest initiation and failure dates if recorded by the original researchers. In general, nest initiation dates were estimated based on field notes or digital video (i.e., video-surveillance of nests). In some instances, nests failed within the same nesting stage (laying, incubation, or nestling) in which they were first found. For these cases, nest initiation dates were estimated following Cox et al. (2012. Species and temporal factors affect predator-specific rates of nest predation for forest songbirds in the Midwest. Auk 129:147155) using average species-specific incubation times from Ehrlich et al. (1988. Birders handbook. Simon and Schuster Inc. New York, New York, USA). Nest end dates (date when nest failed or fledged at least one nestling) were either known (e.g., forced fledging during nest checks, digital video, field observations) or estimated. Nest end date was estimated using the mid-point between the dates when the nest was last observed with eggs/nestlings present and when the nest was next observed empty. We used the data to estimate the potential species-specific impacts of disturbance (e.g., mowing, fire) conducted at different dates in the breeding season on nests and fledglings.\n\n\nData were put into an Excel file. The first line of the file is the header followed by 3257 lines of data. There are 10 columns. The columns are as follows.\nNest_ID = unique nest identifier\nState = State in which nest was located (Illinois or Wisconsin)\nCounty = County in the state in which nest was located\nHabitat = Grassy habitat in which nest was located (pasture, cool-season grassland, warm-season grassland, or prairie)\nSpecies = English common name\nYear = Year nest was found\nNest_Fate = Successly fledged at least one young (1) or Failed (0).\nInitiation_Date = Coded date when the first egg was laid. April 1 = 1; May 1 = 31; June 1 = 62; July 1 = 92; August 1 = 123; September 1 = 154\nNumber_Fledged = For a successful nest, number of young in nest on nest end date; For a failed nest, Number_Fledged is 0\nNest_End_Date = Coded date when the nest failed or was successful. April 1 = 1; May 1 = 31; June 1 = 62; July 1 = 92; August 1 = 123; September 1 = 154\n\n\n\nData were derived from the following sources:\n\nBasili, G. D. 1997. Continental-scale ecology and conservation of Dickcissels. Dissertation, University of WisconsinMadison, Madison, Wisconsin, USA.\nByers, C. M., C. A. Ribic, D. W. Sample., J. D. Dadisman, and M. R. Guttery. 2017. Grassland bird productivity in warm season grass fields in southwest Wisconsin. American Midland Naturalist 178:4763.\nEllison, K. S., C. A. Ribic, D. W. Sample, M. J. Fawcett, and J. D. Dadisman. 2013. Impacts of tree rows on grassland birds and potential nest predators: a removal experiment. PLoS ONE 8(4):e59151. https://doi.org/10.1371/journal.pone.0059151.\nHerkert, J. R., Reinking, D. L., Wiedenfeld, D. A., Winter, M., Zimmerman, J. L., Jensen, W. E., Finck, E. J., Koford, R. R., Wolfe, D. H., Sherrod, S. K. and Jenkins, M. A. 2003. Effects of prairie fragmentation on the nest success of breeding birds in the midcontinental United States. Conservation Biology 17:587594.\nRenfrew, R. B., C. A. Ribic, and J. L. Nack. 2005. Edge avoidance by nesting grassland birds: a futile strategy in a fragmented landscape. The Auk 122:618636.\nRibic, C. A., M. J. Guzy, T. A. Anderson, D. W. Sample, and J. L. Nack. 2012. Bird productivity and nest predation in agricultural grasslands. Studies in Avian Biology 43:119-134.\nTemple, S. A., B. M. Fevold, L. K. Paine, D. L. Undersander, and D. W. Sample. 1999. Nesting birds and grazing cattle: accommodating both on Midwestern pastures. Studies in Avian Biology 19:196202.\nVos, S. M., and C. A. Ribic. 2013. Nesting success of grassland birds in oak barrens and dry prairies in West Central Wisconsin. Northeastern Naturalist 20:131–142."
  },
  {
    "objectID": "README_Variables_explanation.html#description-of-the-data-and-file-structure",
    "href": "README_Variables_explanation.html#description-of-the-data-and-file-structure",
    "title": "Nest initiation and end dates for eight grassland bird species in Wisconsin and Illinois",
    "section": "",
    "text": "Data were put into an Excel file. The first line of the file is the header followed by 3257 lines of data. There are 10 columns. The columns are as follows.\nNest_ID = unique nest identifier\nState = State in which nest was located (Illinois or Wisconsin)\nCounty = County in the state in which nest was located\nHabitat = Grassy habitat in which nest was located (pasture, cool-season grassland, warm-season grassland, or prairie)\nSpecies = English common name\nYear = Year nest was found\nNest_Fate = Successly fledged at least one young (1) or Failed (0).\nInitiation_Date = Coded date when the first egg was laid. April 1 = 1; May 1 = 31; June 1 = 62; July 1 = 92; August 1 = 123; September 1 = 154\nNumber_Fledged = For a successful nest, number of young in nest on nest end date; For a failed nest, Number_Fledged is 0\nNest_End_Date = Coded date when the nest failed or was successful. April 1 = 1; May 1 = 31; June 1 = 62; July 1 = 92; August 1 = 123; September 1 = 154"
  },
  {
    "objectID": "README_Variables_explanation.html#sharingaccess-information",
    "href": "README_Variables_explanation.html#sharingaccess-information",
    "title": "Nest initiation and end dates for eight grassland bird species in Wisconsin and Illinois",
    "section": "",
    "text": "Data were derived from the following sources:\n\nBasili, G. D. 1997. Continental-scale ecology and conservation of Dickcissels. Dissertation, University of WisconsinMadison, Madison, Wisconsin, USA.\nByers, C. M., C. A. Ribic, D. W. Sample., J. D. Dadisman, and M. R. Guttery. 2017. Grassland bird productivity in warm season grass fields in southwest Wisconsin. American Midland Naturalist 178:4763.\nEllison, K. S., C. A. Ribic, D. W. Sample, M. J. Fawcett, and J. D. Dadisman. 2013. Impacts of tree rows on grassland birds and potential nest predators: a removal experiment. PLoS ONE 8(4):e59151. https://doi.org/10.1371/journal.pone.0059151.\nHerkert, J. R., Reinking, D. L., Wiedenfeld, D. A., Winter, M., Zimmerman, J. L., Jensen, W. E., Finck, E. J., Koford, R. R., Wolfe, D. H., Sherrod, S. K. and Jenkins, M. A. 2003. Effects of prairie fragmentation on the nest success of breeding birds in the midcontinental United States. Conservation Biology 17:587594.\nRenfrew, R. B., C. A. Ribic, and J. L. Nack. 2005. Edge avoidance by nesting grassland birds: a futile strategy in a fragmented landscape. The Auk 122:618636.\nRibic, C. A., M. J. Guzy, T. A. Anderson, D. W. Sample, and J. L. Nack. 2012. Bird productivity and nest predation in agricultural grasslands. Studies in Avian Biology 43:119-134.\nTemple, S. A., B. M. Fevold, L. K. Paine, D. L. Undersander, and D. W. Sample. 1999. Nesting birds and grazing cattle: accommodating both on Midwestern pastures. Studies in Avian Biology 19:196202.\nVos, S. M., and C. A. Ribic. 2013. Nesting success of grassland birds in oak barrens and dry prairies in West Central Wisconsin. Northeastern Naturalist 20:131–142."
  },
  {
    "objectID": "READ_ME_ANALYSE_BIRDS.html",
    "href": "READ_ME_ANALYSE_BIRDS.html",
    "title": "Analysis of the factors favorable to nest success of different birds species in two USA states, Wisconsin and Illinois",
    "section": "",
    "text": "Objectives : This work is an exploration of a dataset dealing with bird diversity and egg-laying in the states of Wisconsin and Illinois.\n\n\n\nThis project is part of the OCR course offered by the University of Rennes and supervised by Mm. Marie Etienne.\n\n\n\n\nRudy Usach\nManon Verdier\nVictor Schmitt\nAnaelle Duplessis\nOceane Gourdin\nTanguy Aubreton\nGaran Le Bivic\n\n\n\n\nNo requierment are needed to run this project, however if you have any trouble with the R script, we recommend that you clean up your environment before running the script. Also, make sure you’re in the right working directory and follow the instructions carefully.\n\n\n\nBefore running the project, make sure you have the following packages installed in your R environment:\n\nInstall the package spDataLarge:\ninstall.packages(\"spDataLarge\", repos = \"https://nowosad.github.io/drat/\", type = \"source\")\nInstall the other packages:\ninstall.packages(c('knitr', 'ggplot2', 'corrplot', 'ggcorrplot', 'plot3D', 'DHARMa', \n                'rcompanion', 'lattice', 'dplyr', 'FactoMineR', 'factoextra', \n                'sf', 'terra', 'spData', 'tmap', 'leaflet', 'maps', 'gifski'))"
  },
  {
    "objectID": "READ_ME_ANALYSE_BIRDS.html#description",
    "href": "READ_ME_ANALYSE_BIRDS.html#description",
    "title": "Analysis of the factors favorable to nest success of different birds species in two USA states, Wisconsin and Illinois",
    "section": "",
    "text": "Objectives : This work is an exploration of a dataset dealing with bird diversity and egg-laying in the states of Wisconsin and Illinois."
  },
  {
    "objectID": "READ_ME_ANALYSE_BIRDS.html#context",
    "href": "READ_ME_ANALYSE_BIRDS.html#context",
    "title": "Analysis of the factors favorable to nest success of different birds species in two USA states, Wisconsin and Illinois",
    "section": "",
    "text": "This project is part of the OCR course offered by the University of Rennes and supervised by Mm. Marie Etienne."
  },
  {
    "objectID": "READ_ME_ANALYSE_BIRDS.html#team-members",
    "href": "READ_ME_ANALYSE_BIRDS.html#team-members",
    "title": "Analysis of the factors favorable to nest success of different birds species in two USA states, Wisconsin and Illinois",
    "section": "",
    "text": "Rudy Usach\nManon Verdier\nVictor Schmitt\nAnaelle Duplessis\nOceane Gourdin\nTanguy Aubreton\nGaran Le Bivic"
  },
  {
    "objectID": "READ_ME_ANALYSE_BIRDS.html#requirements-and-installation",
    "href": "READ_ME_ANALYSE_BIRDS.html#requirements-and-installation",
    "title": "Analysis of the factors favorable to nest success of different birds species in two USA states, Wisconsin and Illinois",
    "section": "",
    "text": "No requierment are needed to run this project, however if you have any trouble with the R script, we recommend that you clean up your environment before running the script. Also, make sure you’re in the right working directory and follow the instructions carefully."
  },
  {
    "objectID": "READ_ME_ANALYSE_BIRDS.html#dependencies-installation",
    "href": "READ_ME_ANALYSE_BIRDS.html#dependencies-installation",
    "title": "Analysis of the factors favorable to nest success of different birds species in two USA states, Wisconsin and Illinois",
    "section": "",
    "text": "Before running the project, make sure you have the following packages installed in your R environment:\n\nInstall the package spDataLarge:\ninstall.packages(\"spDataLarge\", repos = \"https://nowosad.github.io/drat/\", type = \"source\")\nInstall the other packages:\ninstall.packages(c('knitr', 'ggplot2', 'corrplot', 'ggcorrplot', 'plot3D', 'DHARMa', \n                'rcompanion', 'lattice', 'dplyr', 'FactoMineR', 'factoextra', \n                'sf', 'terra', 'spData', 'tmap', 'leaflet', 'maps', 'gifski'))"
  },
  {
    "objectID": "prior_course.html",
    "href": "prior_course.html",
    "title": "Be ready for the course",
    "section": "",
    "text": "The Online Collaborative Resources (OCR) class will make intensive use of the Reproducible Science tools. For this class and as an investment for the future, you will need to:"
  },
  {
    "objectID": "prior_course.html#git-on-your-computer",
    "href": "prior_course.html#git-on-your-computer",
    "title": "Be ready for the course",
    "section": "Git on your computer",
    "text": "Git on your computer\nInstall Git on your personal computer: Go to the Git website and click on the computer screen on the right, which should offer you the version suitable for your operating system."
  },
  {
    "objectID": "prior_course.html#github-account",
    "href": "prior_course.html#github-account",
    "title": "Be ready for the course",
    "section": "GitHub account",
    "text": "GitHub account\nIf you don’t have one, you have to create a GitHub account and set up the link between your computer and the GitHub. Be careful with the login you choose, this account will be used professionally and you may want to avoid pseudo like toto2024, or ladybug288.\nGitHub is just one solution to share git repositories online, you may work later with gitlab with is very similar to GitHub."
  },
  {
    "objectID": "prior_course.html#a-ssh-connection",
    "href": "prior_course.html#a-ssh-connection",
    "title": "Be ready for the course",
    "section": "A SSH connection",
    "text": "A SSH connection\nTo have smooth interactions with Github, you have to use a SSH and to do so, you will to generate SSH key on your computer and copy paste the public SSH key id_rsa.pub on your GitHub account.\n\nOpen a terminal (any terminal on Mac and Linux, the Git bash program you have installed with git if you are using Windows)\ntype the command\nssh-keygen\nDO NOT ENTER ANY PASSPHRASE while asked, simply press enter (twice generally)\nYou should have a directory named .ssh in your main personnal folder. Open the file id_rsa.pub with any text basic editor (like notepad, gedit …) and copy the key.\nGo to the settings of your GitHub account, choose the SSH and GPG keys, then press New SSH key and paste the previously copied key."
  },
  {
    "objectID": "prior_course.html#let-me-know-who-you-are",
    "href": "prior_course.html#let-me-know-who-you-are",
    "title": "Be ready for the course",
    "section": "Let me know who you are",
    "text": "Let me know who you are\nPlease enter your name and GitHub login on this spreadsheet and indicate in the last column whether you are already familiar with some markup languages (markdown, HTML) and if you have prior experience with Git or any version control system.\nPlease try to install all of this as soon as possible, and if you encounter any difficulties, don’t hesitate to contact me by email or come to me at the beginning of the class.\nIt will be easier if you can follow this procedure on your laptop and bring it to the class, but if you don’t have any laptop we will able to use the computers in the classroom (however this tedious installation process will have to be repeated on your personal computer)"
  },
  {
    "objectID": "Penguins_chapter.html",
    "href": "Penguins_chapter.html",
    "title": "Exploring data on penguins",
    "section": "",
    "text": "This document is a report on the analysis of a dataset on penguins. The data collected contains informations on multiples variables. The dataset was found on Kaggle : https://www.kaggle.com/datasets/utkarshx27/penguin-size-clutch-and-blood-isotope-data?select=penguins_raw.csv. This dataset was assemble from various articles according by Gorman et al. (Gorman 2014) and Horst et al. (Horst, Hill, and Gorman 2022). It focused on three penguin species : Adelie (Pygoscelis adeliae), Chinstrap (Pygoscelis antarcticus) and Gentoo (Pygoscelis papua). The dataset contains 344 observations and 17 variables. The goal of this analysis is to explore the dataset and to identify the main characteristics of the penguins.\n\n\nShow the code\nlibrary(factoextra)         # for data visualization\nlibrary(FactoMineR)         # for PCA\nlibrary(tidyverse)          # for data manipulation and visualization\nlibrary(dplyr)              # for data manipulation\nlibrary(ggplot2)            # for data visualization\nlibrary(corrplot)           # for correlation test\nlibrary(sf)                 # for spatial data\nlibrary(rnaturalearth)      # for earth maps\nlibrary(rnaturalearthdata)  # for earth dataset\nlibrary(ggspatial)          # for spatial plot\nlibrary(gridExtra)          # for arranging plot\nlibrary(kableExtra)         # for enhanced tables\n\n\n\n\n\nData were collected in Antarctica on Biscoe, Dream and Torgersen Islands. These three blue points show the location of the data collect in Figure 1.\n\n\nShow the code\n# Download country data (including Antarctica)\nworld &lt;- ne_countries(scale = \"medium\", returnclass = \"sf\")\n\n# Filter to keep only Antarctica\nantarctica &lt;- world[world$continent == \"Antarctica\", ]\n\nrectangle_coords &lt;- st_as_sfc(st_bbox(c(xmin = -90, xmax = -55, ymin = -75, ymax = -60), crs = st_crs(4326)))\n\nantarctic_proj &lt;- \"+proj=laea +lat_0=-90 +datum=WGS84\"\n# Transform the rectangle into the polar projection system\nrectangle_proj &lt;- st_transform(rectangle_coords, crs = antarctic_proj)\n\n# Create the map\ngg_antartique = ggplot(data = antarctica) +\n    annotate(\"rect\", xmin = -90, xmax = -55, ymin = -75, ymax = -60,\n           fill = \"blue\") +\n  geom_sf() +\n  coord_sf(crs = \"+proj=laea +lat_0=-90 +datum=WGS84\") +\n annotate(\"rect\", \n           xmin = st_bbox(rectangle_proj)[\"xmin\"], xmax = st_bbox(rectangle_proj)[\"xmax\"], \n           ymin = st_bbox(rectangle_proj)[\"ymin\"], ymax = st_bbox(rectangle_proj)[\"ymax\"], \n           alpha = 0.2, fill = \"blue\")+\n  theme_minimal() +\n  labs(title = \"Antarctica map\",\n       caption = \"Data: Natural Earth\") +\n  annotation_scale(location = \"bl\", width_hint = 0.5)\n\nantarctic_proj &lt;- \"+proj=laea +lat_0=-90 +datum=WGS84\"\n\n# Point coordinates in longitude and latitude\npoint_coords &lt;- data.frame(lon = c(-66.209547, -64, -65), lat = c(-66, -65, -64.8))\n\n# Convert the point into an sf object (longitude/latitude coordinate system WGS84)\npoint_sf &lt;- st_as_sf(point_coords, coords = c(\"lon\", \"lat\"), crs = 4326)\n\n# Transform the point into the projected coordinate system of the map\npoint_proj &lt;- st_transform(point_sf, crs = antarctic_proj)\n\n# Extract the projected coordinates for use in annotate\npoint_proj_coords &lt;- st_coordinates(point_proj)\n\n# Create a bounding box manually with the coordinates\n# Convert the bounding box into an sf object\nbbox_sf &lt;- st_as_sfc(st_bbox(c(xmin = -90, xmax = -55, ymin = -75, ymax = -60)))\n\n# Crop the map using the bounding box\nantarctica_cropped &lt;- st_crop(antarctica, bbox_sf)\n\n# Create the map\ngg_zone_interet = ggplot() +\n  geom_sf(data = antarctica_cropped) +\n  geom_sf(data = point_proj, color = \"blue\", size = 3, alpha = 0.8, shape = 19) +\n\n  coord_sf(crs = \"+proj=laea +lat_0=-90 +datum=WGS84\") +\n  theme_minimal() +\n  labs(title = \"Area of Interest\",\n       caption = \"Data: Natural Earth\") +\n  annotation_scale(location = \"bl\", width_hint = 0.5)\n\ngrid.arrange(gg_antartique, gg_zone_interet, ncol = 2)\n\n\n\n\n\nFigure 1: Maps of Antarctica with the collect points\n\n\n\n\n\n\n\nColumns name :\n\nstudyName : sampling expedition from which data were collected, generated, etc.\n\nSample Number : an integer denoting the continuous numbering sequence for each sample\n\nSpecies : a character string denoting the penguin species\n\nRegion : a character string denoting the region of Palmer LTER sampling grid\n\nIsland : a character string denoting the island near Palmer Station where samples were collected\n\nStage : a character string denoting the reproductive stage at the time of sampling\n\nIndividual ID : a character string denoting the unique ID for each individual in dataset\n\nClutch Completion : a character string denoting if the study nest was observed with a full clutch, i.e., 2 eggs\n\nDate Egg : a date denoting the date study nest observed with 1 egg (sampled)\n\nCulmen Length : a number denoting the length of the dorsal ridge of a bird’s bill (millimeters)\n\nCulmen Depth : a number denoting the depth of the dorsal ridge of a bird’s bill (millimeters)\n\nFlipper Length : an integer denoting the length penguin flipper (millimeters)\n\nBody Mass : an integer denoting the penguin body mass (grams)\n\nSex : a character string denoting the sex of an animal\n\nDelta 15 N : a number denoting the measure of the ratio of stable isotopes 15N:14N\n\nDelta 13 C : a number denoting the measure of the ratio of stable isotopes 13C:12C\n\nComments : a character string with text providing additional relevant information for data\n\nLoading dataset :\n\ndata &lt;- read.table(\"penguins_raw.csv\", sep = \",\" , header = TRUE, stringsAsFactors = T)\nsummary(data)\n\n       X            studyName   Sample.Number   \n Min.   :  1.00   PAL0708:110   Min.   :  1.00  \n 1st Qu.: 86.75   PAL0809:114   1st Qu.: 29.00  \n Median :172.50   PAL0910:120   Median : 58.00  \n Mean   :172.50                 Mean   : 63.15  \n 3rd Qu.:258.25                 3rd Qu.: 95.25  \n Max.   :344.00                 Max.   :152.00  \n                                                \n                                      Species       Region          Island   \n Adelie Penguin (Pygoscelis adeliae)      :152   Anvers:344   Biscoe   :168  \n Chinstrap penguin (Pygoscelis antarctica): 68                Dream    :124  \n Gentoo penguin (Pygoscelis papua)        :124                Torgersen: 52  \n                                                                             \n                                                                             \n                                                                             \n                                                                             \n                Stage     Individual.ID Clutch.Completion       Date.Egg  \n Adult, 1 Egg Stage:344   N13A1  :  3   No : 36           2007-11-27: 18  \n                          N13A2  :  3   Yes:308           2007-11-16: 16  \n                          N18A1  :  3                     2008-11-09: 16  \n                          N18A2  :  3                     2009-11-18: 14  \n                          N21A1  :  3                     2008-11-04: 12  \n                          N21A2  :  3                     2008-11-06: 12  \n                          (Other):326                     (Other)   :256  \n Culmen.Length..mm. Culmen.Depth..mm. Flipper.Length..mm. Body.Mass..g. \n Min.   :32.10      Min.   :13.10     Min.   :172.0       Min.   :2700  \n 1st Qu.:39.23      1st Qu.:15.60     1st Qu.:190.0       1st Qu.:3550  \n Median :44.45      Median :17.30     Median :197.0       Median :4050  \n Mean   :43.92      Mean   :17.15     Mean   :200.9       Mean   :4202  \n 3rd Qu.:48.50      3rd Qu.:18.70     3rd Qu.:213.0       3rd Qu.:4750  \n Max.   :59.60      Max.   :21.50     Max.   :231.0       Max.   :6300  \n NA's   :2          NA's   :2         NA's   :2           NA's   :2     \n     Sex      Delta.15.N..o.oo. Delta.13.C..o.oo.\n FEMALE:165   Min.   : 7.632    Min.   :-27.02   \n MALE  :168   1st Qu.: 8.300    1st Qu.:-26.32   \n NA's  : 11   Median : 8.652    Median :-25.83   \n              Mean   : 8.733    Mean   :-25.69   \n              3rd Qu.: 9.172    3rd Qu.:-25.06   \n              Max.   :10.025    Max.   :-23.79   \n              NA's   :14        NA's   :13       \n                                  Comments  \n Nest never observed with full clutch.: 34  \n Not enough blood for isotopes.       :  7  \n Sexing primers did not amplify.      :  4  \n No blood sample obtained for sexing. :  2  \n No blood sample obtained.            :  2  \n (Other)                              :  5  \n NA's                                 :290  \n\n# dim(data)\n\nNames modification of columns and species :\n\n\nShow the code\ndata &lt;- data %&gt;%\n  select(-X) %&gt;%                   # Remove X column \n  select(-Comments) %&gt;%           # Remove Comments column\n  rename(                          # we rename the columns of the dataset\n    sample_number = Sample.Number,\n    id = Individual.ID,\n    island = Island,\n    region = Region,\n    stage = Stage,\n    clutch_completion = Clutch.Completion,\n    date_egg = Date.Egg,\n    culmen_length = Culmen.Length..mm.,\n    culmen_depth = Culmen.Depth..mm.,\n    flipper_length = Flipper.Length..mm.,\n    body_mass = Body.Mass..g.,\n    sex = Sex,\n    delta_15_N = Delta.15.N..o.oo.,\n    delta_13_C = Delta.13.C..o.oo.,\n    species = Species)\n\nnames(data)\n\n\n [1] \"studyName\"         \"sample_number\"     \"species\"          \n [4] \"region\"            \"island\"            \"stage\"            \n [7] \"id\"                \"clutch_completion\" \"date_egg\"         \n[10] \"culmen_length\"     \"culmen_depth\"      \"flipper_length\"   \n[13] \"body_mass\"         \"sex\"               \"delta_15_N\"       \n[16] \"delta_13_C\"       \n\n\nShow the code\n# rename species\ndata = data %&gt;%\n  mutate(species = recode(species, \"Adelie Penguin (Pygoscelis adeliae)\" = \"Adelie\", \"Chinstrap penguin (Pygoscelis antarctica)\" = \"Chinstrap\", \"Gentoo penguin (Pygoscelis papua)\" = \"Gentoo\"))\n\n\nThese names are easier to understand.\n\n\n\nThe Figure 2 have a red line that represents the mean of missing values (NA) in the dataset and the bars are showing the number of NA’s for each variables.\n\n\nShow the code\n# Verification of missing values\ncolSums(is.na(data)) \n\n\n        studyName     sample_number           species            region \n                0                 0                 0                 0 \n           island             stage                id clutch_completion \n                0                 0                 0                 0 \n         date_egg     culmen_length      culmen_depth    flipper_length \n                0                 2                 2                 2 \n        body_mass               sex        delta_15_N        delta_13_C \n                2                11                14                13 \n\n\nShow the code\ndata_NA &lt;- data \n\n# Representation of missing values\nNA_df &lt;- (colSums(is.na(data_NA)) / nrow(data_NA)) * 100\n\ncolor_pal &lt;- colorRampPalette(c(\"limegreen\", \"yellow\", \"firebrick\"), bias = 20)(10)\nNA_col &lt;- color_pal[as.integer(NA_df/length(NA_df)*9)+1]\n\n# Graphique\nbarplot(NA_df,ylab = \"NA\", col = NA_col, las=2, cex.names=0.6)\n\nNA_mean&lt;-mean(NA_df)\n# 0.78% \n\nabline(h=NA_mean, col = \"red\", lwd = 2)\n\n\n\n\n\nFigure 2: Number of missing value as a function of each variables"
  },
  {
    "objectID": "Penguins_chapter.html#study-context",
    "href": "Penguins_chapter.html#study-context",
    "title": "Exploring data on penguins",
    "section": "",
    "text": "This document is a report on the analysis of a dataset on penguins. The data collected contains informations on multiples variables. The dataset was found on Kaggle : https://www.kaggle.com/datasets/utkarshx27/penguin-size-clutch-and-blood-isotope-data?select=penguins_raw.csv. This dataset was assemble from various articles according by Gorman et al. (Gorman 2014) and Horst et al. (Horst, Hill, and Gorman 2022). It focused on three penguin species : Adelie (Pygoscelis adeliae), Chinstrap (Pygoscelis antarcticus) and Gentoo (Pygoscelis papua). The dataset contains 344 observations and 17 variables. The goal of this analysis is to explore the dataset and to identify the main characteristics of the penguins.\n\n\nShow the code\nlibrary(factoextra)         # for data visualization\nlibrary(FactoMineR)         # for PCA\nlibrary(tidyverse)          # for data manipulation and visualization\nlibrary(dplyr)              # for data manipulation\nlibrary(ggplot2)            # for data visualization\nlibrary(corrplot)           # for correlation test\nlibrary(sf)                 # for spatial data\nlibrary(rnaturalearth)      # for earth maps\nlibrary(rnaturalearthdata)  # for earth dataset\nlibrary(ggspatial)          # for spatial plot\nlibrary(gridExtra)          # for arranging plot\nlibrary(kableExtra)         # for enhanced tables"
  },
  {
    "objectID": "Penguins_chapter.html#location",
    "href": "Penguins_chapter.html#location",
    "title": "Exploring data on penguins",
    "section": "",
    "text": "Data were collected in Antarctica on Biscoe, Dream and Torgersen Islands. These three blue points show the location of the data collect in Figure 1.\n\n\nShow the code\n# Download country data (including Antarctica)\nworld &lt;- ne_countries(scale = \"medium\", returnclass = \"sf\")\n\n# Filter to keep only Antarctica\nantarctica &lt;- world[world$continent == \"Antarctica\", ]\n\nrectangle_coords &lt;- st_as_sfc(st_bbox(c(xmin = -90, xmax = -55, ymin = -75, ymax = -60), crs = st_crs(4326)))\n\nantarctic_proj &lt;- \"+proj=laea +lat_0=-90 +datum=WGS84\"\n# Transform the rectangle into the polar projection system\nrectangle_proj &lt;- st_transform(rectangle_coords, crs = antarctic_proj)\n\n# Create the map\ngg_antartique = ggplot(data = antarctica) +\n    annotate(\"rect\", xmin = -90, xmax = -55, ymin = -75, ymax = -60,\n           fill = \"blue\") +\n  geom_sf() +\n  coord_sf(crs = \"+proj=laea +lat_0=-90 +datum=WGS84\") +\n annotate(\"rect\", \n           xmin = st_bbox(rectangle_proj)[\"xmin\"], xmax = st_bbox(rectangle_proj)[\"xmax\"], \n           ymin = st_bbox(rectangle_proj)[\"ymin\"], ymax = st_bbox(rectangle_proj)[\"ymax\"], \n           alpha = 0.2, fill = \"blue\")+\n  theme_minimal() +\n  labs(title = \"Antarctica map\",\n       caption = \"Data: Natural Earth\") +\n  annotation_scale(location = \"bl\", width_hint = 0.5)\n\nantarctic_proj &lt;- \"+proj=laea +lat_0=-90 +datum=WGS84\"\n\n# Point coordinates in longitude and latitude\npoint_coords &lt;- data.frame(lon = c(-66.209547, -64, -65), lat = c(-66, -65, -64.8))\n\n# Convert the point into an sf object (longitude/latitude coordinate system WGS84)\npoint_sf &lt;- st_as_sf(point_coords, coords = c(\"lon\", \"lat\"), crs = 4326)\n\n# Transform the point into the projected coordinate system of the map\npoint_proj &lt;- st_transform(point_sf, crs = antarctic_proj)\n\n# Extract the projected coordinates for use in annotate\npoint_proj_coords &lt;- st_coordinates(point_proj)\n\n# Create a bounding box manually with the coordinates\n# Convert the bounding box into an sf object\nbbox_sf &lt;- st_as_sfc(st_bbox(c(xmin = -90, xmax = -55, ymin = -75, ymax = -60)))\n\n# Crop the map using the bounding box\nantarctica_cropped &lt;- st_crop(antarctica, bbox_sf)\n\n# Create the map\ngg_zone_interet = ggplot() +\n  geom_sf(data = antarctica_cropped) +\n  geom_sf(data = point_proj, color = \"blue\", size = 3, alpha = 0.8, shape = 19) +\n\n  coord_sf(crs = \"+proj=laea +lat_0=-90 +datum=WGS84\") +\n  theme_minimal() +\n  labs(title = \"Area of Interest\",\n       caption = \"Data: Natural Earth\") +\n  annotation_scale(location = \"bl\", width_hint = 0.5)\n\ngrid.arrange(gg_antartique, gg_zone_interet, ncol = 2)\n\n\n\n\n\nFigure 1: Maps of Antarctica with the collect points"
  },
  {
    "objectID": "Penguins_chapter.html#column_name",
    "href": "Penguins_chapter.html#column_name",
    "title": "Exploring data on penguins",
    "section": "",
    "text": "Columns name :\n\nstudyName : sampling expedition from which data were collected, generated, etc.\n\nSample Number : an integer denoting the continuous numbering sequence for each sample\n\nSpecies : a character string denoting the penguin species\n\nRegion : a character string denoting the region of Palmer LTER sampling grid\n\nIsland : a character string denoting the island near Palmer Station where samples were collected\n\nStage : a character string denoting the reproductive stage at the time of sampling\n\nIndividual ID : a character string denoting the unique ID for each individual in dataset\n\nClutch Completion : a character string denoting if the study nest was observed with a full clutch, i.e., 2 eggs\n\nDate Egg : a date denoting the date study nest observed with 1 egg (sampled)\n\nCulmen Length : a number denoting the length of the dorsal ridge of a bird’s bill (millimeters)\n\nCulmen Depth : a number denoting the depth of the dorsal ridge of a bird’s bill (millimeters)\n\nFlipper Length : an integer denoting the length penguin flipper (millimeters)\n\nBody Mass : an integer denoting the penguin body mass (grams)\n\nSex : a character string denoting the sex of an animal\n\nDelta 15 N : a number denoting the measure of the ratio of stable isotopes 15N:14N\n\nDelta 13 C : a number denoting the measure of the ratio of stable isotopes 13C:12C\n\nComments : a character string with text providing additional relevant information for data\n\nLoading dataset :\n\ndata &lt;- read.table(\"penguins_raw.csv\", sep = \",\" , header = TRUE, stringsAsFactors = T)\nsummary(data)\n\n       X            studyName   Sample.Number   \n Min.   :  1.00   PAL0708:110   Min.   :  1.00  \n 1st Qu.: 86.75   PAL0809:114   1st Qu.: 29.00  \n Median :172.50   PAL0910:120   Median : 58.00  \n Mean   :172.50                 Mean   : 63.15  \n 3rd Qu.:258.25                 3rd Qu.: 95.25  \n Max.   :344.00                 Max.   :152.00  \n                                                \n                                      Species       Region          Island   \n Adelie Penguin (Pygoscelis adeliae)      :152   Anvers:344   Biscoe   :168  \n Chinstrap penguin (Pygoscelis antarctica): 68                Dream    :124  \n Gentoo penguin (Pygoscelis papua)        :124                Torgersen: 52  \n                                                                             \n                                                                             \n                                                                             \n                                                                             \n                Stage     Individual.ID Clutch.Completion       Date.Egg  \n Adult, 1 Egg Stage:344   N13A1  :  3   No : 36           2007-11-27: 18  \n                          N13A2  :  3   Yes:308           2007-11-16: 16  \n                          N18A1  :  3                     2008-11-09: 16  \n                          N18A2  :  3                     2009-11-18: 14  \n                          N21A1  :  3                     2008-11-04: 12  \n                          N21A2  :  3                     2008-11-06: 12  \n                          (Other):326                     (Other)   :256  \n Culmen.Length..mm. Culmen.Depth..mm. Flipper.Length..mm. Body.Mass..g. \n Min.   :32.10      Min.   :13.10     Min.   :172.0       Min.   :2700  \n 1st Qu.:39.23      1st Qu.:15.60     1st Qu.:190.0       1st Qu.:3550  \n Median :44.45      Median :17.30     Median :197.0       Median :4050  \n Mean   :43.92      Mean   :17.15     Mean   :200.9       Mean   :4202  \n 3rd Qu.:48.50      3rd Qu.:18.70     3rd Qu.:213.0       3rd Qu.:4750  \n Max.   :59.60      Max.   :21.50     Max.   :231.0       Max.   :6300  \n NA's   :2          NA's   :2         NA's   :2           NA's   :2     \n     Sex      Delta.15.N..o.oo. Delta.13.C..o.oo.\n FEMALE:165   Min.   : 7.632    Min.   :-27.02   \n MALE  :168   1st Qu.: 8.300    1st Qu.:-26.32   \n NA's  : 11   Median : 8.652    Median :-25.83   \n              Mean   : 8.733    Mean   :-25.69   \n              3rd Qu.: 9.172    3rd Qu.:-25.06   \n              Max.   :10.025    Max.   :-23.79   \n              NA's   :14        NA's   :13       \n                                  Comments  \n Nest never observed with full clutch.: 34  \n Not enough blood for isotopes.       :  7  \n Sexing primers did not amplify.      :  4  \n No blood sample obtained for sexing. :  2  \n No blood sample obtained.            :  2  \n (Other)                              :  5  \n NA's                                 :290  \n\n# dim(data)\n\nNames modification of columns and species :\n\n\nShow the code\ndata &lt;- data %&gt;%\n  select(-X) %&gt;%                   # Remove X column \n  select(-Comments) %&gt;%           # Remove Comments column\n  rename(                          # we rename the columns of the dataset\n    sample_number = Sample.Number,\n    id = Individual.ID,\n    island = Island,\n    region = Region,\n    stage = Stage,\n    clutch_completion = Clutch.Completion,\n    date_egg = Date.Egg,\n    culmen_length = Culmen.Length..mm.,\n    culmen_depth = Culmen.Depth..mm.,\n    flipper_length = Flipper.Length..mm.,\n    body_mass = Body.Mass..g.,\n    sex = Sex,\n    delta_15_N = Delta.15.N..o.oo.,\n    delta_13_C = Delta.13.C..o.oo.,\n    species = Species)\n\nnames(data)\n\n\n [1] \"studyName\"         \"sample_number\"     \"species\"          \n [4] \"region\"            \"island\"            \"stage\"            \n [7] \"id\"                \"clutch_completion\" \"date_egg\"         \n[10] \"culmen_length\"     \"culmen_depth\"      \"flipper_length\"   \n[13] \"body_mass\"         \"sex\"               \"delta_15_N\"       \n[16] \"delta_13_C\"       \n\n\nShow the code\n# rename species\ndata = data %&gt;%\n  mutate(species = recode(species, \"Adelie Penguin (Pygoscelis adeliae)\" = \"Adelie\", \"Chinstrap penguin (Pygoscelis antarctica)\" = \"Chinstrap\", \"Gentoo penguin (Pygoscelis papua)\" = \"Gentoo\"))\n\n\nThese names are easier to understand."
  },
  {
    "objectID": "Penguins_chapter.html#missing-values",
    "href": "Penguins_chapter.html#missing-values",
    "title": "Exploring data on penguins",
    "section": "",
    "text": "The Figure 2 have a red line that represents the mean of missing values (NA) in the dataset and the bars are showing the number of NA’s for each variables.\n\n\nShow the code\n# Verification of missing values\ncolSums(is.na(data)) \n\n\n        studyName     sample_number           species            region \n                0                 0                 0                 0 \n           island             stage                id clutch_completion \n                0                 0                 0                 0 \n         date_egg     culmen_length      culmen_depth    flipper_length \n                0                 2                 2                 2 \n        body_mass               sex        delta_15_N        delta_13_C \n                2                11                14                13 \n\n\nShow the code\ndata_NA &lt;- data \n\n# Representation of missing values\nNA_df &lt;- (colSums(is.na(data_NA)) / nrow(data_NA)) * 100\n\ncolor_pal &lt;- colorRampPalette(c(\"limegreen\", \"yellow\", \"firebrick\"), bias = 20)(10)\nNA_col &lt;- color_pal[as.integer(NA_df/length(NA_df)*9)+1]\n\n# Graphique\nbarplot(NA_df,ylab = \"NA\", col = NA_col, las=2, cex.names=0.6)\n\nNA_mean&lt;-mean(NA_df)\n# 0.78% \n\nabline(h=NA_mean, col = \"red\", lwd = 2)\n\n\n\n\n\nFigure 2: Number of missing value as a function of each variables"
  },
  {
    "objectID": "Penguins_chapter.html#correlation",
    "href": "Penguins_chapter.html#correlation",
    "title": "Exploring data on penguins",
    "section": "Correlation",
    "text": "Correlation\nTo compare these qualitative variables, we begin by examining the correlations among them.\nThe representation of this matrix is not optimal.\n\nsub_data_num = data%&gt;%\n  select(culmen_length, culmen_depth,flipper_length,body_mass,delta_13_C,delta_15_N)%&gt;%\n  na.omit() # we delete the few individuals with NA\n\nmatcor = cor(sub_data_num,method = \"pearson\")\nmatcor\n\n               culmen_length culmen_depth flipper_length  body_mass delta_13_C\nculmen_length     1.00000000   -0.2259394      0.6491779  0.5934113  0.1807339\nculmen_depth     -0.22593935    1.0000000     -0.5810728 -0.4677456  0.4258196\nflipper_length    0.64917789   -0.5810728      1.0000000  0.8748008 -0.3820590\nbody_mass         0.59341135   -0.4677456      0.8748008  1.0000000 -0.3755823\ndelta_13_C        0.18073392    0.4258196     -0.3820590 -0.3755823  1.0000000\ndelta_15_N       -0.05975909    0.6058744     -0.5077872 -0.5378882  0.5706148\n                delta_15_N\nculmen_length  -0.05975909\nculmen_depth    0.60587439\nflipper_length -0.50778717\nbody_mass      -0.53788824\ndelta_13_C      0.57061480\ndelta_15_N      1.00000000\n\n\nWe can use the library corrplot to make some visual correlation matrix.\nThere is a correlation that we have to remove in a multivariate analysis between the body_mass variable and the flipper_length as we can see in Figure 3 and Figure 4.\n\n\nShow the code\ncorrplot(matcor, method = \"number\", type = \"upper\",order = \"hclust\", tl.col=\"black\", tl.srt=45)\n\n\n\n\n\nFigure 3: Correlation matrix with numbers\n\n\n\n\n\n\nShow the code\ncorrplot(matcor, type = \"upper\",order = \"hclust\", tl.col=\"black\", tl.srt=45)\n\n\n\n\n\nFigure 4: Correlation matrix with forms\n\n\n\n\nNow, we want to observe whether certain qualitative variables have an effect on body mass. We will therefore try to create a graph for each factor (qualitative variables) according to body mass:\n- Species\n- Island\n- Sex\n\nWe have noticed some trends in Figure 5 that we will have to confirm with statistical tests.\nBox1: Gentoo penguins appear to be heavier than the other two species.\nBox2: Penguins from Biscoe Island appear to be heavier than the other two islands.\nBox3: Male penguins appear to be heavier than the other two categories.\n\n\nShow the code\nbox1 &lt;- ggplot(data = data)+\n  geom_boxplot(aes(x=species,y=body_mass, fill = species))\n\nbox2 &lt;- ggplot(data = data)+\n  geom_boxplot(aes(x=island,y=body_mass, fill = island))\n\nbox3 &lt;- ggplot(data = data)+\n  geom_boxplot(aes(x=sex,y=body_mass, fill = sex))\nglobal_box &lt;- grid.arrange(box1,box2,box3)\n\n\n\n\n\nFigure 5: Boxplots between body mass and other variables"
  },
  {
    "objectID": "Penguins_chapter.html#violin-plot",
    "href": "Penguins_chapter.html#violin-plot",
    "title": "Exploring data on penguins",
    "section": "Violin plot",
    "text": "Violin plot\nHere is another way to visualize in Figure 6 the distribution between two variables.\n\n\nShow the code\n# Violin plot for Culmen Length (beak length)\nv1 &lt;- ggplot(data, aes(x = species, y = culmen_length, fill = species)) +\n  geom_violin(trim = FALSE) +\n  geom_jitter(shape = 16, position = position_jitter(0.2), color = \"black\", alpha = 0.3) +\n    stat_summary(fun = mean, geom = \"point\", shape = 20, size = 3, fill = \"red\", color = \"red\") +\n  labs(title = \"Distribution of Culmen Length by Species\",\n       x = \"Species\",\n       y = \"Culmen Length (mm)\") +\n  theme_minimal() +\n  theme(legend.position = \"none\",\n        plot.title = element_text(size = 10, face = \"bold\"),\n        axis.title.x = element_text(size = 8),  # Taille de l'axe x\n        axis.title.y = element_text(size = 8))\n\n# Violin plot for Flipper Length\nv2 &lt;- ggplot(data, aes(x = species, y = flipper_length, fill = species)) +\n  geom_violin(trim = FALSE) +\n  geom_jitter(shape = 16, position = position_jitter(0.2), color = \"black\", alpha = 0.3) +\n    stat_summary(fun = mean, geom = \"point\", shape = 20, size = 3, fill = \"red\", color = \"red\") +\n  labs(title = \"Distribution of Flipper Length by Species\",\n       x = \"Species\",\n       y = \"Flipper Length (mm)\") +\n  theme_minimal() +\n  theme(legend.position = \"none\",\n        plot.title = element_text(size = 10, face = \"bold\"),\n        axis.title.x = element_text(size = 8),  # Taille de l'axe x\n        axis.title.y = element_text(size = 8))\n\n# Violin plot for Body Mass\nv3 &lt;- ggplot(data, aes(x = species, y = body_mass, fill = species)) +\n  geom_violin(trim = FALSE) +\n  geom_jitter(shape = 16, position = position_jitter(0.2), color = \"black\", alpha = 0.3) +\n    stat_summary(fun = mean, geom = \"point\", shape = 20, size = 3, fill = \"red\", color = \"red\") +\n  labs(title = \"Distribution of Body Mass by Species\",\n       x = \"Species\",\n       y = \"Body Mass (g)\") +\n  theme_minimal() +\n  theme(legend.position = \"none\",\n        plot.title = element_text(size = 10, face = \"bold\"),\n        axis.title.x = element_text(size = 8),  # Taille de l'axe x\n        axis.title.y = element_text(size = 8))\n\ngrid.arrange(v1, v2, v3,  #names of graphs  \n             ncol = 3, nrow = 1)\n\n\n\n\n\nFigure 6: Violin plot of body mass as function of many variables"
  },
  {
    "objectID": "Penguins_chapter.html#anova-u-mann-whitney-tests-student-test",
    "href": "Penguins_chapter.html#anova-u-mann-whitney-tests-student-test",
    "title": "Exploring data on penguins",
    "section": "ANOVA, U-Mann-Whitney tests, Student test",
    "text": "ANOVA, U-Mann-Whitney tests, Student test\nWe run ANOVA and mean comparison tests to verify these differences.\nThere is a significant difference between the body mass of these 3 species, almost 2 of them, with a p-value of 2e-16.\n\n# homoscedasticity\nbartlett.test(data$body_mass~data$species) # p = 0.05005 &gt; 0.05 homoscedasticity conditions are satisfied\n\n\n    Bartlett test of homogeneity of variances\n\ndata:  data$body_mass by data$species\nBartlett's K-squared = 5.9895, df = 2, p-value = 0.05005\n\nanova1 = aov(data$body_mass~data$species)\n\n#normality of residuals\nshapiro.test(residuals(anova1)) #p = 0.05118 &gt; 0.05, the normality of residuals is accepted\n\n\n    Shapiro-Wilk normality test\n\ndata:  residuals(anova1)\nW = 0.99166, p-value = 0.05118\n\nsummary(anova1)\n\n              Df    Sum Sq  Mean Sq F value Pr(&gt;F)    \ndata$species   2 146864214 73432107   343.6 &lt;2e-16 ***\nResiduals    339  72443483   213698                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n2 observations deleted due to missingness\n\n\nWe perform a Tukey’s post-hoc test to see where the differences lie. There is a significant difference between the body mass of Gentoo and Adelie (p = 0) and Gentoo and Chinstrap (p = 0). There is no significant difference between Adelie and Chinstrap.\n\nTukeyHSD(anova1)\n\n  Tukey multiple comparisons of means\n    95% family-wise confidence level\n\nFit: aov(formula = data$body_mass ~ data$species)\n\n$`data$species`\n                       diff       lwr       upr     p adj\nChinstrap-Adelie   32.42598 -126.5002  191.3522 0.8806666\nGentoo-Adelie    1375.35401 1243.1786 1507.5294 0.0000000\nGentoo-Chinstrap 1342.92802 1178.4810 1507.3750 0.0000000\n\n\nWe cannot perform an ANOVA between body mass and islands because the homoscedasticity conditions are not satisfied, so we will perform a Kruskall-Wallis test. There is a significant difference between the body mass of these 3 islands, almost 2 of them, with a p-value of 2e-16.\n\n# homoscedasticity\nbartlett.test(data$body_mass~data$island) # p = 8.978e-14 &lt; 0.05 homoscedasticity conditions are not satisfied\n\n\n    Bartlett test of homogeneity of variances\n\ndata:  data$body_mass by data$island\nBartlett's K-squared = 60.083, df = 2, p-value = 8.978e-14\n\n# Kruskall Wallis test\nkruskal.test(data$body_mass~data$island)\n\n\n    Kruskal-Wallis rank sum test\n\ndata:  data$body_mass by data$island\nKruskal-Wallis chi-squared = 130.07, df = 2, p-value &lt; 2.2e-16\n\n\nIn order to observe the differences between the islands, we are going to carry out tests to compare the average between each island.\n\n# normality\ntapply(data$body_mass, data$island, shapiro.test)\n\n$Biscoe\n\n    Shapiro-Wilk normality test\n\ndata:  X[[i]]\nW = 0.97247, p-value = 0.00209\n\n\n$Dream\n\n    Shapiro-Wilk normality test\n\ndata:  X[[i]]\nW = 0.98889, p-value = 0.4161\n\n\n$Torgersen\n\n    Shapiro-Wilk normality test\n\ndata:  X[[i]]\nW = 0.97185, p-value = 0.2636\n\n# Biscoe: p = 0.00209 &lt; 0.05, normality is not respected\n# Dream: p = 0.4161 &gt; 0.05, normality is respected\n# Torgersen: p =  0.2636 &gt; 0.05, normality is respected\n\nData normality is respected for Torgensen Island and Dream Island. We will therefore carry out a homoscedasticity test between these islands to determine the appropriate mean comparison test.\n\n# Filter the data between the islands\ndream_data &lt;- subset(data, island == \"Dream\")$body_mass\ntorgersen_data &lt;- subset(data, island == \"Torgersen\")$body_mass\nbiscoe_data &lt;- subset(data, island == \"Biscoe\")$body_mass\n\n# Perform a variance test between the 'Dream' and 'Torgersen' groups\nvar.test(dream_data, torgersen_data) # p = 0.5526 &gt; 0.05, homoscedasticity conditions are satisfied\n\n\n    F test to compare two variances\n\ndata:  dream_data and torgersen_data\nF = 0.87619, num df = 123, denom df = 50, p-value = 0.5526\nalternative hypothesis: true ratio of variances is not equal to 1\n95 percent confidence interval:\n 0.5354096 1.3682404\nsample estimates:\nratio of variances \n         0.8761931 \n\n\nWe will therefore carry out two U-Mann-Whitney tests between the Biscoe and Torgersen Islands and the Biscoe and Dream Islands, and a Student t-test between the Dream and Torgersen Islands.\n\n# U-Mann Withney test between the Biscoe and Torgersen\nwilcox.test(biscoe_data, torgersen_data) # p = 1.396e-14 &lt; 0.05\n\n\n    Wilcoxon rank sum test with continuity correction\n\ndata:  biscoe_data and torgersen_data\nW = 7293, p-value = 1.396e-14\nalternative hypothesis: true location shift is not equal to 0\n\n# U-Mann Withney test between the Biscoe and Dream\nwilcox.test(biscoe_data, dream_data) # p = 2.2e-16 &lt; 0.05\n\n\n    Wilcoxon rank sum test with continuity correction\n\ndata:  biscoe_data and dream_data\nW = 17741, p-value &lt; 2.2e-16\nalternative hypothesis: true location shift is not equal to 0\n\n# Student t-test between the Dream and Torgersen\nt.test(dream_data, torgersen_data, var.equal = T) # p = 0.9265 &gt; 0.05\n\n\n    Two Sample t-test\n\ndata:  dream_data and torgersen_data\nt = 0.092359, df = 173, p-value = 0.9265\nalternative hypothesis: true difference in means is not equal to 0\n95 percent confidence interval:\n -133.0344  146.0958\nsample estimates:\nmean of x mean of y \n 3712.903  3706.373 \n\n\nThere is a significant difference in body mass between Dream and Biscoe Islands (p = 2.2e-16) and between Torgersen and Biscoe Islands (p = 1.396e-14). There was no significant difference between Torgersen and Dream Islands.\nAs there are only two modalities for gender, instead of an ANOVA we will perform a U-Mann-Whitney mean comparison test. There is a significant difference between the body mass and the sex with a p-value of 1.813e-15.\n\n# normality\ntapply(data$body_mass, data$sex, shapiro.test)\n\n$FEMALE\n\n    Shapiro-Wilk normality test\n\ndata:  X[[i]]\nW = 0.91931, p-value = 6.155e-08\n\n\n$MALE\n\n    Shapiro-Wilk normality test\n\ndata:  X[[i]]\nW = 0.92504, p-value = 1.227e-07\n\n# Female: p = 6.155e-08 &lt; 0.05, normality is not respected\n# Male: p = 1.227e-07 &lt; 0.05, normality is not respected\n\n# U-Mann Withney test\nfemale_data = subset(data, sex == \"FEMALE\")$body_mass\nmale_data = subset(data, sex == \"MALE\")$body_mass\nwilcox.test(female_data, male_data) # p = 1.813e-15 &lt; 0.05\n\n\n    Wilcoxon rank sum test with continuity correction\n\ndata:  female_data and male_data\nW = 6874.5, p-value = 1.813e-15\nalternative hypothesis: true location shift is not equal to 0\n\n\nDistribution of species between the islands in Table 1 : we can see from this table that the Adelie species is present on all three islands, while the Chrinstrap and Gentoo species are only present on 2 islands, Dream and Biscoe respectively.\n\n\nShow the code\nspecies_islands &lt;- table(data$island, data$species)\nkable(species_islands, \"html\", escape = F) %&gt;%\n  kable_styling(bootstrap_options = c(\"striped\"),\n                full_width = F,\n                position = \"center\")\n\n\n\n\nTable 1: Species distribution between the islands\n\n\n\nAdelie\nChinstrap\nGentoo\n\n\n\n\nBiscoe\n44\n0\n124\n\n\nDream\n56\n68\n0\n\n\nTorgersen\n52\n0\n0"
  },
  {
    "objectID": "Penguins_chapter.html#graphical-representations-and-interpretations",
    "href": "Penguins_chapter.html#graphical-representations-and-interpretations",
    "title": "Exploring data on penguins",
    "section": "Graphical representations and interpretations",
    "text": "Graphical representations and interpretations\nIn Figure 7, it would appear that there is a positive linear trend between the body_mass variable and flipper_length for each species.\n\n\nShow the code\nggplot(data, aes(x = flipper_length, y = body_mass, color = species))+\n  geom_point()+\n  scale_color_manual(values = c(\"#B2DF8A\",\"#FDBF6F\",\"#CAB2D6\"))+\n  geom_smooth(method = \"lm\", col = \"red\", se = TRUE)+\n  theme_bw()+\n  theme(legend.position = \"none\")+\n  facet_grid(~species)\n\n\n\n\n\nFigure 7: Flipper length as a function of body mass\n\n\n\n\nCheck with linear regression :\n\nrl1 &lt;- lm(body_mass ~ flipper_length + species + species:flipper_length, data = data)\nsummary(rl1)\n\n\nCall:\nlm(formula = body_mass ~ flipper_length + species + species:flipper_length, \n    data = data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-911.18 -251.93  -31.77  197.82 1144.81 \n\nCoefficients:\n                                 Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)                     -2535.837    879.468  -2.883  0.00419 ** \nflipper_length                     32.832      4.627   7.095 7.69e-12 ***\nspeciesChinstrap                 -501.359   1523.459  -0.329  0.74229    \nspeciesGentoo                   -4251.444   1427.332  -2.979  0.00311 ** \nflipper_length:speciesChinstrap     1.742      7.856   0.222  0.82467    \nflipper_length:speciesGentoo       21.791      6.941   3.139  0.00184 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 370.6 on 336 degrees of freedom\n  (2 observations deleted due to missingness)\nMultiple R-squared:  0.7896,    Adjusted R-squared:  0.7864 \nF-statistic: 252.2 on 5 and 336 DF,  p-value: &lt; 2.2e-16\n\n\nThese results show a highly significant effect of fin length for all species, with a greater effect for the Gentoo species. There was also a significant difference in body mass between species except between Adelie and Chinstrap.\nIn conclusion, we can say that fin length influences body mass and that this effect varies according to species.\nIt would appear that there is a positive linear trend between the body_mass variable and flipper_length for each species.\nIn the Figure 8, it would appear that there is a positive linear trend between the culmen_depth variable and culmen_length for each species.\n\n\nShow the code\nggplot(data, aes(x = culmen_length, y = culmen_depth, color = species))+\n  geom_point()+\n  scale_color_manual(values = c(\"#B2DF8A\",\"#FDBF6F\",\"#CAB2D6\"))+\n  geom_smooth(method = \"lm\", col = \"red\", se = TRUE)+\n  theme_bw()+\n  theme(legend.position = \"none\")+\n  facet_grid(~species)\n\n\n\n\n\nFigure 8: Culmen length as a function of culmen depth\n\n\n\n\nCheck with linear regression :\n\nrl2 &lt;- lm(culmen_depth ~ culmen_length + species + species:culmen_length, data = data)\nsummary(rl2)\n\n\nCall:\nlm(formula = culmen_depth ~ culmen_length + species + species:culmen_length, \n    data = data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-2.6574 -0.6675 -0.0524  0.5383  3.5032 \n\nCoefficients:\n                               Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)                    11.40912    1.13812  10.025  &lt; 2e-16 ***\nculmen_length                   0.17883    0.02927   6.110 2.76e-09 ***\nspeciesChinstrap               -3.83998    2.05398  -1.870 0.062419 .  \nspeciesGentoo                  -6.15812    1.75451  -3.510 0.000509 ***\nculmen_length:speciesChinstrap  0.04338    0.04558   0.952 0.341895    \nculmen_length:speciesGentoo     0.02601    0.04054   0.642 0.521590    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.9548 on 336 degrees of freedom\n  (2 observations deleted due to missingness)\nMultiple R-squared:  0.7697,    Adjusted R-squared:  0.7662 \nF-statistic: 224.5 on 5 and 336 DF,  p-value: &lt; 2.2e-16\n\n\nThese results show that beak length is significant and positive in Adelie. In the species Chinstrap and Gentoo, the beak depth is smaller and is significant in Gentoo. At the interaction level, it is not significant, which means that the effect of beak length on depth is relatively the same for 3 species.\nWe can conclude that beak depth depends on beak length but this does not vary between species. Gentoo penguins have a shallower beak than the others.\nIn Figure 9, it seems to be different trends between species.\n\n\nShow the code\nggplot(data, aes(x = delta_15_N, y = delta_13_C, color = species))+\n  geom_point()+\n  scale_color_manual(values = c(\"#B2DF8A\",\"#FDBF6F\",\"#CAB2D6\"))+\n  geom_smooth(method = \"lm\", col = \"red\", se = TRUE)+\n  theme_bw()+\n  theme(legend.position = \"none\")+\n  facet_grid(~species)\n\n\n\n\n\nFigure 9: Delta_15_N as a function of delta_13_C\n\n\n\n\nWe check this using a linear model :\n\nrl3 &lt;- lm(delta_13_C ~ delta_15_N + species + species:delta_15_N, data = data)\nsummary(rl3)\n\n\nCall:\nlm(formula = delta_13_C ~ delta_15_N + species + species:delta_15_N, \n    data = data)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-1.00888 -0.26656 -0.04769  0.20862  1.82777 \n\nCoefficients:\n                             Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)                 -32.01429    0.77063 -41.543  &lt; 2e-16 ***\ndelta_15_N                    0.70093    0.08688   8.068 1.41e-14 ***\nspeciesChinstrap              8.28567    1.57149   5.273 2.46e-07 ***\nspeciesGentoo                15.64751    1.46204  10.702  &lt; 2e-16 ***\ndelta_15_N:speciesChinstrap  -0.78957    0.17013  -4.641 5.04e-06 ***\ndelta_15_N:speciesGentoo     -1.89173    0.17387 -10.880  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.4381 on 324 degrees of freedom\n  (14 observations deleted due to missingness)\nMultiple R-squared:  0.6957,    Adjusted R-squared:  0.691 \nF-statistic: 148.2 on 5 and 324 DF,  p-value: &lt; 2.2e-16\n\n\nThese results show that the relationship between nitrogen 15 and carbon 13 is positive and significant in Adelie, this relationship is reduced in Chinstrap and even more so in Gentoo. Chinstrap and Gentoo have significantly higher carbon-13 values than Adelie. The interactions between nitrogen 15 and the species are significant, showing that the effect of nitrogen 15 on carbon 13 varies according to the species.\nIn conclusion, this model shows that the effect of nitrogen 15 on carbon 13 is highly species-dependent, with differences between species."
  },
  {
    "objectID": "Penguins_chapter.html#principal-component-analysis-pca-of-species-characteristics",
    "href": "Penguins_chapter.html#principal-component-analysis-pca-of-species-characteristics",
    "title": "Exploring data on penguins",
    "section": "Principal Component Analysis (PCA) of species characteristics",
    "text": "Principal Component Analysis (PCA) of species characteristics\n\n# Selection of quantitative data\ndata_numeric &lt;- select_if(data, is.numeric)\n\n# Remove sample_number \n# The body_mass et the flipper_length are more than 80% correlated, we're deleting flipper_length because it's the data that's most correlated with all the other data.\n# names(data_numeric)\ndata_numeric &lt;- data_numeric %&gt;% select(-c(\"sample_number\",\"flipper_length\"))\n\n# Normalizing data\ndata_scales &lt;- scale(data_numeric)\n\n# PCA realization\nacp_data= PCA(data_scales, graph = F)\nsummary(acp_data)\n\n\nCall:\nPCA(X = data_scales, graph = F) \n\n\nEigenvalues\n                       Dim.1   Dim.2   Dim.3   Dim.4   Dim.5\nVariance               2.572   1.351   0.526   0.365   0.185\n% of var.             51.442  27.029  10.525   7.299   3.705\nCumulative % of var.  51.442  78.471  88.996  96.295 100.000\n\nIndividuals (the 10 first)\n                  Dist    Dim.1    ctr   cos2    Dim.2    ctr   cos2    Dim.3\n1             |  1.314 |  0.890  0.090  0.459 | -0.829  0.148  0.397 |  0.320\n2             |  1.649 |  1.245  0.175  0.571 | -0.054  0.001  0.001 | -0.732\n3             |  1.648 |  0.818  0.076  0.246 | -0.828  0.147  0.252 | -0.479\n4             |  0.000 |  0.000  0.000  0.613 |  0.000  0.000  4.990 |  0.000\n5             |  2.017 |  1.562  0.276  0.600 | -1.031  0.229  0.261 |  0.156\n6             |  2.131 |  1.565  0.277  0.539 | -0.580  0.072  0.074 |  0.759\n7             |  1.598 |  1.435  0.233  0.806 | -0.429  0.040  0.072 | -0.315\n8             |  2.345 |  1.636  0.302  0.487 |  0.427  0.039  0.033 |  0.787\n9             |  2.080 |  1.134  0.145  0.297 | -1.659  0.592  0.636 | -0.105\n10            |  1.914 |  1.520  0.261  0.630 |  0.383  0.032  0.040 |  0.891\n                 ctr   cos2  \n1              0.057  0.059 |\n2              0.296  0.197 |\n3              0.126  0.084 |\n4              0.000  4.933 |\n5              0.013  0.006 |\n6              0.318  0.127 |\n7              0.055  0.039 |\n8              0.342  0.113 |\n9              0.006  0.003 |\n10             0.439  0.217 |\n\nVariables\n                 Dim.1    ctr   cos2    Dim.2    ctr   cos2    Dim.3    ctr\nculmen_length | -0.382  5.660  0.146 |  0.885 57.930  0.783 |  0.037  0.260\nculmen_depth  |  0.795 24.599  0.633 |  0.055  0.227  0.003 |  0.555 58.510\nbody_mass     | -0.818 26.034  0.670 |  0.392 11.384  0.154 |  0.304 17.588\ndelta_15_N    |  0.830 26.756  0.688 |  0.282  5.887  0.080 |  0.061  0.719\ndelta_13_C    |  0.660 16.950  0.436 |  0.576 24.572  0.332 | -0.347 22.924\n                cos2  \nculmen_length  0.001 |\nculmen_depth   0.308 |\nbody_mass      0.093 |\ndelta_15_N     0.004 |\ndelta_13_C     0.121 |\n\n\nFigure 10 is an histogram of the variance of the factorial axes with the percentage of inertia of each axis. Here, we keep 2 dimensions and 78.4% inertia.\n\n\nShow the code\n#Variance for each component\nva_propre = fviz_eig(acp_data, main =\"\", choice = \"variance\",\n         label_size =50, addlabels = T,\n         barfill  = \"grey\",barcolor = \"grey\")+\n   ylim(c(0,60))\nva_propre\n\n\n\n\n\nFigure 10: Barplot of eigen values\n\n\n\n\nFigure 11 assess the absolut contribution of variables to each axis. We can see that three variables make a strong contribution to axis 1 (delta_15_N, body_mass and culmen_depth) and 2 to axis 2 (culmen_depth and delta_13_C).\n\n\nShow the code\n#Contribution of axis variables axis 1 and 2\nc1 = fviz_contrib(acp_data,choice = \"var\",axes =1,\n                  fill = \"grey\",color = \"grey\")+ labs(title = \"Axe 1\") #For axe 1\nc2 = fviz_contrib(acp_data,choice = \"var\",axes =2,\n                  fill = \"grey\",color = \"grey\")+ labs(title = \"Axe 2\") #For axe 2\ngrid.arrange(c1,c2, ncol = 2)\n\n\n\n\n\nFigure 11: Barplots of absolut contributions of axe 1 and 2\n\n\n\n\nFirst graph (Figure 12) show the result of PCA on axes 1 and 2. A priori clustering by the Species has been performed. Gentoo penguins have a greater mass and a longer culmen. Adelie are lighter and have a depth culmen. Chinstrap penguins are the lightest and have a long, depth culmen. Adelie and Chinstrap penguins both have a high concentration of carbon 13 and nitrogen 15.\n\n\nShow the code\n#Projection of variables and individuals and differentiation according to species\nbi_plot = fviz_pca_biplot(acp_data, label=\"var\", \n                habillage=data$species, \n                addEllipses = T,\n                ellipse.alpha = F, \n                ylim=c(-3,3.5), xlim = c(-3.5,3.5))+\n  scale_color_manual(values = c(\"#B2DF8A\",\"#FDBF6F\",\"#CAB2D6\"))+\n  theme_minimal()+\n  theme(legend.position = \"bottom\")\ngrid.arrange(bi_plot, va_propre, c1, c2,  #names of graphs\n             ncol = 2, nrow = 3, #How many row and col\n             widths = c(2.2,1), #Here, the first col will be bigger than the second\n             layout_matrix = cbind(c(1,1,1), #On the first col only graph 1 for the 3 rows\n                                   c(2,3,4))) #On the second col, the 3 other graphs\n\n\n\n\n\nFigure 12: Projection of variables and individuals according to species\n\n\n\n\nSecond graph (Figure 13) show the result of PCA on axes 1 and 2. A priori clustering by the Island has been performed. We can see that Gentoo penguins live only on Biscoe Island, while Chinstrap penguins live mainly on Dream Island. Adelie penguins live on these two islands and also on Togersen Island.\nThe common habitats of Chinstrap and Adelie penguins seem to explain the presence of isotopes in these two species, as they must find a similar diet.\n\n\nShow the code\n#Projection of variables and individuals and differentiation according to species \nbi_plot = fviz_pca_biplot(acp_data, label=\"var\",  habillage=data$island,  addEllipses = T,  ellipse.alpha = F,   ylim=c(-3,3.5),xlim = c(-3.5,3.5))+  \n  scale_color_manual(values = c(\"#B2DF8A\",\"#FDBF6F\",\"#CAB2D6\"))+  \n  theme_minimal()+  theme(legend.position = \"bottom\") \ngrid.arrange(bi_plot, va_propre, c1, c2, #names of graphs  \n             ncol = 2, nrow = 3, #How many row and col  \n             widths = c(2.2,1), #Here, the first col will be bigger than the second  \n             layout_matrix = cbind(c(1,1,1), #On the first col only graph 1 for the 3 rows  \n                                   c(2,3,4))) #On the second col, the 3 other graphs\n\n\n\n\n\nFigure 13: Projection of variables and individuals and dfferentiation according to the islands\n\n\n\n\nThere is a significant difference between the body mass of these 3 species, almost 2 of them.\n\nanova2 = aov(body_mass~island, data = data)\n\nsummary(anova2)\n\n             Df    Sum Sq  Mean Sq F value Pr(&gt;F)    \nisland        2  86314512 43157256     110 &lt;2e-16 ***\nResiduals   339 132993186   392310                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n2 observations deleted due to missingness\n\n\nThere is a significant difference between the body mass of these 3 islands, almost 2 of them."
  },
  {
    "objectID": "Penguins_chapter.html#data-exploration",
    "href": "Penguins_chapter.html#data-exploration",
    "title": "Exploring data on penguins",
    "section": "Data exploration",
    "text": "Data exploration\nBefore any modelisation, we have to explore the data to avoid some mistake. These are the different step to follow prior to execute a model:\n\nCheck for aberrant values and distribution shape of the response variable which is here body_mass.\nIf the explanatory variable is quantitative, check for aberrant values and distribution shape, and if the explanatory variable is qualitative, analyse the number mode and the number of individual in each one.\nAnalyse the potential relation between the response variable and the different explanatory variables.\nLook for potential interaction between explanatory variables.\nCheck for potential colinearity between explanatory variables.\n\n\nResponse variable exploration\n\n\nShow the code\npar(mfrow=c(1,3))\n# Cleveland plot\ndotchart(dataLM$body_mass,pch=16,col='dodgerblue3',xlab='Body mass')\n#Histogram\nhist(dataLM$body_mass,col='dodgerblue3',xlab=\"body mass\",main=\"\")\n# Quantile-Quantile plot\nqqnorm(dataLM$body_mass,pch=16,col='dodgerblue3',xlab='')\nqqline(dataLM$body_mass,col='red',lwd=2)\n\n\n\n\n\nFigure 14: Distribution of the values of the variable body mass\n\n\n\n\nWe can see on the first graphic of the Figure 14 that there is no aberrant values for the variable body mass. The two other graphic of the figure show that there is a deviation of normality. However, normality of the response variable is not a requirement for ANCOVA.\n\n\nExplanatory variables exploration\nFirst we invastigate the distribution of the quantitative explanatory variables.\n\n\nShow the code\npar(mfrow=c(5,3))\n\n# Culmen Length\n# Cleveland plot\ndotchart(dataLM$culmen_length,pch=16,col='dodgerblue3',xlab='culmen_length')\n# Histogram\nhist(dataLM$culmen_length,col='dodgerblue3',xlab=\"culmen_length\",main=\"\")\n# Quantile-Quantile plot\nqqnorm(dataLM$culmen_length,pch=16,col='dodgerblue3',xlab='')\nqqline(dataLM$culmen_length,col='red',lwd=2)\n\n# Culmen Depth\n# Cleveland plot\ndotchart(dataLM$culmen_depth,pch=16,col='dodgerblue3',xlab='culmen_depth')\n# Histogram\nhist(dataLM$culmen_depth,col='dodgerblue3',xlab=\"culmen_depth\",main=\"\")\n# Quantile-Quantile plot\nqqnorm(dataLM$culmen_depth,pch=16,col='dodgerblue3',xlab='')\nqqline(dataLM$culmen_depth,col='red',lwd=2)\n\n# Flipper length\n# Cleveland plot\ndotchart(dataLM$flipper_length,pch=16,col='dodgerblue3',xlab='flipper length')\n# Histogram\nhist(dataLM$flipper_length,col='dodgerblue3',xlab=\"flipper length\",main=\"\")\n# Quantile-Quantile plot\nqqnorm(dataLM$flipper_length,pch=16,col='dodgerblue3',xlab='')\nqqline(dataLM$flipper_length,col='red',lwd=2)\n\n# Delta_15_N\n# Cleveland plot\ndotchart(dataLM$delta_15_N,pch=16,col='dodgerblue3',xlab='delta_15_N')\n# Histogram\nhist(dataLM$delta_15_N,col='dodgerblue3',xlab=\"delta_15_N\",main=\"\")\n# Quantile-Quantile plot\nqqnorm(dataLM$delta_15_N,pch=16,col='dodgerblue3',xlab='')\nqqline(dataLM$delta_15_N,col='red',lwd=2)\n\n# Delta_13_C\n# Cleveland plot\ndotchart(dataLM$delta_13_C,pch=16,col='dodgerblue3',xlab='delta_13_C')\n# Histogram\nhist(dataLM$delta_13_C,col='dodgerblue3',xlab=\"delta_13_C\",main=\"\")\n# Quantile-Quantile plot\nqqnorm(dataLM$delta_13_C,pch=16,col='dodgerblue3',xlab='')\nqqline(dataLM$delta_13_C,col='red',lwd=2)\n\n\n\n\n\nFigure 15: Distribution of the values of the explanatory variables\n\n\n\n\nWe can see on the first graphic of each row of the Figure 15 that there is no abberant values for the variable culmen_length, culmen_depth, flipper_length, delta_15_N and delat_13_C. The two other graphic of each row of the figure show that there is a deviation of normality for all explanatory variable. However, normality of the explanatory variable is not a requirement for ANCOVA.\nSecondly we analyse the qualitative explanatory variables. We look at the distribution of the values in the different mode.\n\n# Factor Sex\nsummary(dataLM$sex)\n\nFEMALE   MALE \n   163    161 \n\n# Factor Island\nsummary(dataLM$island)\n\n   Biscoe     Dream Torgersen \n      162       119        43 \n\n# Factor Species\nsummary(dataLM$species)\n\n   Adelie Chinstrap    Gentoo \n      139        67       118 \n\n# Factor Clutch completion\nsummary(dataLM$clutch_completion)\n\n No Yes \n 34 290 \n\n\nWe observe that there is not the same number of observation in each mode so the plan is non orthogonal. This is not mandatory but it is best when the plan is orthogonal.\nSecondly, we explore the dynamics between body mass (response variable) and the explanatory variable, to identify if there any potential trend.\n\n\nShow the code\npar(mfrow=c(5,2))\n# Culmen length\nplot(dataLM$body_mass~dataLM$culmen_length,pch=16,col='dodgerblue3',xlab='culmen length',ylab='body mass')\n# Culmen depth\nplot(dataLM$body_mass~dataLM$culmen_depth,pch=16,col='dodgerblue3',xlab='culmen depth',ylab='body mass')\n# Flipper length\nplot(dataLM$body_mass~dataLM$flipper_length,pch=16,col='dodgerblue3',xlab='flipper length',ylab='body mass')\n# delta 15 N\nplot(dataLM$body_mass~dataLM$delta_15_N,pch=16,col='dodgerblue3',xlab='delta 15N',ylab='body mass')\n# delta 13 C\nplot(dataLM$body_mass~dataLM$delta_13_C,pch=16,col='dodgerblue3',xlab='delta 13C',ylab='body mass')\n#Species\nboxplot(dataLM$body_mass~dataLM$species, varwidth = TRUE, ylab = \"body mass\", xlab = \"Species\", col='darkgrey', main = \"\")\n#Island\nboxplot(dataLM$body_mass~dataLM$island, varwidth = TRUE, ylab = \"body mass\", xlab = \"Island\", col='brown', main = \"\")\n#Clutch completion\nboxplot(dataLM$body_mass~dataLM$clutch_completion, varwidth = TRUE, ylab = \"body mass\", xlab = \"Clutch completion\", col='brown', main = \"\")\n#Sex\nboxplot(dataLM$body_mass~dataLM$sex, varwidth = TRUE, ylab = \"body mass\", xlab = \"Sex\", col='brown', main = \"\")\n\n\n\n\n\nFigure 16: Effect of the explanatories variables on the body mass\n\n\n\n\nWe can see on the Figure 16 that the variables culmen_length, culmen_depth, flipper_length, delta_15_N, species and island seems to influence the body mass. The body mass seems to increase when culmen_length, culmen_depth and flipper_length increase. On the opposite, body mass seems to decrease when delta_15_N increase. The species Gentoo and the individuals of the Biscoe Island seem to have a higher body mass.\nHere we are considering a simple model with no interaction but in some case it can usefull to examine the potential interaction between the different variables.\nIn order to avoid colinearity in modelling, we analyse how the explanatories variables are related. To do so we calculate the correlation between the quantitative explanatories variables and evaluate if the qualitative explanatory variables impact the quantitative one using boxplot.\nWe chose a threshold of 0.7, to ensure there is no colinearity detected between the covariables.\nFirst between covariable: the quantitative explanatories variables.\n\n\nShow the code\ncorrplot.mixed(cor(dataLM %&gt;% select_if(is.numeric)%&gt;%select(-body_mass)),upper=\"square\",lower.col=\"black\", tl.col=\"black\",cl.cex = 0.8,tl.cex = 0.7,number.cex =0.8)\n\n\n\n\n\nFigure 17: Corelation matrice between the covariables\n\n\n\n\nThe threshold above which we cosider there is colinearity is usually choose at +/- 0.7. We can thus see in the Figure 17 that there is no colinearity detected between the covariables.\nThen between cofactors: the qualitative explanatory variables.\n\n\nShow the code\n# Checking collinearity between cofactors and covariables\npar(mfrow=c(5,4))\n#Culmen length and species\nboxplot(dataLM$culmen_length~dataLM$species, varwidth = TRUE, ylab = \"Culmen length\", xlab = \"Species\", col='grey', main = \"\")\n#Culmen length and island\nboxplot(dataLM$culmen_length~dataLM$island, varwidth = TRUE, ylab = \"Culmen length\", xlab = \"Island\", col='grey', main = \"\")\n#Culmen length and sex\nboxplot(dataLM$culmen_length~dataLM$sex, varwidth = TRUE, ylab = \"Culmen length\", xlab = \"Sex\", col='grey', main = \"\")\n#Culmen length and clutch completion\nboxplot(dataLM$culmen_length~dataLM$clutch_completion, varwidth = TRUE, ylab = \"Culmen length\", xlab = \"Clutch completion\", col='grey', main = \"\")\n\n#Culmen depth and species\nboxplot(dataLM$culmen_depth~dataLM$species, varwidth = TRUE, ylab = \"Culmen depth\", xlab = \"Species\", col='grey', main = \"\")\n#Culmen depth and island\nboxplot(dataLM$culmen_depth~dataLM$island, varwidth = TRUE, ylab = \"Culmen depth\", xlab = \"Island\", col='grey', main = \"\")\n#Culmen depth and sex\nboxplot(dataLM$culmen_depth~dataLM$sex, varwidth = TRUE, ylab = \"Culmen depth\", xlab = \"Sex\", col='grey', main = \"\")\n#Culmen depth and clutch completion\nboxplot(dataLM$culmen_depth~dataLM$clutch_completion, varwidth = TRUE, ylab = \"Culmen depth\", xlab = \"Clutch completion\", col='grey', main = \"\")\n\n#Flipper length and species\nboxplot(dataLM$flipper_length~dataLM$species, varwidth = TRUE, ylab = \"Flipper length\", xlab = \"Species\", col='grey', main = \"\")\n#Flipper length and island\nboxplot(dataLM$flipper_length~dataLM$island, varwidth = TRUE, ylab = \"Flipper length\", xlab = \"Island\", col='grey', main = \"\")\n#Flipper length and sex\nboxplot(dataLM$flipper_length~dataLM$sex, varwidth = TRUE, ylab = \"Flipper length\", xlab = \"Sex\", col='grey', main = \"\")\n#Flipper length and clutch completion\nboxplot(dataLM$flipper_length~dataLM$clutch_completion, varwidth = TRUE, ylab = \"Flipper length\", xlab = \"Clutch completion\", col='grey', main = \"\")\n\n#delta 15N and species\nboxplot(dataLM$delta_15_N~dataLM$species, varwidth = TRUE, ylab = \"delta 15N\", xlab = \"Species\", col='grey', main = \"\")\n#delta 15N and island\nboxplot(dataLM$delta_15_N~dataLM$island, varwidth = TRUE, ylab = \"delta 15N\", xlab = \"Island\", col='grey', main = \"\")\n#delta 15N and sex\nboxplot(dataLM$delta_15_N~dataLM$sex, varwidth = TRUE, ylab = \"delta 15N\", xlab = \"Sex\", col='grey', main = \"\")\n#delta 15N and clutch completion\nboxplot(dataLM$delta_15_N~dataLM$clutch_completion, varwidth = TRUE, ylab = \"delta 15N\", xlab = \"Clutch completion\", col='grey', main = \"\")\n\n#delta 13C and species\nboxplot(dataLM$delta_13_C~dataLM$species, varwidth = TRUE, ylab = \"delta 13C\", xlab = \"Species\", col='grey', main = \"\")\n#delta 13C and island\nboxplot(dataLM$delta_13_C~dataLM$island, varwidth = TRUE, ylab = \"delta 13C\", xlab = \"Island\", col='grey', main = \"\")\n#delta 13C and sex\nboxplot(dataLM$delta_13_C~dataLM$sex, varwidth = TRUE, ylab = \"delta 13C\", xlab = \"Sex\", col='grey', main = \"\")\n#delta 13C and clutch completion\nboxplot(dataLM$delta_13_C~dataLM$clutch_completion, varwidth = TRUE, ylab = \"delta 13C\", xlab = \"Clutch completion\", col='grey', main = \"\")\n\n\n\n\n\nFigure 18: Exploration of potential colinearities between cofactors and covariable\n\n\n\n\nAccording to the Figure 18 there is no colinearity between cofactors and covariables.\nWe keep all our explanatory variables to do the modelisation."
  },
  {
    "objectID": "Penguins_chapter.html#model-selection",
    "href": "Penguins_chapter.html#model-selection",
    "title": "Exploring data on penguins",
    "section": "Model selection",
    "text": "Model selection\nFor the statistic modelisation, we analyse first the full model, which means the model including all explanatories variables.\nIn order to identify the candidate model from the full model, we are going to use the backward selection model. This method is based on the significance of the model terms. From the full model, we identify the significance of each term of the model and proceed to a skimming of the non-sgnificant terms. The withdraw on the non significant term have to follow two step:\nFirst step : remove successively the non significant interaction\nSecond step : remove successively the explanatory variable that are non significant and not include in interaction terms\n\nFirst we build the full model:\n\nmodlm&lt;-lm(body_mass ~ species + island + clutch_completion + culmen_length + culmen_depth + flipper_length + sex + delta_15_N + delta_13_C,data=dataLM) #full model\n\nUsing the function drop1 we analyse the significance of each variables:\n\ndrop1(modlm,test=\"F\") #test significativté des variables avec test fischer\n\nSingle term deletions\n\nModel:\nbody_mass ~ species + island + clutch_completion + culmen_length + \n    culmen_depth + flipper_length + sex + delta_15_N + delta_13_C\n                  Df Sum of Sq      RSS    AIC F value    Pr(&gt;F)    \n&lt;none&gt;                         24182707 3659.4                      \nspecies            2   5084613 29267320 3717.2 32.8003 1.178e-13 ***\nisland             2     69965 24252672 3656.3  0.4513 0.6371895    \nclutch_completion  1    191844 24374551 3660.0  2.4751 0.1166736    \nculmen_length      1    474327 24657033 3663.7  6.1197 0.0139006 *  \nculmen_depth       1    776489 24959196 3667.7 10.0181 0.0017031 ** \nflipper_length     1   2679918 26862625 3691.5 34.5757 1.054e-08 ***\nsex                1   5851484 30034190 3727.6 75.4946 &lt; 2.2e-16 ***\ndelta_15_N         1   1027298 25210005 3670.9 13.2540 0.0003183 ***\ndelta_13_C         1    353797 24536504 3662.1  4.5646 0.0334167 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nWe exclude the variable island of the model, because it is the non-significant variable with the highest p-value. Then, we create a new model (without the variable island) and test for significance.\n\nmodlm2&lt;-lm(body_mass ~ species + clutch_completion + culmen_length + \n    culmen_depth + flipper_length + sex + delta_15_N + delta_13_C, data=dataLM)\ndrop1(modlm2,test=\"F\")\n\nSingle term deletions\n\nModel:\nbody_mass ~ species + clutch_completion + culmen_length + culmen_depth + \n    flipper_length + sex + delta_15_N + delta_13_C\n                  Df Sum of Sq      RSS    AIC F value    Pr(&gt;F)    \n&lt;none&gt;                         24252672 3656.3                      \nspecies            2   6638740 30891412 3730.7 42.9760 &lt; 2.2e-16 ***\nclutch_completion  1    235068 24487740 3657.5  3.0434 0.0820427 .  \nculmen_length      1    481954 24734626 3660.7  6.2399 0.0130018 *  \nculmen_depth       1    784713 25037386 3664.7 10.1597 0.0015800 ** \nflipper_length     1   2630322 26882994 3687.7 34.0548 1.334e-08 ***\nsex                1   5935926 30188599 3725.3 76.8526 &lt; 2.2e-16 ***\ndelta_15_N         1    996020 25248693 3667.4 12.8955 0.0003821 ***\ndelta_13_C         1    333909 24586581 3658.8  4.3231 0.0384091 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nAs previously, we exclude the variable clutch_completion of the model, because it is non-significant. We build a new model and test again for variables’ significance.\n\nmodlm3&lt;-lm(body_mass ~ species + culmen_length + \n    culmen_depth + flipper_length + sex + delta_15_N + delta_13_C, data=dataLM)\ndrop1(modlm3,test=\"F\")\n\nSingle term deletions\n\nModel:\nbody_mass ~ species + culmen_length + culmen_depth + flipper_length + \n    sex + delta_15_N + delta_13_C\n               Df Sum of Sq      RSS    AIC F value    Pr(&gt;F)    \n&lt;none&gt;                      24487740 3657.5                      \nspecies         2   6586068 31073809 3730.6 42.3602 &lt; 2.2e-16 ***\nculmen_length   1    462092 24949833 3661.5  5.9442 0.0153187 *  \nculmen_depth    1    767080 25254821 3665.5  9.8674 0.0018420 ** \nflipper_length  1   2774571 27262312 3690.2 35.6909 6.246e-09 ***\nsex             1   5977734 30465475 3726.2 76.8951 &lt; 2.2e-16 ***\ndelta_15_N      1   1086210 25573950 3669.5 13.9725 0.0002203 ***\ndelta_13_C      1    335608 24823349 3659.9  4.3171 0.0385403 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nAll the variable in the model are significant, so we keep all of them in our final model. The best model is thus: \\(body\\:mass\\) ~ \\(species + culmen_{length} + culmen_{depth} + flipper_{length} + sex + delta\\:15\\:N + delta\\:13\\:C\\)\nUsing the function summary we can acces the coefficient for all variable.\n\nsummary(modlm3)\n\n\nCall:\nlm(formula = body_mass ~ species + culmen_length + culmen_depth + \n    flipper_length + sex + delta_15_N + delta_13_C, data = dataLM)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-681.10 -184.79   -3.52  186.14  822.43 \n\nCoefficients:\n                 Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)      1467.105   1051.184   1.396  0.16380    \nspeciesChinstrap -245.090     89.050  -2.752  0.00626 ** \nspeciesGentoo     882.101    131.653   6.700 9.59e-11 ***\nculmen_length      17.063      6.998   2.438  0.01532 *  \nculmen_depth       61.555     19.596   3.141  0.00184 ** \nflipper_length     17.757      2.972   5.974 6.25e-09 ***\nsexMALE           417.889     47.655   8.769  &lt; 2e-16 ***\ndelta_15_N       -164.321     43.960  -3.738  0.00022 ***\ndelta_13_C         65.171     31.366   2.078  0.03854 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 278.8 on 315 degrees of freedom\nMultiple R-squared:  0.8842,    Adjusted R-squared:  0.8813 \nF-statistic: 300.8 on 8 and 315 DF,  p-value: &lt; 2.2e-16\n\n\nThe model can thus be written as:\n\\[ Body\\:Mass = 1467.1\\:-\\:164.3^{***}. Delta\\:15N\\:+\\:65.2^{*}. Delta\\:13C\\] \\[+\\:(Species_{Adeliae} = 0 \\:;\\:Species_{Pygoscelis antarctica} = -245.1^{**}\\:;\\:Species_{Pygoscelis papua} = 882.1^{***})\\] \\[ +\\:17.1^{*NS*}. Culmen\\:Length\\:+\\:61.6^{**}. Culmen\\:Depth\\:+\\:17.8^{***}. Flipper\\:Length \\] \\[ + (Sex_{Female}= 0\\:;\\: Sex_{Male}=417.9^{***})\\]\nFrom the summary of the model we can also access the variance proportion that is explained by the model. It correspond to the variable of Adjusted R-squared which is here 0.8813. The model is thus explaining 88% of the body mass variance."
  },
  {
    "objectID": "Penguins_chapter.html#model-validation",
    "href": "Penguins_chapter.html#model-validation",
    "title": "Exploring data on penguins",
    "section": "Model validation",
    "text": "Model validation\nThe hypotheses for ANCOVA are independence, residuals normality and variance homogeneity. We also need to check for influent statistics unities, which means an observation with a high contribution to model construction.\nHere, we assume an independence of variables as we don’t have the details of the data collection.\nWe check the normality of residuals.\n\n\nShow the code\npar(mfrow=c(1,2))\n# Histogram\nhist(modlm3$residuals,col='dodgerblue3',xlab=\"residuals\",main=\"Check Normality\")\n# Quantile-Quantile plot\nqqnorm(modlm3$residuals,pch=16,col='dodgerblue3',xlab='')\nqqline(modlm3$residuals,col='red',lwd=2)\n\n\n\n\n\nFigure 19: Verification of residuals normality\n\n\n\n\nWe can see on the first plot of Figure 19 that the histogram seems to have a normal distribution. This is confirmed by the second plot of the figure where we can see that the residuals are align with the red line, which means that the residuals have a normal distribution.\nWe check the homoscedasticity of residuals.\n\n\nShow the code\n# residuals vs fitted\nplot(residuals(modlm3)~fitted(modlm3)\n      , col='dodgerblue3'\n      , pch=16)\nabline(h = 0)\n\n\n\n\n\nFigure 20: verification of residuals homoscedasticity\n\n\n\n\nWe can see on the Figure 20 that there is no tendency on the point repartition. We can thus conclude that the variance is homogeneous.\nWe also verify that there is not individual that is particularly influential.\n\n\nShow the code\npar(mfrow = c(1, 1))\nplot(cooks.distance(modlm3), type = \"h\", ylim = c(0, 1))\nabline(h = 1, col = 2,lwd = 3)\n\n\n\n\n\nFigure 21: Verification of influential individual\n\n\n\n\nAs all the bar are lower that 1 on the Figure 21, we can conclude that there is no influential individuals.\nFinally, we can conclude that the linear model is valid."
  },
  {
    "objectID": "fichier_r.html",
    "href": "fichier_r.html",
    "title": "Unveiling the influence of climatic factors on reproductive patterns in neotropical bats through a Bayesian framework",
    "section": "",
    "text": "French Guiana is a territory belonging to the bio-geographic unit of the Guiana Shield ((hollowell_checklist_2005?)) With an area of 83,846 km², it hosts, like its neighboring territories, remarkable species diversity. Covered by 97% forest habitat mosaic, its extreme species diversity is well-documented. French Guiana represents a global hotspot in terms of bat species richness. The most commonly used method for studying bats in tropical regions is ground-level mist netting, followed by canopy netting and direct roost searche ((macswiney_g_what_2008?)). It is with these methods that the first studies on bat community characterization were conducted ((charles-dominique_pierre_chauves-souris_2001?)). To date, very little work has focused on exploring the reproduction patterns of Neotropical bat communities. Reproductive patterns are closely related to rainfall regimes ((ruiz-ramoni_reproductive_2016?)) frequently occurring twice a year in tropical regions."
  },
  {
    "objectID": "fichier_r.html#a.-importation-of-datasets-and-packages",
    "href": "fichier_r.html#a.-importation-of-datasets-and-packages",
    "title": "Unveiling the influence of climatic factors on reproductive patterns in neotropical bats through a Bayesian framework",
    "section": "A. Importation of datasets and packages",
    "text": "A. Importation of datasets and packages\nWe load 4 datasets which will later be cleaned, edited and fused :\n- data_chiro contains information collected during each capture event of the study : date, location in French Guiana, sex, age and reproductive state of the captured bats.\n- data_abiot_50_22 and data_abiot_23_24 describe meteorological data from French Guiana from 1950 to 2024. We retrieved it from data.gouv.\n- coord_chiro containing capture locations’ coordinates (degree minute second), closest municipality and locality.\n\ndata_chiro&lt;-read_excel(\"data_chiro.xlsx\")\ndata_abiot_50_22&lt;-read.csv(\"abiot_1950_2022.csv\", sep = \";\") \ndata_abiot_23_24&lt;-read.csv(\"abiot_2023_2024.csv\", sep = \";\") \ncoord_chiro&lt;-read_excel(\"COORD_CAPTURE.xlsx\")"
  },
  {
    "objectID": "fichier_r.html#b.-processing-of-the-abiotic-dataset",
    "href": "fichier_r.html#b.-processing-of-the-abiotic-dataset",
    "title": "Unveiling the influence of climatic factors on reproductive patterns in neotropical bats through a Bayesian framework",
    "section": "B. Processing of the abiotic dataset",
    "text": "B. Processing of the abiotic dataset\n\nFirstly we concatenate all the abiotic data together\nThen we start to clean the abiotic the dataset by deleting all years that precede the first event of capture, the we use the Lubridate R package ((spinu_lubridate_2010?)) to formate the data column as we want and the dplyr R package ((wickham_dplyr_2023?)) to reorganize the data set.\n\n\ndata_abiot&lt;-rbind(data_abiot_50_22, data_abiot_23_24)\ndata_abiot &lt;- data_abiot %&gt;%\n  filter(AAAAMMJJ &gt;= 20141028) %&gt;% \n  mutate(AAAAMMJJ = ymd(AAAAMMJJ)) %&gt;% \n  mutate(Year = year(AAAAMMJJ)) %&gt;% \n  mutate(AAAAMMJJ = format(AAAAMMJJ, \"%d-%m-%Y\")) %&gt;% \n  select(NUM_POSTE, NOM_USUEL, LAT, LON, AAAAMMJJ, RR, TM, TAMPLI, FFM, Year) %&gt;%\n  rename(date = AAAAMMJJ, rain_mm = RR, Temperature = TM, ampli_Temp = TAMPLI, wind_ms = FFM, COMMUNE = NOM_USUEL)%&gt;% \n  mutate(julian_day = yday(date)) \n\nComputing moonlight intensity :\n\nFunction that simulates the lunar cycle as a proxy for night-time luminosity\n\n\nLune &lt;- function(date){\n  sortie &lt;- c() \n  for(i in 1:length(date)){ \n    date_num &lt;- as.numeric(as.Date(date[i],format=\"%d-%m-%Y\")) \n    sortie[i] &lt;- (0.5*(cos((date_num-21)*((2*pi)/(29.530589)))+1)) \n  }\n  return(sortie)\n}\n\ndata_abiot$Lune &lt;-Lune(data_abiot$date)"
  },
  {
    "objectID": "fichier_r.html#c.-processing-of-the-biotic-dataset",
    "href": "fichier_r.html#c.-processing-of-the-biotic-dataset",
    "title": "Unveiling the influence of climatic factors on reproductive patterns in neotropical bats through a Bayesian framework",
    "section": "C. Processing of the biotic dataset",
    "text": "C. Processing of the biotic dataset\n\nData_chiro table pre-processing : We only keep the columns of interest, then we only keep the female individuals because the reproduction indices are mainly observable on females. We only keep adult individuals because this is the age class likely to have reproductive indices.\n\n\ndata_chiro &lt;- data_chiro %&gt;%\n  select(c(Année, Commune, Localité, Date, Espèce, Sexe, Repro, Age)) %&gt;% #select the columns we want\n  filter(Sexe == \"F\") %&gt;% \n  filter(Age == \"AD\") %&gt;% \n  filter(is.na(Repro)*1==0)%&gt;%\n  mutate(Date = ymd(Date)) %&gt;%  \n  mutate(Year = year(Date)) %&gt;% \n  mutate(Date = format(Date, \"%d-%m-%Y\"))%&gt;% \n  mutate(julian_day = yday(Date))%&gt;% #Date =julian_day\n  rename(LIEU_DIT = Localité, COMMUNE = Commune) #on renomme\n\nConverting DMS coordinates to decimal coordinates :\n\nFunction to converting minute/second degree into decimal degrees\n\n\nconvert_dms_to_decimal &lt;- function(dms) {\n  parts &lt;- str_match(dms, \"(\\\\d+)°(\\\\d+)'(\\\\d+\\\\.?\\\\d*)''\\\\s([NSEW])\")\n  degrees &lt;- as.numeric(parts[, 2]) \n  minutes &lt;- as.numeric(parts[, 3])\n  seconds &lt;- as.numeric(parts[, 4])\n  direction &lt;- parts[, 5]\n  decimal &lt;- degrees + minutes / 60 + seconds / 3600\n  if (direction %in% c(\"S\", \"W\")) {\n    decimal &lt;- -decimal\n  }\n  \n  return(decimal)\n}\n\n\nWe convert the DMS coordinates to decimal coordinates and we merge it with data_chiro by the capture locality\n\n\nlibrary(stringr)\ncoord_chiro &lt;- coord_chiro %&gt;%\n  rowwise() %&gt;%  \n  mutate(\n    lon_dms = str_extract(COORD, \"^[^N]+W\"), \n    lat_dms = str_extract(COORD, \"[^W]+N\"),  \n    Longitude = convert_dms_to_decimal(lon_dms), \n    Latitude = convert_dms_to_decimal(lat_dms) \n  ) %&gt;%\n  ungroup() %&gt;% \n  select(COMMUNE, LIEU_DIT, Latitude, Longitude)%&gt;%\n  rename(LAT = Latitude, LON = Longitude)\n\ndata_chiro &lt;- data_chiro %&gt;%\n  inner_join(coord_chiro, by = \"LIEU_DIT\") \n\ndata_chiro &lt;- data_chiro%&gt;%\n  select(COMMUNE.x,LIEU_DIT,Date,Espèce,Sexe,Repro,Age,Year,julian_day,LAT,LON)%&gt;% \n  rename(COMMUNE = COMMUNE.x)"
  },
  {
    "objectID": "fichier_r.html#d.-graphical-representation-of-french-guiana-with-the-incorporation-of-meteorological-stations-and-capture-points",
    "href": "fichier_r.html#d.-graphical-representation-of-french-guiana-with-the-incorporation-of-meteorological-stations-and-capture-points",
    "title": "Unveiling the influence of climatic factors on reproductive patterns in neotropical bats through a Bayesian framework",
    "section": "D. Graphical representation of French Guiana with the incorporation of meteorological stations and capture points",
    "text": "D. Graphical representation of French Guiana with the incorporation of meteorological stations and capture points\nIn the graphic we can see in blue the capture points and in green the meteorological stations\n\nlimite &lt;- matrix(c(-54.40582467596958,5.123666986130482,0 -54.45958864979806,4.753175826159146,0 -54.43393543693306,4.077331065323269,0 -54.01198973780399,3.581399050490593,0 -54.20921816638264,3.132878544854336,0 -54.21013685965725,2.796587485871633,0 -54.45803260870573,2.441977197957256,0 -54.68709817836254,2.314479358976484,0 -54.15543583603689,2.123868408305178,0 -53.7651653142448,2.30335873628299,0 -53.35415060581271,2.164099707075567,0 -52.94875879245732,2.132858726757194,0 -52.56611638847146,2.518366090728264,0 -52.59199025844659,2.634734023219086,0 -52.39229001432994,2.890167168832993,0 -52.37091318927082,3.144918005801542,0 -52.21064002801557,3.274351081759725,0 -51.9836274889358,3.696015530721377,0 -51.6721839730206,4.031282773145124,0 -51.63663780527241,4.28966735155517,0 -51.9023261931293,4.501855027711033,0 -52.05244725433236,4.818896971774704,0 -52.51627884489513,5.026927311475695,0 -52.703088477061,5.197262336288941,0 -53.15061905132664,5.577522799535109,0 -53.53420039840946,5.573574890423137,0 -53.95403768383684,5.781472322818466,0 -54.40582467596958,5.123666986130482),ncol=2,byrow=T)\n\nplot(limite[,1],limite[,2],type='l')\npoints(data_abiot$LON,data_abiot$LAT,pch=20,col='green')\npoints(coord_chiro$LON,coord_chiro$LAT,pch=20,col=\"blue\")\n\n\n\n\nTo estimate the meteorogical values at capture sites, we used spatial interpolation. For each date and each value of interest, we measured at first wether or not there was an spatial structure using the moran test. If there is no spatial structure, we estimate the value by meaning the observed values. If there is a spatial structure, we realise a kriging. Because of the necessity to automatise this interpolation, the method is not completely correct, however the weather in French Guiana is not very heterogenous, and is mostly gradients to the ocean or east-west gradient. Morover, the data we obtain show the same patterns of dry season and rain season, and for all the values."
  },
  {
    "objectID": "fichier_r.html#a.-quick-introduction-to-the-bayesian-approach",
    "href": "fichier_r.html#a.-quick-introduction-to-the-bayesian-approach",
    "title": "Unveiling the influence of climatic factors on reproductive patterns in neotropical bats through a Bayesian framework",
    "section": "A. Quick introduction to the Bayesian approach",
    "text": "A. Quick introduction to the Bayesian approach\nThis theorem is based on conditional probabilities :\n\\[\nP(B \\mid A) = \\displaystyle{\\frac{ P(A \\mid B) \\; P(B)}{P(A)}}\n\\]\nBut we might try to explain it more simply as this :\n\\[\nP(\\text{hypothesis} \\mid \\text{data}) = \\frac{P(\\text{data} \\mid \\text{hypothesis}) \\cdot P(\\text{hypothesis})}{P(\\text{data})}\n\\]"
  },
  {
    "objectID": "fichier_r.html#b.-little-exploration-of-how-our-response-variable-react-with-different-covariates",
    "href": "fichier_r.html#b.-little-exploration-of-how-our-response-variable-react-with-different-covariates",
    "title": "Unveiling the influence of climatic factors on reproductive patterns in neotropical bats through a Bayesian framework",
    "section": "B. Little exploration of how our response variable react with different covariates",
    "text": "B. Little exploration of how our response variable react with different covariates\n\npar(mfrow=c(2,2))\n\nggplot(data_final, aes(Amplitude, repro_positive)) +\n  geom_point() + \n  geom_smooth(method = \"loess\") +\n  scale_y_continuous(trans='log10')\n\n\n\nggplot(data_final, aes(julian_day, repro_positive)) +\n  geom_point() + \n  geom_smooth(method = \"loess\") +\n  scale_y_continuous(trans='log10')\n\n\n\nggplot(data_final, aes(Pluie, repro_positive)) +\n  geom_point() + \n  geom_smooth(method = \"loess\")\n\n\n\nggplot(data_final, aes(Température, repro_positive)) +\n  geom_point() + \n  geom_smooth(method = \"loess\") +\n  scale_y_continuous(trans='log10')\n\n\n\n\nAt this point, we might be tempted to see whether or not these climatic parameters influence the proportion of reproductive individuals… let’s try!!"
  },
  {
    "objectID": "fichier_r.html#c.-study-of-climatic-influence-on-the-proportion-of-breeding-indidivids",
    "href": "fichier_r.html#c.-study-of-climatic-influence-on-the-proportion-of-breeding-indidivids",
    "title": "Unveiling the influence of climatic factors on reproductive patterns in neotropical bats through a Bayesian framework",
    "section": "C. Study of climatic influence on the proportion of breeding indidivids",
    "text": "C. Study of climatic influence on the proportion of breeding indidivids\nLet’s see the distribution of reproductive individuals :\n\nhist(data_final$repro_positive, breaks = 20)\n\n\n\n\nThe number of individuals showing reproductive activity seems to follow a negative-binomial distribution, but we encountered some issues to write and fit model using a negative binomial distribution… anyway ! Let’s try to investigate with a binomial !\nFirst, we create an object containing our covariates of interest, we use a common practice which consists of centering-reducing the values of covariates:\n\ndatax &lt;- list(\n  N = nrow(data_final), \n  repro_positive = data_final$repro_positive,  \n  total_individuals = data_final$total_individuals,  \n  temp = (data_final$Température - mean(data_final$Température)) / sd(data_final$Température),  \n  rain = (data_final$Pluie - mean(data_final$Pluie)) / sd(data_final$Pluie),\n  julian_day = (data_final$julian_day - mean(data_final$julian_day)) / sd(data_final$julian_day))\n\nWe write our null model and we assume that the number of reproductive individuals follows a binomial distribution. Specifically, we define our model as follows:\n\\[\\text{repro_positive}[i] \\sim \\text{Binomial}(p[i], \\text{total_individuals}[i])\\]\nIn this model, \\(\\text{repro_positive}[i]\\) represents the number of reproductive individuals observed for each observation ( i ), while \\(\\text{total_individuals}[i]\\) is the total number of individuals in the corresponding group. The parameter \\(p[i]\\) is the probability of an individual being reproductive, modeled using the logit link function, where ( a ) is a parameter drawn from a normal distribution with mean 0 and a large variance (0.001), reflecting our prior belief about its value.\n\\[\\text{logit}(p[i]) = a\\]\nHere is the null model in Jags language:\n\nmodel_null &lt;- \n  paste(\"\nmodel {\n  for (i in 1:N) {\n    repro_positive[i] ~ dbin(p[i], total_individuals[i])  \n    logit(p[i]) &lt;- a\n  }\n  a ~ dnorm(0, 0.001)  \n}\n\")\n\nThen we set the initial values for the Monte-Carlo Markov Chains, we choose to set two chains to assess initial at different values to see if both converge to same distribution.\n\ninit1 &lt;- list (a = -0.5)\ninit2 &lt;- list (a = 0.5)   \ninits &lt;- list(init1,init2)\n\nWe specify the parameter we want to estimate :\n\nparameters &lt;- c(\"a\")\n\nThe run the model with the function jags() :\n\nchiro_model_null &lt;- jags(data = datax,\n              inits = inits, \n              parameters.to.save = parameters, \n              model.file = textConnection(model_null), \n              n.chains = 2, \n              n.iter = 5000, \n              n.burnin = 1000) \n\nCompiling model graph\n   Resolving undeclared variables\n   Allocating nodes\nGraph information:\n   Observed stochastic nodes: 246\n   Unobserved stochastic nodes: 1\n   Total graph size: 497\n\nInitializing model\n\n\nAfter fitting the model, we can explore how it went through some useful tools :\n\ntraceplot() allows to see how MCMC converge\n\n\ntraceplot(chiro_model_null, mfrow = c(1,1), varnames = c(\"a\"), ask = F)\n\n\n\n\n\n\nautocorr.plot(as.mcmc(chiro_model_null), ask = F)\n\n\n\n\n\n\n\nWe can also print the object that contain the model to check other features like the estimate of the parameter, the deviance, credible intervals or the number of values used to assess the posterior distribution (n.eff)\n\nprint(chiro_model_null)\n\nInference for Bugs model at \"4\", fit using jags,\n 2 chains, each with 5000 iterations (first 1000 discarded), n.thin = 4\n n.sims = 2000 iterations saved\n         mu.vect sd.vect    2.5%     25%     50%     75%   97.5%  Rhat n.eff\na          1.655   0.074   1.509   1.602   1.655   1.704   1.800 1.001  2000\ndeviance 755.047   1.393 754.026 754.130 754.503 755.381 758.902 1.001  2000\n\nFor each parameter, n.eff is a crude measure of effective sample size,\nand Rhat is the potential scale reduction factor (at convergence, Rhat=1).\n\nDIC info (using the rule, pD = var(deviance)/2)\npD = 1.0 and DIC = 756.0\nDIC is an estimate of expected predictive error (lower deviance is better).\n\n\nNow, we put the estimated values of the two MCMC chains in the same object :\n\nres&lt;-as.mcmc(chiro_model_null)\nres&lt;-rbind(res[[1]], res[[2]])\n\nThen we can compute the mean of the estimated values of the intercept that are &lt; 0 :\n\nmean(res[,'a']&lt;0)\n\n[1] 0\n\n\nAnd we can plot the estimated posterior distribution of our parameter ‘a’ :\n\npar(mfrow=c(1,1))\nplot(density(res[,'a']),xlab=\"\",ylab=\"\", main=\"intercept\",lwd=3,xlim=c(-0.1,2))\nabline(v=0,col='red',lwd=2)\n\n\n\n\nRemember that we defined a non-informative prior on parameter ‘a’ : a ~ dnorm(0, 0.001) to see if test the effect of ‘a’ on \\(p[i]\\)\nYou can compute the Watanabe-Akaike Information Criterion :\n\nsamples_waic_null&lt;-jags.samples(chiro_model_null$model, c(\"WAIC\", \"deviance\"), type = \"mean\",\n                           n.iter = 10000,\n                           n.burnin = 1000,\n                           n.thin = 1)\nsamples_waic_null$p_waic&lt;-samples_waic_null$WAIC\nsamples_waic_null$waic&lt;-samples_waic_null$deviance + samples_waic_null$p_waic\ntmp&lt;-sapply(samples_waic_null, sum)\nwaic_null&lt;-round(c(waic = tmp[[\"waic\"]], p_waic = tmp[[\"p_waic\"]]),1)\nwaic_null\n\n  waic p_waic \n 758.2    3.2 \n\n\nWe write and fit several models with different parameters (rain, temperature, julian day and thermal amplitude) and we compute the WAIC for each of them:\nHere the table of the different models we fitted :\n\nwaic_table&lt;-read.table(\"waic_model.txt\", header = T)\nwaic_table\n\n                          model  waic p_waic\n1          model_rain_temp_jday 523.3   18.4\n2 model_rain_temp_jday_thermamp 528.2   22.6\n3                    model_jday 533.9   11.9\n4               model_rain_jday 541.1   17.6\n5               model_rain_temp 594.0   10.8\n6                    model_null 616.3    3.2\n7                    model_rain 619.9    5.7"
  },
  {
    "objectID": "fichier_r.html#d.-the-best-model",
    "href": "fichier_r.html#d.-the-best-model",
    "title": "Unveiling the influence of climatic factors on reproductive patterns in neotropical bats through a Bayesian framework",
    "section": "D. The best model",
    "text": "D. The best model\nSo our best model is the one with rain/temperature/julian_day covariates, there it is :\n\nmodel_rain_temp_jday &lt;- \n  paste(\"\nmodel {\n  for (i in 1:N) {\n    repro_positive[i] ~ dbin(p[i], total_individuals[i])  # Distribution binomiale\n    logit(p[i]) &lt;- a + b.rain * rain[i] \n                     + b.rain2 * pow(rain[i],2)  \n                     + b.temp * temp[i] \n                     + b.julian_day * julian_day[i]\n                     + b.julian_day2 * pow(julian_day[i], 2)\n                     + b.julian_day3 * pow(julian_day[i], 3)\n                     + b.julian_day4 * pow(julian_day[i], 4)\n  }\n  \n  a ~ dnorm(0, 0.001)  # Prior sur l'intercept\n  b.rain ~ dnorm(0, 0.001)\n  b.rain2 ~ dnorm(0, 0.001)\n  b.temp ~ dnorm(0, 0.001)\n  b.julian_day ~ dnorm(0, 0.001)\n  b.julian_day2 ~ dnorm(0, 0.001) \n  b.julian_day3 ~ dnorm(0, 0.001)\n  b.julian_day4 ~ dnorm(0, 0.001)\n}\n\")\n\nWe decide to assess polynomial effect on \\(rain^2\\) and on \\(julian\\_day^4\\) because of the non-linearity effect on \\(repro\\_positive\\)\nAnd as we made before, we set the initial values for both MCMC, we specify the parameters to be estimated :\n\ninit1 &lt;- list (a = -0.5, \n               b.rain = -0.5, \n               b.rain2 = -0.5, \n               b.temp = -0.5,\n               b.julian_day = -0.5,\n               b.julian_day2= -0.5,\n               b.julian_day3= -0.5,\n               b.julian_day4 = -0.5) \n\ninit2 &lt;- list (a = 0.5, \n               b.rain = 0.5, \n               b.rain2 = 0.5, \n               b.temp = 0.5, \n               b.julian_day = 0.5,\n               b.julian_day2= 0.5,\n               b.julian_day3= 0.5,\n               b.julian_day4 = 0.5)\n\ninits &lt;- list(init1,init2)\n\nparameters &lt;- c(\"a\",\n                \"b.rain\", \n                \"b.rain2\", \n                \"b.temp\",\n                \"b.julian_day\" ,\n                \"b.julian_day2\",\n                \"b.julian_day3\",\n                \"b.julian_day4\")\n\nAnd we run jags() :\n\nchiro_rain_temp_jday &lt;- jags(data = datax,\n                        inits = inits, \n                        parameters.to.save = parameters, \n                        model.file = textConnection(model_rain_temp_jday), \n                        n.chains = 2, \n                        n.iter = 10000, \n                        n.burnin = 1000)\n\nCompiling model graph\n   Resolving undeclared variables\n   Allocating nodes\nGraph information:\n   Observed stochastic nodes: 246\n   Unobserved stochastic nodes: 8\n   Total graph size: 2709\n\nInitializing model\n\nchiro_rain_temp_jday\n\nInference for Bugs model at \"5\", fit using jags,\n 2 chains, each with 10000 iterations (first 1000 discarded), n.thin = 9\n n.sims = 2000 iterations saved\n              mu.vect sd.vect    2.5%     25%     50%     75%   97.5%  Rhat\na               0.414   0.152   0.131   0.309   0.411   0.519   0.715 1.002\nb.julian_day    0.149   0.252  -0.352  -0.022   0.150   0.315   0.658 1.001\nb.julian_day2   2.325   0.330   1.704   2.100   2.316   2.550   2.955 1.001\nb.julian_day3  -0.212   0.154  -0.509  -0.314  -0.215  -0.113   0.096 1.001\nb.julian_day4  -0.574   0.133  -0.824  -0.662  -0.575  -0.487  -0.318 1.001\nb.rain          0.428   0.221  -0.022   0.281   0.434   0.576   0.852 1.001\nb.rain2         0.063   0.102  -0.071  -0.013   0.043   0.121   0.312 1.001\nb.temp          0.561   0.128   0.305   0.474   0.562   0.651   0.807 1.019\ndeviance      616.898   7.544 610.980 613.666 615.998 619.214 626.155 1.123\n              n.eff\na              2000\nb.julian_day   2000\nb.julian_day2  2000\nb.julian_day3  2000\nb.julian_day4  2000\nb.rain         2000\nb.rain2        2000\nb.temp          620\ndeviance       2000\n\nFor each parameter, n.eff is a crude measure of effective sample size,\nand Rhat is the potential scale reduction factor (at convergence, Rhat=1).\n\nDIC info (using the rule, pD = var(deviance)/2)\npD = 28.5 and DIC = 645.4\nDIC is an estimate of expected predictive error (lower deviance is better).\n\n\nAs we made before, we check how the MCMC converged and we trace the autocorrelation plot :\n\ntraceplot(chiro_rain_temp_jday, mfrow = c(2,4), varnames = c(\"a\",\"b.rain\", \"b.rain2\",\"b.temp\",\"b.julian_day\" ,\"b.julian_day2\",\"b.julian_day3\",\"b.julian_day4\"), ask = F)\n\n\n\nautocorr.plot(as.mcmc(chiro_rain_temp_jday), ask = F)\n\n\n\n\n\n\n\n\n\n\nWe put the estimate values in the same object :\n\nres&lt;-as.mcmc(chiro_rain_temp_jday)\nres&lt;-rbind(res[[1]], res[[2]])\n\nAnd we plot the estimated distribution of every parameters :\n\npar(mfrow=c(2,4))\nplot(density(res[,'a']),xlab=\"\",ylab=\"\", main=\"Intercept\",lwd=3,xlim=c(-0.1,2))\nabline(v=0,col='red',lwd=2)\nplot(density(res[,'b.rain']),xlab=\"\",ylab=\"\", main=\"Rainfall\",lwd=3)\nabline(v=0,col='red',lwd=2)\nplot(density(res[,'b.rain2']),xlab=\"\",ylab=\"\", main=\"Rainfall\",lwd=3)\nabline(v=0,col='red',lwd=2)\nplot(density(res[,'b.temp']),xlab=\"\",ylab=\"\", main=\"Temperature\",lwd=3, xlim=c(-0.1,1.5))\nabline(v=0,col='red',lwd=2)\nplot(density(res[,'b.julian_day']),xlab=\"\",ylab=\"\", main=\"julian_day\",lwd=3)\nabline(v=0,col='red',lwd=2)\nplot(density(res[,'b.julian_day2']),xlab=\"\",ylab=\"\", main=\"julian_day2\",lwd=3, xlim = c(0,4))\nabline(v=0,col='red',lwd=2)\nplot(density(res[,'b.julian_day3']),xlab=\"\",ylab=\"\", main=\"julian_day3\",lwd=3)\nabline(v=0,col='red',lwd=2)\nplot(density(res[,'b.julian_day4']),xlab=\"\",ylab=\"\", main=\"julian_day4\",lwd=3)\nabline(v=0,col='red',lwd=2)"
  },
  {
    "objectID": "fichier_r.html#e.-using-our-model",
    "href": "fichier_r.html#e.-using-our-model",
    "title": "Unveiling the influence of climatic factors on reproductive patterns in neotropical bats through a Bayesian framework",
    "section": "E. Using our model",
    "text": "E. Using our model\nNow let’s try to predict some values from our model to better understand the different relations between \\(repro\\_positive\\) and the different covariates.\nFirst, let’s simulate some data !\n\npred_data &lt;- expand.grid(\n  rain = seq(min(datax$rain), max(datax$rain), length.out = 1000), \n  temp = median(datax$temp),\n  julian_day = median(datax$julian_day))\n\nThis grid will allow us to simulate data from the source data.frame “data_final”, for some reasons that we don’t clearly understand… we need to sample each covariate at once and fix the other one to the median.\nThen we compute \\(p[i]\\) for each estimate value from the model : \\[\n\\text{logit}(p_i) = a + b_{\\text{rain}} \\cdot \\text{rain}_i + b_{\\text{rain2}} \\cdot \\text{rain}_i^2 + b_{\\text{temp}} \\cdot \\text{temp}_i + b_{\\text{julian_day}} \\cdot \\text{julian_day}_i + b_{\\text{julian_day2}} \\cdot \\text{julian_day}_i^2 + b_{\\text{julian_day3}} \\cdot \\text{julian_day}_i^3 + b_{\\text{julian_day4}} \\cdot \\text{julian_day}_i^4\n\\]\n\nn_sim&lt;-1000\n\np_sim &lt;- matrix(NA, nrow = n_sim, ncol = nrow(pred_data))\n\nfor (i in 1:n_sim) {\n  sample_idx &lt;- sample(1:nrow(res), 1)\n  a &lt;- res[sample_idx, \"a\"]\n  b.rain &lt;- res[sample_idx, \"b.rain\"]\n  b.rain2 &lt;- res[sample_idx, \"b.rain2\"]\n  b.temp &lt;- res[sample_idx, \"b.temp\"]\n  b.julian_day &lt;- res[sample_idx, \"b.julian_day\"]\n  b.julian_day2 &lt;- res[sample_idx, \"b.julian_day2\"]\n  b.julian_day3 &lt;- res[sample_idx, \"b.julian_day3\"]\n  b.julian_day4 &lt;- res[sample_idx, \"b.julian_day4\"]\n  \n  p_sim[i, ] &lt;- plogis(\n    a + \n      b.rain * pred_data$rain + b.rain2 * pred_data$rain^2 +\n      b.temp * pred_data$temp +\n      b.julian_day * pred_data$julian_day + \n      b.julian_day2 * pred_data$julian_day^2 +\n      b.julian_day3 * pred_data$julian_day^3 + \n      b.julian_day4 * pred_data$julian_day^4\n  )\n}\n\nThen we compute our credible intervals :\n\npred_data &lt;- pred_data %&gt;%\n  mutate(\n    mean_p = apply(p_sim, 2, mean),\n    lower = apply(p_sim, 2, quantile, probs = 0.025),\n    upper = apply(p_sim, 2, quantile, probs = 0.975)\n  )\n\nWe want to get back to the natural scale for the X-axis :\n\nmean(data_final$Pluie)\n\n[1] 6.95171\n\nsd(data_final$Pluie)\n\n[1] 10.36198\n\npred_data$rain &lt;- (pred_data$rain * 10.71609) + 7.087872\n\nThen we can plot our response variable with a covariate ! here the rain :\n\nggplot(pred_data, aes(x = rain)) +\n  geom_line(aes(y = mean_p), color = \"blue\") +\n  geom_ribbon(aes(ymin = lower, ymax = upper), alpha = 0.2) +\n  labs(x = \"Rain (Natural Scale)\", y = \"Probability of Reproduction\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))+\n  scale_y_continuous(limits = c(0, 1))\n\n\n\n\nSame task for julian_day… yes it’s a bit boring, we need to improve the code !\n\npred_data &lt;- expand.grid(\n  rain = median(datax$temp), \n  temp = median(datax$temp),\n  julian_day = seq(min(datax$julian_day), max(datax$julian_day), length.out = 1000))\np_sim &lt;- matrix(NA, nrow = n_sim, ncol = nrow(pred_data))\n\nfor (i in 1:n_sim) {\n  sample_idx &lt;- sample(1:nrow(res), 1)\n  a &lt;- res[sample_idx, \"a\"]\n  b.rain &lt;- res[sample_idx, \"b.rain\"]\n  b.rain2 &lt;- res[sample_idx, \"b.rain2\"]\n  b.temp &lt;- res[sample_idx, \"b.temp\"]\n  b.julian_day &lt;- res[sample_idx, \"b.julian_day\"]\n  b.julian_day2 &lt;- res[sample_idx, \"b.julian_day2\"]\n  b.julian_day3 &lt;- res[sample_idx, \"b.julian_day3\"]\n  b.julian_day4 &lt;- res[sample_idx, \"b.julian_day4\"]\n  \n  p_sim[i, ] &lt;- plogis(\n    a + \n      b.rain * pred_data$rain + b.rain2 * pred_data$rain^2 +\n      b.temp * pred_data$temp +\n      b.julian_day * pred_data$julian_day + \n      b.julian_day2 * pred_data$julian_day^2 +\n      b.julian_day3 * pred_data$julian_day^3 + \n      b.julian_day4 * pred_data$julian_day^4\n  )\n}\npred_data &lt;- pred_data %&gt;%\n  mutate(\n    mean_p = apply(p_sim, 2, mean),\n    lower = apply(p_sim, 2, quantile, probs = 0.025),\n    upper = apply(p_sim, 2, quantile, probs = 0.975)\n  )\n\nmean(data_final$julian_day)\n\n[1] 201.5163\n\nsd(data_final$julian_day)\n\n[1] 96.75666\n\npred_data$julian_day &lt;- (pred_data$julian_day * 95.50893) + 203.0329\n\nggplot(pred_data, aes(x = julian_day)) +\n  geom_line(aes(y = mean_p), color = \"blue\") +\n  geom_ribbon(aes(ymin = lower, ymax = upper), alpha = 0.2) +\n  labs(x = \"Julian day (Natural Scale)\", y = \"Probability of Reproduction\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))+\n  scale_y_continuous(limits = c(0, 1))\n\n\n\n\nResults: Those results suggest that the probability of being reproductive could be mainly influenced by the two rainy seasons that occurs in the lowlands of French Guiana and, therefore, with the fructification period of many plants. As the extreme majority of the species caugth with mist-nets are frugivorous.\n(We would greatly appreciate advice on how to improve this analysis!)"
  },
  {
    "objectID": "analyse_donnees.html",
    "href": "analyse_donnees.html",
    "title": "analyse_donnees",
    "section": "",
    "text": "This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see http://rmarkdown.rstudio.com.\nWhen you click the Knit button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:\n\nsummary(cars)\n\n     speed           dist       \n Min.   : 4.0   Min.   :  2.00  \n 1st Qu.:12.0   1st Qu.: 26.00  \n Median :15.0   Median : 36.00  \n Mean   :15.4   Mean   : 42.98  \n 3rd Qu.:19.0   3rd Qu.: 56.00  \n Max.   :25.0   Max.   :120.00"
  },
  {
    "objectID": "analyse_donnees.html#r-markdown",
    "href": "analyse_donnees.html#r-markdown",
    "title": "analyse_donnees",
    "section": "",
    "text": "This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see http://rmarkdown.rstudio.com.\nWhen you click the Knit button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:\n\nsummary(cars)\n\n     speed           dist       \n Min.   : 4.0   Min.   :  2.00  \n 1st Qu.:12.0   1st Qu.: 26.00  \n Median :15.0   Median : 36.00  \n Mean   :15.4   Mean   : 42.98  \n 3rd Qu.:19.0   3rd Qu.: 56.00  \n Max.   :25.0   Max.   :120.00"
  },
  {
    "objectID": "analyse_donnees.html#including-plots",
    "href": "analyse_donnees.html#including-plots",
    "title": "analyse_donnees",
    "section": "Including Plots",
    "text": "Including Plots\nYou can also embed plots, for example:\n\n\n\n\n\nNote that the echo = FALSE parameter was added to the code chunk to prevent printing of the R code that generated the plot."
  },
  {
    "objectID": "Analyse_Birds.html",
    "href": "Analyse_Birds.html",
    "title": "Analysis of the Factors Favorable to Nest Success of Different Bird Species in Two USA States, Wisconsin and Illinois",
    "section": "",
    "text": "Do not forget to set your working directory in the right place Menu : Session/Set Working Directory/Choose directory And indicate Git/2024_MODE_OCR"
  },
  {
    "objectID": "Analyse_Birds.html#a.-data-exploration",
    "href": "Analyse_Birds.html#a.-data-exploration",
    "title": "Analysis of the Factors Favorable to Nest Success of Different Bird Species in Two USA States, Wisconsin and Illinois",
    "section": "A. Data Exploration",
    "text": "A. Data Exploration\nIn this part we choose to explain the nest fate with different variables. We chose to focus on the state of Illinois because adding the state might lead to bad modelling as there might be not enough data for each of them.\nVariables are :\n\nNest_Fate : Response variable, binary\nCounty : qualitative explanatory variable\nHabitat : qualitative explanatory variable\nSpecies : qualitative explanatory variable\nYear : qualitative explanatory variable\nInitiation_Date : Quantitative explanatory variable\n\nAim of the study : We want to model the fate of the nest as a response of the County, the Habitat, the Species, the Year, the Initiation date. We are looking for a model that could explain the distribution of Nest fate.\nMethod : Here our response variable is either a sucess or a failure. This response follows a binomial distribution with the probability density function \\[P(X = k) = \\binom{n}{k} p^k (1-p)^{n-k}\\]\nThe term \\[ \\binom{n}{k} \\] is the binomial coefficient, which represents the number of ways to choose ( k ) successes from ( n ) trials.\n\\[ p \\] is the probability of success on a single trial.\n\\[1 - p\\] is the probability of failure on a single trial.\nEvery statistical analysis starts with the exploration of the dataset.\n\nOutlier in \\(Y\\)\nHere we are checking the values of Y (the values of Nest Fate)\n\n\nShow the code\n# Number of 0 and 1 in Y\ntable(data_Illinois$Nest_Fate)\n\n\n\n  0   1 \n736 337 \n\n\nAccording to the results table, it appears that overall, there are roughly twice as many failures as successes.\n\n\nFor quantitative Xs : outlier and distribution of \\(X\\) values\nHere we have one quantitative explanatory variable \\(X\\). We check its distribution and if there is any outlier value.\n\n\nShow the code\npar(mfrow=c(1,3))\n\n# Length\n# Cleveland plot\ndotchart(data_Illinois$Initiation_Date,pch=16,col='dodgerblue3',xlab='Initiation Date')\n# Histogram\nhist(data_Illinois$Initiation_Date,col='dodgerblue3',xlab=\"Initiation Date\",main=\"\")\n# Quantile-Quantile plot\nqqnorm(data_Illinois$Initiation_Date,pch=16,col='dodgerblue3',xlab='')\nqqline(data_Illinois$Initiation_Date,col='red',lwd=2)\n\n\n\n\n\nWe do not observe any outliers and it seems that the initiation date of the nesting period follows a normal distribution.\n\n\nFor each qualitative explanatory variable \\(X\\) : Modalities and number of individuals for each of them\nWe need to analyse the modalities and the number of individuals for each modality.\n\n#| echo: true\n#| code-fold: true\n#| code-summary: \"Show the code\"\n\n# Factor County\nsummary(data_Illinois$County)\n\n          Carroll Carroll/Whiteside              Dane             Grant \n               15                 5                 0                 0 \n            Green            Grundy              Iowa        Jo_Daviess \n                0                53                 0               292 \n        Lafayette               Lee          Lee/Ogle            Monroe \n                0                20               297                 0 \n             Rock              Will \n                0               391 \n\n# Factor Habitat\nsummary(data_Illinois$Habitat)\n\nCool-season_Grassland               Pasture               Prairie \n                  242                   537                   137 \nWarm-season_Grassland \n                  157 \n\n# Factor Species\nsummary(data_Illinois$Species)\n\n           Bobolink          Dickcissel  Eastern_Meadowlark Grasshopper_Sparrow \n                 62                 314                 229                 350 \n  Henslow's_Sparrow    Savannah_Sparrow      Vesper_Sparrow  Western_Meadowlark \n                  5                  13                  54                  46 \n\n# Factor Year\nsummary(data_Illinois$Year)\n\n1995 1996 1997 1998 2007 2008 2009 \n 166  261  330  166   52   60   38 \n\n\nThe results tables provided by our script show different things. First of all for the County variable we can observe that some counties have very little records. For example Carrol/Whiteside has 5 records of nest while counties like Jo Daviess have 292 records. This could lead to mis-modelling so attention on the model results is necessary. For Habitat variable it seems that one habitat in particular (Pasture) has more records than the other. For the Species variable, similarly to county variable, we observe that some species have more records than others. We observe the same for the Year variable.\n\n\nRelationships between Y and Xs ?\nWe can then analyse graphically if we might have relationships between \\(Y\\) and \\(Xs\\).\n\n\nShow the code\npar(mfrow=c(1,3), mar=c(5, 4, 4, 2) + 0.1) \n\n# Initiation_Date\nplot(data_Illinois$Nest_Fate ~ data_Illinois$Initiation_Date, \n     pch=16, \n     col='dodgerblue3',\n     xlab='Initiation_Date', \n     ylab='Nest_Fate',\n     cex.lab=1.2,  \n     cex.axis=1.2)\n\n# Define the color palette\ncolor &lt;- c('dodgerblue3', 'darkred', 'forestgreen', 'gold', \n           'purple', 'orange', 'cyan', 'magenta', \n           'salmon', 'lightseagreen', 'plum', \n           'yellowgreen', 'sandybrown', 'steelblue')\n\n# County\nmosaicplot(data_Illinois$Nest_Fate ~ data_Illinois$County, \n           col = color, \n           main=\"\", \n           cex.axis=0.8,  \n           las=2)        \ntitle(\"Relationship Nest Fate & County\", cex.main=1.2)  \n\n# Habitat\nmosaicplot(data_Illinois$Nest_Fate ~ data_Illinois$Habitat, \n           col = color[1:4],  \n           main=\"\",  \n           cex.axis=0.8,\n           las=2)\ntitle(\"Relationship Nest Fate & Habitat\", cex.main=1.2)  \n\n\n\n\n\nShow the code\n# Species\nmosaicplot(data_Illinois$Nest_Fate ~ data_Illinois$Species, \n           col = color[1:8],  \n           main=\"\", \n           cex.axis=0.8,\n           las=2)\ntitle(\"Relationship Nest Fate & Species\", cex.main=1.2)  \n\n# Year\nmosaicplot(data_Illinois$Nest_Fate ~ data_Illinois$Year, \n           col = color[1:6],  \n           main=\"\", \n           cex.axis=0.8,\n           las=2)\ntitle(\"Relationship Nest Fate & Year\", cex.main=1.2) \n\n\n\n\n\nLooking at those graphs it doesn’t seems like the Initiation_date, the County or the Habitat has any effects on the Nest_fate. Maybe a little bit for County but the statistical analysis afterward will enable us to have more information on which variable has an effect. For the Year and the Species we might observe a little difference, but still really light.\n\n\nAnalysing interaction between Xs\nIn any modelling approach there is a need to check for interactions between variables. In our study we judge that there is none.\n\n\nChecking collinearity between \\(Xs\\)\nTo avoid multicollinearity in modeling, we need to analyze how the explanatory variables \\(X_s\\) are related. It is important to check for collinearity. Indeed if some variables are correlated they measure the same thing and therefore keeping both of them might lead to bad prediction.\n\n\nShow the code\n# Checking collinearity between qualitative explanatory variable\n\n# Contingency table between County and Habitat\ntable(data_Illinois$County, data_Illinois$Habitat)\n\n\n                   \n                    Cool-season_Grassland Pasture Prairie Warm-season_Grassland\n  Carroll                               0       0      15                     0\n  Carroll/Whiteside                     0       0       5                     0\n  Dane                                  0       0       0                     0\n  Grant                                 0       0       0                     0\n  Green                                 0       0       0                     0\n  Grundy                                0       6      26                    21\n  Iowa                                  0       0       0                     0\n  Jo_Daviess                            7     264       7                    14\n  Lafayette                             0       0       0                     0\n  Lee                                   4      12       4                     0\n  Lee/Ogle                            104      39      58                    96\n  Monroe                                0       0       0                     0\n  Rock                                  0       0       0                     0\n  Will                                127     216      22                    26\n\n\nShow the code\n# Contingency table between Species and Year\ntable(data_Illinois$Species, data_Illinois$Year)\n\n\n                     \n                      1995 1996 1997 1998 2007 2008 2009\n  Bobolink              14   22   20    1    2    1    2\n  Dickcissel            50   60   83   27   35   31   28\n  Eastern_Meadowlark    46  119   41   13    5    1    4\n  Grasshopper_Sparrow   41   50  128   93   10   25    3\n  Henslow's_Sparrow      4    1    0    0    0    0    0\n  Savannah_Sparrow       7    3    3    0    0    0    0\n  Vesper_Sparrow         4    6   28   13    0    2    1\n  Western_Meadowlark     0    0   27   19    0    0    0\n\n\nShow the code\n# Contingency table between Habitat and Species\ntable(data_Illinois$Habitat, data_Illinois$Species)\n\n\n                       \n                        Bobolink Dickcissel Eastern_Meadowlark\n  Cool-season_Grassland       18        162                 42\n  Pasture                     37         60                130\n  Prairie                      7         37                 39\n  Warm-season_Grassland        0         55                 18\n                       \n                        Grasshopper_Sparrow Henslow's_Sparrow Savannah_Sparrow\n  Cool-season_Grassland                  13                 4                2\n  Pasture                               220                 0                7\n  Prairie                                49                 1                0\n  Warm-season_Grassland                  68                 0                4\n                       \n                        Vesper_Sparrow Western_Meadowlark\n  Cool-season_Grassland              1                  0\n  Pasture                           37                 46\n  Prairie                            4                  0\n  Warm-season_Grassland             12                  0\n\n\nShow the code\n# Boxplots to check for relationship between Initiation_Date and the qualitative explanatory variables\n\n# Initiation_Date and County\nboxplot(data_Illinois$Initiation_Date ~ data_Illinois$County, \n        xlab=\"County\", \n        ylab=\"Initiation Date\", \n        cex.axis=0.8)          \n\n\n\n\n\nShow the code\n# Initiation_Date and Habitat\nboxplot(data_Illinois$Initiation_Date ~ data_Illinois$Habitat, \n        xlab=\"Habitat\", \n        ylab=\"Initiation Date\", \n        cex.axis=0.8)         \n\n\n\n\n\nShow the code\n# Initiation_Date and Species\nboxplot(data_Illinois$Initiation_Date ~ data_Illinois$Species, \n        xlab=\"Species\", \n        ylab=\"Initiation Date\", \n        cex.axis=0.4)         \n\n\n\n\n\nShow the code\n# Initiation_Date and Year\nboxplot(data_Illinois$Initiation_Date ~ data_Illinois$Year, \n        xlab=\"Year\", \n        ylab=\"Initiation Date\", \n        cex.axis=0.8)         \n\n\n\n\n\nHere it seems that there is a strong collinearity between County and Habitat as well as between Species and Year and also between Species and Habitat. Therefore, we are not going to keep County, Habitat and Year as explanatory variables in our model."
  },
  {
    "objectID": "Analyse_Birds.html#b.-statistical-analysis",
    "href": "Analyse_Birds.html#b.-statistical-analysis",
    "title": "Analysis of the Factors Favorable to Nest Success of Different Bird Species in Two USA States, Wisconsin and Illinois",
    "section": "B. Statistical Analysis",
    "text": "B. Statistical Analysis\n\nModel building up\nBecause our response variable is a binary variable that follows a binomial distribution we have a link function : the logit.\n\n\nShow the code\n# Model formulation\nmod1&lt;-glm(Nest_Fate~Species\n        + Initiation_Date\n        ,data=data_Illinois\n        ,family=binomial(link=\"logit\"))\n# Then we check for significance\ndrop1(mod1,test=\"Chi\")\n\n\nSingle term deletions\n\nModel:\nNest_Fate ~ Species + Initiation_Date\n                Df Deviance    AIC    LRT  Pr(&gt;Chi)    \n&lt;none&gt;               1296.3 1314.3                     \nSpecies          7   1334.0 1338.0 37.701 3.453e-06 ***\nInitiation_Date  1   1296.4 1312.4  0.029    0.8656    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nThe results table shows that Initiation_Date is not significant. However the AIC with Initiation_Date is better which means we should keep this variable despite its lack of significance.\n\n\nModel coefficient and its equation\n\n\nShow the code\n# Coefficients of the model\nsummary(mod1)\n\n\n\nCall:\nglm(formula = Nest_Fate ~ Species + Initiation_Date, family = binomial(link = \"logit\"), \n    data = data_Illinois)\n\nCoefficients:\n                            Estimate Std. Error z value Pr(&gt;|z|)   \n(Intercept)                -1.097853   0.381114  -2.881  0.00397 **\nSpeciesDickcissel           0.189410   0.329713   0.574  0.56565   \nSpeciesEastern_Meadowlark  -0.382551   0.335541  -1.140  0.25424   \nSpeciesGrasshopper_Sparrow  0.664586   0.315297   2.108  0.03505 * \nSpeciesHenslow's_Sparrow   -0.327407   1.155216  -0.283  0.77686   \nSpeciesSavannah_Sparrow    -0.655641   0.822713  -0.797  0.42549   \nSpeciesVesper_Sparrow       0.180147   0.420980   0.428  0.66871   \nSpeciesWestern_Meadowlark   0.961508   0.416342   2.309  0.02092 * \nInitiation_Date             0.000686   0.004052   0.169  0.86557   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 1335.5  on 1072  degrees of freedom\nResidual deviance: 1296.3  on 1064  degrees of freedom\nAIC: 1314.3\n\nNumber of Fisher Scoring iterations: 4\n\n\nThe following equation is the one of the model : \\[\\log\\left(\\frac{p}{1-p}\\right) = -1.097853 + 0.189410 \\cdot \\text{Species}_{\\text{Dickcissel}} - 0.382551 \\cdot \\text{Species}_{\\text{Eastern Meadowlark}} + 0.664586 \\cdot \\text{Species}_{\\text{Grasshopper Sparrow}} - 0.327407 \\cdot \\text{Species}_{\\text{Henslow's Sparrow}} - 0.655641 \\cdot \\text{Species}_{\\text{Savannah Sparrow}} + 0.180147 \\cdot \\text{Species}_{\\text{Vesper Sparrow}} + 0.961508 \\cdot \\text{Species}_{\\text{Western Meadowlark}} + 0.000686 \\cdot \\text{Initiation\\_Date}\\]\nwhere \\(p\\) is the probability that the event is true.\n\nIntercept (-1.097853): The value of the log-odds when all explanatory variables are zero.\nSpecies Dickcissel (0.189410): A positive coefficient, but not significant ((p = 0.56565)), indicating that the effect of this species on the chances of nest success is not statistically significant.\nSpecies Eastern Meadowlark (-0.382551): A negative coefficient, not significant ((p = 0.25424)).\nSpecies Grasshopper Sparrow (0.664586): A positive and significant coefficient ((p = 0.03505)), suggesting that this species increases the chances of nest success.\nSpecies Henslow’s Sparrow (-0.327407): A negative coefficient, not significant ((p = 0.77686)).\nSpecies Savannah Sparrow (-0.655641): A negative coefficient, not significant ((p = 0.42549)).\nSpecies Vesper Sparrow (0.180147): A positive coefficient, not significant ((p = 0.66871)).\nSpecies Western Meadowlark (0.961508): A positive and significant coefficient ((p = 0.02092)).\nInitiation Date (0.000686): A positive coefficient, but not significant ((p = 0.86557)), indicating that it does not have a statistically significant effect on nest success.\n\n\n\nExplanation provided by the model\nOne way to evaluate the goodness of fit for our models is to assess the difference between our model and the null model (which summarizes the data with a single parameter: the mean of𝑌) Y). This null model essentially explains nothing. To do so we calculate a parameter, \\[{pseudo}-R^2\\] by examining the distance between the deviance of the null model and the residual deviance of our model.\n\n\nShow the code\n# Estimate of deviance explained\n(mod1$null.deviance-mod1$deviance)/mod1$null.deviance\n\n\n[1] 0.0293313\n\n\nShow the code\n# Some others estimates of deviance explained - package 'rcompanion'\nnagelkerke(mod1)\n\n\n$Models\n                                                                                              \nModel: \"glm, Nest_Fate ~ Species + Initiation_Date, binomial(link = \\\"logit\\\"), data_Illinois\"\nNull:  \"glm, Nest_Fate ~ 1, binomial(link = \\\"logit\\\"), data_Illinois\"                        \n\n$Pseudo.R.squared.for.model.vs.null\n                             Pseudo.R.squared\nMcFadden                            0.0293313\nCox and Snell (ML)                  0.0358486\nNagelkerke (Cragg and Uhler)        0.0503523\n\n$Likelihood.ratio.test\n Df.diff LogLik.diff  Chisq    p.value\n      -8     -19.586 39.172 4.5671e-06\n\n$Number.of.observations\n           \nModel: 1073\nNull:  1073\n\n$Messages\n[1] \"Note: For models fit with REML, these statistics are based on refitting with ML\"\n\n$Warnings\n[1] \"None\"\n\n\nAccording to this table, the estimate of the explained deviance is 2.9% which is very low."
  },
  {
    "objectID": "Analyse_Birds.html#c.-model-validation",
    "href": "Analyse_Birds.html#c.-model-validation",
    "title": "Analysis of the Factors Favorable to Nest Success of Different Bird Species in Two USA States, Wisconsin and Illinois",
    "section": "C. Model validation",
    "text": "C. Model validation\n\nChecking for influential individuals\nWe make sure that there is no influential individuals.\n\n\nShow the code\npar(mfrow = c(1, 1))\nplot(cooks.distance(mod1), type = \"h\", ylim = c(0, 1))\nabline(h = 1, col = 2,lwd = 3)\n\n\n\n\n\nThe graph does not show any influential individuals.\n\n\nPrediction with different data\nHere we want to assess if our model is able to well-classify nest based on our data.\n\n\nShow the code\n# We could do a simulation\nN    &lt;- nrow(data_Illinois)\nPi   &lt;- fitted(mod1)\ndata_Illinois$Ysim &lt;- rbinom(N, size = 1, Pi)\n# Classification table\nZ &lt;- table(data_Illinois$Nest_Fate, data_Illinois$Ysim) / N\nrownames(Z) &lt;- c(\"Observed 0\", \"Observed 1\")\ncolnames(Z) &lt;- c(\"Predicted 0\", \"Predicted 1\")\nZ\n\n\n            \n             Predicted 0 Predicted 1\n  Observed 0   0.4659832   0.2199441\n  Observed 1   0.2041007   0.1099720\n\n\nShow the code\n#Correctly classified:\nsum(diag(Z))\n\n\n[1] 0.5759553\n\n\nShow the code\n# And repeat this 1000 times, store the results and calculate an average classification table\n\nPi   &lt;- fitted(mod1)\nN    &lt;- nrow(data_Illinois)                 \nNSim &lt;- 1000                           \ndiagZ&lt;- matrix(nrow = N, ncol = NSim)\nfor (i in 1:NSim) {\n  Ysim &lt;- rbinom(N, size = 1, Pi)\n  Z&lt;- table(data_Illinois$Nest_Fate, Ysim) / N\n  diagZ[,i]&lt;-sum(diag(Z))\n  }\n#Average rate of individuals well-classified by the model\nboxplot(diagZ[2,], col='dodgerblue3',ylab='#Rate of nest fate well-classified')\n\n\n\n\n\nShow the code\nmean(diagZ[2,])\n\n\n[1] 0.5848928\n\n\nHere we have 58% of good predictions, which is somewhat below the common threshold of 70% for a model to be considered good. This suggests that the model may need improvement.\nThis result is not surprising given our initial data. Because they are from different studies some variables barely contains some species or years, etc… This could explain why our model is not suitable."
  },
  {
    "objectID": "Analyse_Birds.html#variables-presentation",
    "href": "Analyse_Birds.html#variables-presentation",
    "title": "Analysis of the Factors Favorable to Nest Success of Different Bird Species in Two USA States, Wisconsin and Illinois",
    "section": "Variables presentation:",
    "text": "Variables presentation:\n\ndata$Nest_Fate &lt;- as.factor(data$Nest_Fate)\ndata$County &lt;- as.factor(data$County)\ndata$Habitat &lt;- as.factor(data$Habitat)\ndata$Year &lt;- as.factor(data$Year)\n\n\nCounty : the county in the state where the state has been found. 14 levels factor.\nHabitat : the type of habitat in which the nest has been found. 4 levels factor.\nSpecies : the species of the bird that has build the nest. 8 levels factor.\nYear : the year of the nest building. 21 levels factor.\nNumber_Fledged : the number of birds that hatch on the nest when they hatch. Quantitative variable.\n\nWe want to study the impact of four qualitative variables, the habitat, the county, the species and the year over the number of young hatched in the nest “Number_Fledged”. It is a counting variable, which imply that it follows a Poisson distribution. A negative binomial distribution could be used but is preferred when the count values are high (which is not really the case here since the highest value is of 6)\nA Poisson law is used to describe rare, discrete and independent events. Hence the variable \\(Y\\) that follows a Poisson distribution of parameter \\(\\lambda\\) is written: \\[Pr(Y=y)=\\frac{e^{-\\lambda}.\\lambda^y}{y!}\\] where \\(y\\) represent the value of the count (here \\(y\\) ∈ [0-6]) and \\(\\lambda\\) is the mean value and variance of the Poisson distribution (because in a Poisson law E(\\(y\\))= Var(\\(y\\))=\\(\\lambda\\))."
  },
  {
    "objectID": "Analyse_Birds.html#a.-data-exploration-1",
    "href": "Analyse_Birds.html#a.-data-exploration-1",
    "title": "Analysis of the Factors Favorable to Nest Success of Different Bird Species in Two USA States, Wisconsin and Illinois",
    "section": "A. Data exploration",
    "text": "A. Data exploration\nBefore any analysis, it is important to have a look at the data.\n\nOutlayer values in the response variable \\(Y\\) (the number of young in the nest, Number_Fledged) and values distribution:\n\npar(mfrow=c(2,2))\n# Boxplot\nboxplot(data$Number_Fledged,col='dodgerblue3',ylab='Number of young in nest')\n# Cleveland plot\ndotchart(data$Number_Fledged,pch=16,col='dodgerblue3',xlab='Number of young in nest')\n# Histogram\nhist(data$Number_Fledged,col='dodgerblue3',xlab=\"Number of young in nest\",main=\"\")\n# Quantile-Quantile plot\nqqnorm(data$Number_Fledged,pch=16,col='dodgerblue3',xlab='')\nqqline(data$Number_Fledged,col='red',lwd=2)\n\n\n\n\nThere aren’t any outlayer values. There are a lot of value at 0. Maybe we can study only the number of young when there are some. It could be a normal distribution.\n\n# Get rid of the lines where the Number of young individuals in the nest is equal to 0\ndata_filtered &lt;- subset(data, Number_Fledged != 0)\n\n\npar(mfrow=c(2,2))\n# Boxplot\nboxplot(data_filtered$Number_Fledged,col='dodgerblue3',ylab='Number of young in nest')\n# Cleveland plot\ndotchart(data_filtered$Number_Fledged,pch=16,col='dodgerblue3',xlab='Number of young in nest')\n# Histogram\nhist(data_filtered$Number_Fledged,col='dodgerblue3',xlab=\"Number of young in nest\",main=\"\")\n# Quantile-Quantile plot\nqqnorm(data_filtered$Number_Fledged,pch=16,col='dodgerblue3',xlab='')\nqqline(data_filtered$Number_Fledged,col='red',lwd=2)\n\n\n\n\nNow we have a better view of the data.\n\n\nOutlayer values in the explanatory variable \\(Xs\\) and values distribution:\n\n# Factor County\nsummary(data_filtered$County)\n\n          Carroll Carroll/Whiteside              Dane             Grant \n                5                 1               224                20 \n            Green            Grundy              Iowa        Jo_Daviess \n               62                11               260               127 \n        Lafayette               Lee          Lee/Ogle            Monroe \n              165                 6                85               103 \n             Rock              Will \n                2               102 \n\n# Factor Habitat\nsummary(data_filtered$Habitat)\n\nCool-season_Grassland               Pasture               Prairie \n                  273                   537                   180 \nWarm-season_Grassland \n                  183 \n\n# Factor Species\nsummary(data_filtered$Species)\n\n           Bobolink          Dickcissel  Eastern_Meadowlark Grasshopper_Sparrow \n                184                 163                 233                 280 \n  Henslow's_Sparrow    Savannah_Sparrow      Vesper_Sparrow  Western_Meadowlark \n                 28                 196                  60                  29 \n\n# Factor Year\nsummary(data_filtered$Year)\n\n1991 1992 1993 1994 1995 1996 1997 1998 1999 2000 2001 2002 2003 2004 2005 2006 \n  35    4   13   13   73   45  120  137   98  131   66   75   20   44   27   57 \n2007 2008 2009 2010 2011 \n  46   73   24   50   22 \n\n\nProblem: there aren’t the same number of observations in each level of each factors. Suggestion: normalize by the number of observation for each level.\n\n\nAnalyze the relation between Y and Xs\n\npar(mfrow=c(2,2))\n\n# County\nboxplot(Number_Fledged~County, varwidth = TRUE, ylab = \"Number of young in nest\", xlab = \"County\", col=terrain.colors(14), main = \"\", data=data_filtered)\n\n# Habitat\nboxplot(Number_Fledged~Habitat, varwidth = TRUE, ylab = \"Number of young in nest\", xlab = \"Habitat\", col=terrain.colors(4), main = \"\",data=data_filtered)\n\n# Species\nboxplot(Number_Fledged~Species, varwidth = TRUE, ylab = \"Number of young in nest\", xlab = \"Species\", col=terrain.colors(8), main = \"\",data=data_filtered)\n\n# Year\nboxplot(Number_Fledged~Year, varwidth = TRUE, ylab = \"Number of young in nest\", xlab = \"Year\", col=terrain.colors(21), main = \"\",data=data_filtered)\n\n\n\n\nIt’s not easy to see if the variables have an impact because some of them have a lot of levels, but it is possible to see small differences between them. The analysis will tell us if they really got an impact over the number of young in the nest.\n\n\nAnalyze the interactions between Xs\nThere are a lot of levels so it’s hard to plot the interactions. We will see if there are some in the analysis.\n\npar(mfrow=c(1,3))\n# Interactions between County & Habitat\nplot(Number_Fledged~County,type='n',ylab = \"Number of young in nest\",xlab=\"County\", data=data_filtered)\npoints(Number_Fledged[Habitat==\"Pasture\"]~County[Habitat==\"Pasture\"],pch=16,cex=2,col='#000099', data=data_filtered)\npoints(Number_Fledged[Habitat==\"Cool-season Grassland\"]~County[Habitat==\"Cool-season Grassland\"],pch=16,cex=2,col='green', data=data_filtered)\npoints(Number_Fledged[Habitat==\"Prairie\"]~County[Habitat==\"Prairie\"],pch=16,cex=2,col='red', data=data_filtered)\npoints(Number_Fledged[Habitat==\"Warm-season Grassland\"]~County[Habitat==\"Warm-season Grassland\"],pch=16,cex=2,col='yellow', data=data_filtered)\n\n\n\n\nHere the example between county and habitat doesn’t show a clear pattern. It’s hard to conclude on the interaction aspect.\n\n\nChecking collinearity between categorical independent variables Xs:\nThe following code only presents the contingency table between the variables Habitat and Species for convenience, but the same table has to be done with every couple of 4 variables.\n\ncontingency_table&lt;-table(data_filtered$Habitat,data_filtered$Species)\nprint(contingency_table)\n\n                       \n                        Bobolink Dickcissel Eastern_Meadowlark\n  Cool-season_Grassland       89         51                 95\n  Pasture                     53         26                 86\n  Prairie                      2         21                 32\n  Warm-season_Grassland       40         65                 20\n                       \n                        Grasshopper_Sparrow Henslow's_Sparrow Savannah_Sparrow\n  Cool-season_Grassland                  13                21                4\n  Pasture                               141                 0              189\n  Prairie                                80                 1                0\n  Warm-season_Grassland                  46                 6                3\n                       \n                        Vesper_Sparrow Western_Meadowlark\n  Cool-season_Grassland              0                  0\n  Pasture                           13                 29\n  Prairie                           44                  0\n  Warm-season_Grassland              3                  0\n\nchi2_test&lt;-chisq.test(contingency_table)\n\nWarning in chisq.test(contingency_table): Chi-squared approximation may be\nincorrect\n\nprint(chi2_test)\n\n\n    Pearson's Chi-squared test\n\ndata:  contingency_table\nX-squared = 748.71, df = 21, p-value &lt; 2.2e-16\n\nprint(chi2_test$expected)\n\n                       \n                        Bobolink Dickcissel Eastern_Meadowlark\n  Cool-season_Grassland 42.82353   37.93606           54.22762\n  Pasture               84.23529   74.62148          106.66752\n  Prairie               28.23529   25.01279           35.75448\n  Warm-season_Grassland 28.70588   25.42967           36.35038\n                       \n                        Grasshopper_Sparrow Henslow's_Sparrow Savannah_Sparrow\n  Cool-season_Grassland            65.16624          6.516624         45.61637\n  Pasture                         128.18414         12.818414         89.72890\n  Prairie                          42.96675          4.296675         30.07673\n  Warm-season_Grassland            43.68286          4.368286         30.57801\n                       \n                        Vesper_Sparrow Western_Meadowlark\n  Cool-season_Grassland      13.964194           6.749361\n  Pasture                    27.468031          13.276215\n  Prairie                     9.207161           4.450128\n  Warm-season_Grassland       9.360614           4.524297\n\n\nProblem : for most of the variables the chi² test can’t be done because of the low number of values in each group. The only one that fulfill the conditions and therefore can be made is between Habitat and Species but the result shows that the variables are correlated."
  },
  {
    "objectID": "Analyse_Birds.html#b.-statistical-analysis-1",
    "href": "Analyse_Birds.html#b.-statistical-analysis-1",
    "title": "Analysis of the Factors Favorable to Nest Success of Different Bird Species in Two USA States, Wisconsin and Illinois",
    "section": "B. Statistical Analysis",
    "text": "B. Statistical Analysis\nNow that we have a better idea of the data implied in this study, we can begin the statistical analysis."
  },
  {
    "objectID": "Analyse_Birds.html#building-of-the-model",
    "href": "Analyse_Birds.html#building-of-the-model",
    "title": "Analysis of the Factors Favorable to Nest Success of Different Bird Species in Two USA States, Wisconsin and Illinois",
    "section": "Building of the model",
    "text": "Building of the model\nBecause our response variable follows a poisson distribution we use a link function : the log function.\n\n# Model formulation\nmod1&lt;-glm(Number_Fledged~ County\n        + Species\n        + Habitat\n        + Year\n        ,data=data_filtered\n        ,family=poisson(link=\"log\"))\n# Variable type : poisson. Link fonction : log\n# Then we check for significance\ndrop1(mod1,test=\"Chi\")\n\nSingle term deletions\n\nModel:\nNumber_Fledged ~ County + Species + Habitat + Year\n        Df Deviance    AIC     LRT Pr(&gt;Chi)   \n&lt;none&gt;       541.13 4125.3                    \nCounty  13   557.02 4115.2 15.8822 0.255551   \nSpecies  7   560.94 4131.1 19.8043 0.006008 **\nHabitat  3   541.44 4119.6  0.3096 0.958219   \nYear    20   551.54 4095.7 10.4077 0.960163   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nWe decide to remove the less significative variable : here it’s Year.\n\n# Model formulation\nmod1&lt;-glm(Number_Fledged~ County\n        + Species\n        + Habitat\n        ,data=data_filtered\n        ,family=poisson(link=\"log\"))\n#type de la variable : poisson et fonction de lien de type log\n# Then we check for significance\ndrop1(mod1,test=\"Chi\")\n\nSingle term deletions\n\nModel:\nNumber_Fledged ~ County + Species + Habitat\n        Df Deviance    AIC     LRT Pr(&gt;Chi)   \n&lt;none&gt;       551.54 4095.7                    \nCounty  13   569.19 4087.3 17.6441  0.17151   \nSpecies  7   574.48 4104.6 22.9344  0.00175 **\nHabitat  3   551.76 4089.9  0.2194  0.97439   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nNow the less significative is Habitat\n\n# Model formulation\nmod1&lt;-glm(Number_Fledged~ County\n        + Species\n        ,data=data_filtered\n        ,family=poisson(link=\"log\"))\n#type de la variable : poisson et fonction de lien de type log\n# Then we check for significance\ndrop1(mod1,test=\"Chi\")\n\nSingle term deletions\n\nModel:\nNumber_Fledged ~ County + Species\n        Df Deviance    AIC    LRT Pr(&gt;Chi)   \n&lt;none&gt;       551.76 4089.9                   \nCounty  13   572.82 4085.0 21.056 0.071837 . \nSpecies  7   574.68 4098.8 22.914 0.001764 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nCounty is still not significative so we have to remove it.\n\n# Model formulation\nmod1&lt;-glm(Number_Fledged~ Species\n        ,data=data_filtered\n        ,family=poisson(link=\"log\"))\n#type de la variable : poisson et fonction de lien de type log\n# Then we check for significance\ndrop1(mod1,test=\"Chi\")\n\nSingle term deletions\n\nModel:\nNumber_Fledged ~ Species\n        Df Deviance    AIC    LRT Pr(&gt;Chi)    \n&lt;none&gt;       572.82 4085.0                    \nSpecies  7   599.76 4097.9 26.938 0.000342 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nsummary(mod1)\n\n\nCall:\nglm(formula = Number_Fledged ~ Species, family = poisson(link = \"log\"), \n    data = data_filtered)\n\nCoefficients:\n                           Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)                 1.29234    0.03863  33.452  &lt; 2e-16 ***\nSpeciesDickcissel          -0.18558    0.05934  -3.128 0.001762 ** \nSpeciesEastern_Meadowlark  -0.14760    0.05347  -2.761 0.005769 ** \nSpeciesGrasshopper_Sparrow -0.05604    0.05030  -1.114 0.265207    \nSpeciesHenslow's_Sparrow   -0.18190    0.11514  -1.580 0.114157    \nSpeciesSavannah_Sparrow    -0.19203    0.05648  -3.400 0.000674 ***\nSpeciesVesper_Sparrow      -0.32409    0.08844  -3.665 0.000248 ***\nSpeciesWestern_Meadowlark  -0.04452    0.10674  -0.417 0.676633    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 599.76  on 1172  degrees of freedom\nResidual deviance: 572.82  on 1165  degrees of freedom\nAIC: 4085\n\nNumber of Fisher Scoring iterations: 4\n\n\nWe have the final model with only the Species.\n\n\\(Species{Bobolink }\\) = 0 (intercept)\n\n\\(Species{Dickcissel }\\) = \\(-0.18^{**}\\)\n\\(Species{Eastern Meadowlark }\\) = \\(-0.14^{**}\\)\n\\(Species{Grasshopper Sparrow }\\) = \\(-0.05\\)\n\\(Species{Henslow's Sparrow }\\) = \\(-0.18\\)\n\\(Species{Savannah Sparrow }\\) = \\(-0.19^{***}\\)\n\\(Species{Vesper Sparrow }\\) = \\(-0.32^{***}\\)\n\\(Species{Western Meadowlark }\\) = \\(-0.04\\)\n\nThe equation of the model is the following:\n\\[ Number_Fledged = 1.29^{***} + (Species{Bobolink} = 0 ;\\:Species{Dickcissel} = -0.18^{**} ; \\:Species{Eastern Meadowlark} = -0.14^{**} ; \\:Species{Grasshopper Sparrow} = -0.05 ; \\:Species{Henslow's Sparrow} = -0.18 ; \\:Species{Savannah Sparrow = -0.19^{***} ; \\:Species{Vesper Sparrow = -0.32^{***} ; \\:Species{Western Meadowlark} = -0.04) \\]\nAccording to the model’s summary, the null deviance is of 599.76 and residual deviance is of 572.82. In order to estimate the explained deviance, one can use the following formula:\n\n\\[Pseudo\\:R^2=100\\:.\\:\\frac{Null\\:Deviance- Residual\\:Deviance}{Null\\:Deviance}\\]\n\n# Estimate of deviance explained\n(mod1$null.deviance-mod1$deviance)/mod1$null.deviance\n\n[1] 0.04491502\n\n\nThis is very very bad… The variable species doesn’t seem to explain a lot of the variation in the number of young individuals in the nest."
  },
  {
    "objectID": "Analyse_Birds.html#c.-model-validation-1",
    "href": "Analyse_Birds.html#c.-model-validation-1",
    "title": "Analysis of the Factors Favorable to Nest Success of Different Bird Species in Two USA States, Wisconsin and Illinois",
    "section": "C. Model validation:",
    "text": "C. Model validation:\nThe model that we have done is a generalized linear model so there aren’t residual normality or homogeneity. However, it is important to check the independence of residuals.\nFirst of all, in situations where a counting model is used, such as when following a Poisson distribution, the overdispersion has to be checked. It can be done with the following code. If the result is over 1, there are overdispersion and the model should be reconsidered.\n\n# Scale parameter calculation\nE1 &lt;- resid(mod1, type = \"pearson\") # (Y - mu) / sqrt(mu)\nN  &lt;- nrow(data_filtered)\np  &lt;- length(coef(mod1))\nsum(E1^2) / (N - p)\n\n[1] 0.4439871\n\n\nThe value is of 0.44 so it’s okay, the residuals aren’t overdispersed.\nWe can also check for the most influential individuals:\n\npar(mfrow = c(1, 1))\nplot(cooks.distance(mod1), type = \"h\", ylim = c(0, 1))\nabline(h = 1, col = 2,lwd = 3)\n\n\n\n\nThere aren’t very influential individuals which can be logical because of the high number of them and the low impact of species over the number of young individuals in the nest."
  },
  {
    "objectID": "Analyse_Birds.html#conclusions",
    "href": "Analyse_Birds.html#conclusions",
    "title": "Analysis of the Factors Favorable to Nest Success of Different Bird Species in Two USA States, Wisconsin and Illinois",
    "section": "Conclusions:",
    "text": "Conclusions:\nThe species of the birds has an impact over the number of young individuals in the nest, but it is clearly not the only variable that explain the variation of the response (only 4% are due to the species)."
  },
  {
    "objectID": "Analyse_Birds.html#validation-of-modeling",
    "href": "Analyse_Birds.html#validation-of-modeling",
    "title": "Analysis of the Factors Favorable to Nest Success of Different Bird Species in Two USA States, Wisconsin and Illinois",
    "section": "Validation of modeling",
    "text": "Validation of modeling\nThe assumptions of ANOVA are the same as for any general linear model, namely independence, normality of residuals and homogeneity of variances. In addition, one must check the presence of influential statistical units (i.e. observations having a significant contribution to the construction of the model).\n\nNormality of residuals\n\n\nShow the code\npar(mfrow=c(1,2))\n# Histogram\nhist(mod2$residuals,col='dodgerblue3',xlab=\"residuals\",main=\"Check Normality\")\n# Quantile-Quantile plot\nqqnorm(mod2$residuals,pch=16,col='dodgerblue3',xlab='')\nqqline(mod2$residuals,col='red',lwd=2)\n\n\n\n\n\nThe residuals seem to follow a Normal Distribution.\n\n\nHomogeneity of variance\nThe assumption of homogeneity of variance is the fact that the variation of the residuals is approximately equal over the entire range of explanatory variables, should be verified by plotting the residuals at the estimated values ​​and the residuals at the values ​​of the significant variables. The residuals should show no trend.\n\n\nShow the code\npar(mfrow=c(2,2))\n# residuals vs fitted\nplot(residuals(mod1)~fitted(mod1)\n     , col='dodgerblue3'\n     , pch=16)\n# residuals against state factor\nboxplot(residuals(mod2)~ data$State, \n        varwidth = TRUE,\n        col='darkgrey',\n        ylab = \"Residuals\",\n        xlab = \"States\",\n        main = \"\")\n# residuals against species factor\nboxplot(residuals(mod2)~ data$Species, \n        varwidth = TRUE,\n        col='brown',\n        ylab = \"Residuals\",\n        xlab = \"Species\",\n        main = \"\")\n# residuals against year factor\nboxplot(residuals(mod2)~ data$Year, \n        varwidth = TRUE,\n        col='brown',\n        ylab = \"Residuals\",\n        xlab = \"Years\",\n        main = \"\")\n\n\n\n\n\nWe do not observe any trend. Therefore the hypothesis of homogeneity of variance is verified.\n\n\nIndependence\nANOVA (like any other general linear model) assumes that all statistical units (and therefore residuals) are independent of each other. This issue must be taken into account at the research design stage. Given the approach here, the statistical individuals are independent. This assumption is verified.\n\n\nVerification of influential individuals\n\n\nShow the code\npar(mfrow = c(1, 1))\nplot(cooks.distance(mod2), type = \"h\", ylim = c(0, 1))\nabline(h = 1, col = 2,lwd = 3)\n\n\n\n\n\nThere is no influential individual.\nAll conditions being verified, our modeling can be validated.\n\n\nConclusion of our ANOVA\nThe explanatory variables retained in our model are “State”, “Species” and “Year”.\nThe equation of our model is:\n\\[\n\\text{Y} = 75.7832 - 4.4838 \\cdot \\text{State}_{\\text{Wisconsin}} + 21.9212 \\cdot \\text{Species}_{\\text{Dickcissel}} + 0.5278 \\cdot \\text{Species}_{\\text{Eastern Meadowlark}} + 10.6652 \\cdot \\text{Species}_{\\text{Grasshopper Sparrow}} + 1.9590 \\cdot \\text{Species}_{\\text{Savannah Sparrow}} + 6.2687 \\cdot \\text{Species}_{\\text{Vesper Sparrow}} + 4.5978 \\cdot \\text{Species}_{\\text{Western Meadowlark}} - 8.1836 \\cdot \\text{Year}_{1992} - 9.3039 \\cdot \\text{Year}_{1993} - 11.0971 \\cdot \\text{Year}_{1994} - 11.7709 \\cdot \\text{Year}_{1995} - 11.2748 \\cdot \\text{Year}_{1996} - 10.4340 \\cdot \\text{Year}_{1997} - 9.4950 \\cdot \\text{Year}_{1998} - 6.4308 \\cdot \\text{Year}_{1999} - 4.7644 \\cdot \\text{Year}_{2000} - 6.3518 \\cdot \\text{Year}_{2001} - 10.3377 \\cdot \\text{Year}_{2002} - 12.4141 \\cdot \\text{Year}_{2003} - 17.6615 \\cdot \\text{Year}_{2004} - 14.4370 \\cdot \\text{Year}_{2005} - 20.7535 \\cdot \\text{Year}_{2006} - 15.3033 \\cdot \\text{Year}_{2007} - 17.9192 \\cdot \\text{Year}_{2008} - 19.0311 \\cdot \\text{Year}_{2009} - 15.0863 \\cdot \\text{Year}_{2010} - 13.2651 \\cdot \\text{Year}_{2011}\n\\]\nIn this equation each variable takes the value 1 if the corresponding condition is true and 0 otherwise.\nBut despite all the conditions of the model being validated, this model only explains 22% (R² = 0.22) of our variable Y (Initiation_Date)."
  },
  {
    "objectID": "instructions.html",
    "href": "instructions.html",
    "title": "How to contribute",
    "section": "",
    "text": "Create a specific branch for your chapter named an_explicit_name_for_the_branch and switch on this branch\n\ngit checkout -b an_explicit_name_for_the_branch\nIn the development of the project, you might find necessary to have several branches per chapter.\n\nCreate a quarto file for the chapter chapter0.qmd in your branch\n\ngit add chapter0.qmd\ngit commit -m \"first commit in the chapter branch\"\n\nPush everything on the remote repo on Github\n\nFor the first push after the branch creation, you have to specify the name of the branch on the remote repo and you can use git  push --set-upstream origin an_explicit_name_for_the_branch or\nFor the push to come after the first one, you will simply push by\ngit  push\nOnce you are quite happy with your production, you will be willing to integrate your production on the main branch. A good practice is to ask the permission to push on the main branch, which is named a pull request (PR).\n\nAsk for a PR on Github\nIf needed, specify in the PR message the package you need and mention MarieEtienne as reviewer of the PR.\n\nA mock rendering of the qmd file will start when you request a PR using the Github Action mechanism (called runner on gitlab). If the action passes (green signal), you can go to the next step. If not, you will have to fix the issue (again you can ask assistance if you don’t understand the error).\n\nOnce the PR is checked, mention one of your colleage as reviewer."
  },
  {
    "objectID": "instructions.html#one-chapter-corresponds-at-least-to-one-branch",
    "href": "instructions.html#one-chapter-corresponds-at-least-to-one-branch",
    "title": "How to contribute",
    "section": "",
    "text": "Create a specific branch for your chapter named an_explicit_name_for_the_branch and switch on this branch\n\ngit checkout -b an_explicit_name_for_the_branch\nIn the development of the project, you might find necessary to have several branches per chapter.\n\nCreate a quarto file for the chapter chapter0.qmd in your branch\n\ngit add chapter0.qmd\ngit commit -m \"first commit in the chapter branch\"\n\nPush everything on the remote repo on Github\n\nFor the first push after the branch creation, you have to specify the name of the branch on the remote repo and you can use git  push --set-upstream origin an_explicit_name_for_the_branch or\nFor the push to come after the first one, you will simply push by\ngit  push\nOnce you are quite happy with your production, you will be willing to integrate your production on the main branch. A good practice is to ask the permission to push on the main branch, which is named a pull request (PR).\n\nAsk for a PR on Github\nIf needed, specify in the PR message the package you need and mention MarieEtienne as reviewer of the PR.\n\nA mock rendering of the qmd file will start when you request a PR using the Github Action mechanism (called runner on gitlab). If the action passes (green signal), you can go to the next step. If not, you will have to fix the issue (again you can ask assistance if you don’t understand the error).\n\nOnce the PR is checked, mention one of your colleage as reviewer."
  },
  {
    "objectID": "instructions.html#as-a-reviewer",
    "href": "instructions.html#as-a-reviewer",
    "title": "How to contribute",
    "section": "As a reviewer",
    "text": "As a reviewer\nYour role is essential as you are responsible for the quality of the submission you were assigned to. Read carefully the production and ask for correction/clarification if needed. One you are happy with the correction you can accept the PR."
  },
  {
    "objectID": "Determinants_ant_diversity.html",
    "href": "Determinants_ant_diversity.html",
    "title": "Determinants of Ant Species Density",
    "section": "",
    "text": "INTRODUCTION\n\n1. Article presentation\nOur data come from the article “Biogeography at a Regional Scale: Determinants of Ant Species Density in New England Bogs and Forests” by (Gotelli_2002?).\n\n\n2. Biological context\nGotelli and Ellison are two ecologists, the first one specializing in questions of organization of animal and plant communities, the second one in the disintegration and reassembly of ecosystems following natural and anthropogenic disturbances. Here, they focused on the influence of the latitudinal gradient on the species richness of ants in the state of New England in the northeastern United States. Their study was carried out on 22 sites where, for each, 25 traps were placed in an ombrotrophic peat bog and 25 in the surrounding forest. The species of ants contained in the traps are subsequently identified in the laboratory and, for a given site and habitat, they calculated the species richness (total number of species present).\n\n\n3. Datas and variables\nThe variables used are :\n- Site : the name of the sampled site\n- Latitude : site latitude (quantitative)\n- Altitude : site altitude (quantitative)\n- Area : the area of the peat bog of the site (quantitative)\n- Location : the location of the traps (“Bog” or “Forest”) (qualitative)\n- Nsp : the specific richness of ants, corresponding to the response variable\n\n\n4. Research question\nGotelli and Ellison address 3 questions in this study, but we focus here on two:\n1) Is species density correlated with latitude over such a narrow latitudinal range?\n2) Does the latitudinal gradient persist after statistically controlling for site differences in vegetation composition?\nIn other words: what are the quantitative (latitude, altitude, area) and qualitative (location) variables that determine ant species richness in New England peatlands?\n\n\n5. Importing the dataset\nFrom then on, we can import the dataset located in file “BogAnts.txt”\n\n\nCode\n# Session Configuration :\nrm(list=ls()) # Cleaning the work environment\n\n# Importation\ndataAnts &lt;- read.table(\"BogAnts.txt\", dec=\".\", header = TRUE)\n\n# Transforming location into a factor\ndataAnts$Location&lt;-as.factor(dataAnts$Location)\n\n# Checking the type of variables\nstr(dataAnts)\n\n\n'data.frame':   44 obs. of  6 variables:\n $ Site     : chr  \"ARC\" \"ARC\" \"BH\" \"BH\" ...\n $ Latitude : num  42.3 42.3 42.6 42.6 45 ...\n $ Elevation: int  95 95 274 274 133 133 210 210 362 362 ...\n $ Area     : int  1190 1190 105369 105369 38023 38023 73120 73120 38081 38081 ...\n $ Location : Factor w/ 2 levels \"Bog\",\"Forest\": 2 1 2 1 2 1 2 1 2 1 ...\n $ Nsp      : int  9 8 10 8 6 5 9 4 6 2 ...\n\n\nConclusion :\nQualitative or quantitative variables are well considered as such.\n\n\n6. Which model and why?\nTo model the relationship between a quantitative response variable \\(Y\\) and explanatory variables \\(X_{1}\\),\\(X_{2}\\)…\\(X_{p}\\), quantitative and/or qualitative we use general linear models, or glm, (linear regression, ANCOVA, ANOVA). To be able to use these glm, three conditions of application are necessary: ​​homogeneity of variances, residual independence and residual normality. However, the \\(Y\\) responses analyzed in ecology can sometimes be discrete and deviate from the hypothesis of normality.\nFor discrete response variables (counts, binary data), the variance of \\(Y\\) generally varies with the mean of \\(Y\\). This relationship then seems to indicate that the variance cannot be homogeneous in a data set, due to its dependence on the mean. However, general linear models have a constant variance as their application hypothesis (i.e. a homogeneity of the variance). Furthermore, when applying a general linear model to count data, the predicted values ​​obtained may be negative (which is impossible given the nature of \\(Y\\)) and the residuals may not be normally distributed. Therefore, using a general linear model (glm) on discrete responses very generally generates deviations from the application conditions. In conclusion, it becomes necessary to use a method more suited to the analysis of discrete response variables such as generalized linear models (glim).\nHere are the steps to follow to establish a generalized linear model:\n1. Formulate the hypothesis of the distribution law of the response variable \\(Y_{i}\\)\n2. Explore the data (outliers, distribution of values,) with (Zuur_2010?) protocol\n3. Analyze the interactions between the variables Y and Xs (analysis of the relationships between X and Y, between Xs, and search for collinearity between Xs)\n4. Proceed with statistical analyses (construction of the model, analysis of the coefficients, explanatory power of the model)\n5. Conclude on the results\nA generalized linear model is written as follows (equation 1): \\[g(\\mu_{y})= \\alpha+ \\beta_{1}.X_{i1}+ \\beta_{2}.X_{i2}+\\beta_{3}.X_{i3}+...\\beta_{p}.X_{ip} = \\eta  \\tag{1}\\] The linear predictor, \\(\\eta\\), is derived from the linear model as the sum of the \\(p\\) terms associated with each of the \\(\\beta_{p}\\) parameters. Its value is obtained by transforming the value of \\(Y\\) by the link function, and the predicted value of \\(Y\\) is obtained by applying to \\(\\eta\\) the inverse function of the link function.\nTo illustrate this point, we are interested in counts. A count is a discrete and positive random variable. It is possible that the distribution of its values follows a Poisson distribution, a Negative Binomial distribution or even a Normal distribution when the values are very large.\nOur example illustrates a distribution following the Poisson law.\nThe Poisson law is useful for describing rare and independent discrete events. Thus, a variable \\(Y\\) that follows a Poisson law with parameter \\(\\lambda\\) is written as follows (equation 2): \\[Pr(Y=y)=\\frac{e^{-\\lambda}.\\ lambda^y}{y!} \\tag{2}\\] where \\(y\\) represents the observed number of occurrences (i.e., \\(y\\)=0, 1, 2…} and \\(\\lambda\\) the mean and variance of the Poisson law (i.e. in the Poisson law: E(\\(y\\))= Var(\\(y\\))=\\(\\lambda\\)).\nIn a Poisson-type glim, the link function is the log function. Thus, the model is written (equation 3): \\[log(\\mu_{y})= \\alpha+ \\beta_{1}.X{i1}+ \\beta_{2}.X{i2}+\\beta_{3}.X{i3}+...\\beta_{p}.X{ip} = \\eta  \\tag{3}\\] 150 / 5 000 The predicted values ​​of \\(Y\\) are obtained by applying to \\(\\eta\\) the inverse function of the link function, here the log function (equation 4): \\[\\mu_{y}= e^{\\alpha+ \\beta_{1}.X{i1}+ \\beta_{2}.X{i2}+\\beta_{3}.X{i3}+...\\beta_{p}.X{ip}} = e^{\\eta}  \\tag{4}\\]\nGeneralized linear models of the Poisson type have an error structure that follows a Poisson distribution. This structure allows, among other things, to precisely define the relationship between the mean and the variance. This relationship is exploited by the maximum likelihood method to estimate the coefficients and standard errors of the parameters of the GLM model.\n\n\n7. Environment Configuration and Packages\nTo analyze our data we set up the session by cleaning the workspace. We will also need to load the following packages : knitr, ggplot2, tinytext, corrplot, plot3D, DHARMa, rcompanion, lattice, patchwork, MASS et rcompanion\n\n\n8. Checking for missing data\n\n\nCode\n# Checking for missing data\ncolSums(is.na(dataAnts))\n\n\n     Site  Latitude Elevation      Area  Location       Nsp \n        0         0         0         0         0         0 \n\n\nCode\nsummary(dataAnts)\n\n\n     Site              Latitude       Elevation          Area       \n Length:44          Min.   :41.97   Min.   :  1.0   Min.   :   248  \n Class :character   1st Qu.:42.17   1st Qu.: 95.0   1st Qu.:  8852  \n Mode  :character   Median :42.56   Median :223.0   Median : 38052  \n                    Mean   :43.02   Mean   :232.7   Mean   :144528  \n                    3rd Qu.:44.29   3rd Qu.:353.0   3rd Qu.: 89208  \n                    Max.   :44.95   Max.   :543.0   Max.   :864970  \n   Location       Nsp        \n Bog   :22   Min.   : 2.000  \n Forest:22   1st Qu.: 4.000  \n             Median : 6.000  \n             Mean   : 7.023  \n             3rd Qu.: 8.250  \n             Max.   :18.000  \n\n\nThere are no missing values.\n\n\n9. Analysis process\nFrom this, we will first examine the dataset (outliers, potential relationships between Y and Xs, …) in order to have a first impression. Subsequently, we will carry out our statistical analysis by building and refining our model. Finally, we will analyze its coefficients and its explanatory power in order to validate it or not.\n\n\n\nDATA EXPLORATION\n\n1. Data overview\n\na. Outliers in Y and distribution of Y values\nThe first step in exploring the dataset is to check for potential outliers in the response variable \\(Y\\) and to examine the distribution of its values.\nOutliers: In ecological datasets, it is common to encounter individuals with extreme values for the response variable. These individuals, due to their unusual values, may disproportionately impact model construction. However, these extreme values may arise from either the natural variability of ecological phenomena or from errors (e.g., measurement or handling errors). Identifying these individuals prior to statistical analysis helps prevent errors and, if necessary, justifies the exclusion of certain outliers to improve the model’s robustness.\nOutliers can be identified using a Boxplot or a Cleveland plot of the values of \\(Y\\).\n\n\nCode\n# Boxplot \nbp &lt;- ggplot(data = dataAnts, aes(y = Nsp))+\n  geom_boxplot()+\n  labs(subtitle = \"A. Boxplot\",\n       y = \"species richness\")+\n  theme(\n    panel.background = element_rect(fill=\"white\"),\n    panel.grid.major = element_blank(), \n    panel.grid.minor = element_blank(),\n    axis.text.x = element_blank(), \n    axis.ticks.x = element_blank(),\n    \n    axis.title.x = element_text(size = 8, color = \"darkblue\"),\n    axis.title.y = element_text(size = 8, color = \"darkblue\"),\n    plot.title = element_text(size = 14, face = \"bold\", color = \"black\"),       \n    plot.subtitle = element_text(size = 10, color = \"black\"),                  \n    plot.caption = element_text(size = 4, face = \"italic\", color = \"darkgrey\")\n  )\n\n# Cleveland plot \ncp &lt;- ggplot(data = dataAnts, aes(x = Nsp, y = 1:nrow(dataAnts)))+\n  geom_jitter(width = 0.1, size = 3, color = \"black\")+\n  labs(subtitle = \"B. Cleveland plot\",\n       x = \"species richness\")+\n  theme_minimal()+\n  theme(\n    panel.grid.major.x = element_blank(),\n    panel.grid.minor.x = element_blank(),\n    axis.text.y = element_blank(),\n    axis.ticks.y = element_blank(),\n    axis.title.y = element_blank(),\n    \n    axis.title.x = element_text(size = 8, color = \"darkblue\"),\n    plot.title = element_text(size = 14, face = \"bold\", color = \"black\"),       \n    plot.subtitle = element_text(size = 10, color = \"black\"),                  \n    plot.caption = element_text(size = 4, face = \"italic\", color = \"darkgrey\")\n  )\n\n## Display\n(bp + cp) + \n  plot_layout(widths = c(1, 2)) \n\n\n\n\n\nFigure 1: Analyse of Y outliers\n\n\n\n\nAccording to Figure 1, \\(Y\\) does not exhibit any extreme or outlier values.\nDistribution of values: Analyzing the distribution of the values of \\(Y\\) allows us to preliminarily identify the probability distribution that best explains the ongoing ecological processes. This is particularly interesting if the data suggest a non-linear or asymmetric relationship.\nThe distribution of \\(Y\\) values can be visualized using a histogram or a Normal Q-Q plot.\n\n\nCode\n# Histogram\nhg &lt;- ggplot(data = dataAnts, aes(x = Nsp))+\n  geom_histogram(binwidth = 2, fill = \"blue\", color = \"black\")+\n  theme_minimal()+\n  labs(subtitle = \"A. Histogram\",\n       x = \"species richness\",\n       y = \"frequency\")+\n  theme(\n    axis.title.x = element_text(size = 8, color = \"darkblue\"),\n    axis.title.y = element_text(size = 8, color = \"darkblue\"),\n    plot.title = element_text(size = 14, face = \"bold\", color = \"black\"),       \n    plot.subtitle = element_text(size = 10, color = \"black\"),                  \n    plot.caption = element_text(size = 4, face = \"italic\", color = \"darkgrey\")\n    )\n\nqqp &lt;- ggplot(data = dataAnts, aes(sample = Nsp))+\n  geom_qq_line(color = \"red\", size = 1.2)+\n  geom_qq()+\n  theme_minimal()+\n  labs(subtitle = \"B. Q-Q plot\",\n       x = \"theorical quantiles\",\n       y = \"observed quantiles\")+\n  theme(\n    axis.title.x = element_text(size = 8, color = \"darkblue\"),\n    axis.title.y = element_text(size = 8, color = \"darkblue\"),\n    plot.title = element_text(size = 14, face = \"bold\", color = \"black\"),       \n    plot.subtitle = element_text(size = 10, color = \"black\"),                  \n    plot.caption = element_text(size = 4, face = \"italic\", color = \"darkgrey\")\n  )\n\n# Display\n(hg + qqp) +\n  plot_layout(widths = c(1, 2)) \n\n\n\n\n\nFigure 2: Analyse of Y distribution\n\n\n\n\nThe distribution of \\(Y\\) (negative exponential, Figure 2 A) and the nature of the dataset (count data without aggregation) suggest that \\(Y\\) follows a Poisson distribution. This hypothesis is supported by the deviation from normality of \\(Y\\) observed values shown in Figure 2 B.\nConclusion :\nAfter analyzing the outliers and the distribution of the response variable $Y$, it appears appropriate to use \\(Y\\) as is while applying a Poisson distribution.\n\n\nb. X quantitative: presence of outliers and distribution of X values\nThe dataset has three quantitative explanatory variables: Latitude, Elevation, and Area. Just like for the response variable \\(Y\\), it is necessary to examine the presence of outliers as well as the distribution of each of these explanatory variables.\nLatitude :\n\n\nCode\np1 &lt;- ggplot(dataAnts) +\n  aes(x=Latitude, y=factor(1:nrow(dataAnts), levels = 1:nrow(dataAnts))) + # display in the order of appearance\n  geom_jitter(width=0, height=0.1) +\n  scale_x_continuous(breaks = seq(41.5, 45, by = 0.5)) + # values of the X axis\n  labs(subtitle = \"A. Cleveland Plot\",\n       x= \"Latitude\") +  # Titres\n  theme_minimal() +\n  theme(axis.text.y = element_blank(),   # remove the labels from the Y axis\n        axis.ticks.y = element_blank(),  # remove the ticks from the Y axis\n        axis.title.y = element_blank(),  # remove the title from the X axis\n        axis.title.x = element_text(size = 8, color = \"darkblue\"),\n        plot.title = element_text(size = 14, face = \"bold\", color = \"black\"),\n        plot.subtitle = element_text(size = 10, color = \"black\")\n        )   \n\np2 &lt;- ggplot(dataAnts) +\n  aes(x = Latitude) +  \n  geom_histogram(binwidth = 0.25, fill = \"blue\", color = \"black\", alpha = 0.7) +  # histogram\n  scale_x_continuous(breaks = seq(41.5, 45, by = 0.5)) +  # values of the X axis\n  scale_y_continuous(breaks = seq(0, 10, by = 2)) +  # values of the Y axis \n  labs(subtitle = \"B. Histogram\",\n       x = \"Latitude\") +  # title\n  theme_minimal() +  # theme of the graph: minimal\n  theme(\n    axis.title.x = element_text(size = 8, color = \"darkblue\"), \n    axis.title.y = element_text(size = 8, color = \"darkblue\"),\n    plot.subtitle = element_text(size = 10, color = \"black\")\n  ) \n\np3 &lt;- ggplot(dataAnts, aes(sample = Latitude)) +\n  labs(subtitle = \"C. Quantile-Quantile Plot\",\n       caption = \"From the dataset dataAnts\",\n       x = \"theorical quantiles\",\n       y = \"observed quantiles\") +\n  stat_qq() +  # observed quantiles\n  stat_qq_line(col = \"red\", size = 1) +  # theorical quantiles\n  theme_minimal() + \n  theme(\n    axis.title.x = element_text(size = 8, color = \"darkblue\"),\n    axis.title.y = element_text(size = 8, color = \"darkblue\"),\n    plot.title = element_text(size = 14, face = \"bold\", color = \"black\"),       \n    plot.subtitle = element_text(size = 10, color = \"black\"),                  \n    plot.caption = element_text(size = 4, face = \"italic\", color = \"darkgrey\") \n  ) \n\n(p1 / p2) | p3 + \n  plot_layout(guides = \"collect\")\n\n\n\n\n\nFigure 3: Analyse of explanatory variable Latitude\n\n\n\n\nThere are no outliers observed in the Cleveland plot (Figure 3 A) or in the histogram (Figure 3 B).\nThe Quantile plot (Figure 3 C) shows a deviation from normality. This suggests that it is more appropriate to use a generalized linear model (glm) rather than a classical linear model (lm).\nElevation :\n\n\n\n\n\nFigure 4: Analyse of explanatory variable Elevation\n\n\n\n\nNo outliers are observed in the Cleveland plot (Figure 4 A) or in the histogram (Figure 4 B).\nThe Quantile plot (Figure 4 C) shows a deviation from normality. This suggests that it is advisable to use a generalized linear model rather than a classical linear model.\nArea :\n\n\n\n\n\nFigure 5: Analyse of explanatory variable Area\n\n\n\n\nWe observe outliers in the Cleveland plot (Figure 5 A) and in the histogram (Figure 5 B) due to the presence of very extensive peatlands. We can apply a transformation to this variable and consider a logarithmic transformation.\n\n\n\n\n\nFigure 6: Analyse of explanatory variable log(Area)\n\n\n\n\nNo outliers are observed in the Cleveland plot (Figure 6 A) or in the histogram (Figure 6 B).\nConclusion :\nThe analysis of outliers and the distribution of the variables suggest that, after modification, the three quantitative variables (covariates) Latitude, Elevation, and LogArea can be used in the construction of the model.\n\n\nc. X qualitative : number of modalities and number of individuals per modalities\nWhen the dataset includes qualitative variables (factors), it is essential to analyze the balance of modalities: if there are more individuals in one modality compared to another, their weight in the model may lead to a biased final interpretation.\n\n\nCode\nsummary(dataAnts$Location)\n\n\n   Bog Forest \n    22     22 \n\n\nHere, the data are well distributed between the two modalities (Bog = peatlands and Forest = forests).\nConclusion :\nThe analysis of outliers and the distribution of the qualitative variable suggest that it can be used in the construction of the model.\n\n\n\n2. Analysis of interactions between variables Y and Xs\n\na. Analyze the potential relationship between Y and Xs\nIn order to test the possible relationship between the response variable \\(Y\\) and the explanatory variables \\(Xs\\), it will be essential to carry out statistical modelling, as this is the only way to test the significance of the relationships. However, we can start by performing graphical analyses to better visualize the data and get an idea\n\n\nCode\npar(mfrow=c(2,2))\n\n# For the latitude variable\nplot(dataAnts$Nsp~dataAnts$Latitude,pch=16,col='deepskyblue4',xlab='Latitude',ylab='Ant species richness', main = \"A. Latitude\")\n\n# For the altitude variable\nplot(dataAnts$Nsp~dataAnts$Elevation,pch=16,col='deepskyblue4',xlab='Elevation',ylab='Ant species richness', main = \"B. Elevation\")\n\n# For the variable peatland area\nplot(dataAnts$Nsp~dataAnts$LogArea,pch=16,col='deepskyblue4',xlab='Peatland area',ylab='Ant species richness', main = \"C. Peatland area\")\n\n# For the location variable\nboxplot(dataAnts$Nsp~dataAnts$Location, varwidth = TRUE, ylab = \"Ant species richness\", xlab = \"Location\", col=c('saddlebrown','palegreen4'), main = \"D. Location\")\n\n\n\n\n\nFigure 7: Analyse of relation between Y and explanatory variable\n\n\n\n\nRelationship between ant species richness and latitude (Figure 7 A): We can see that the higher the latitude, the lower the species richness. We can say that the further north we are, the fewer ant species there are.\nRelationship between ant species richness and altitude (Figure 7 B): In this graph, we can again see that the higher the altitude, the lower the species richness.\nRelationship between ant species richness and bog area (Figure 7 C): Here, there appears to be no relationship between ant species richness and bog area.\nRelationship between ant species richness and location (Figure 7 D.): Here, there appears to be a relationship between location and ant species richness, with higher species richness in forests than in bogs.\nConclusion :\nIt seems that the further north and the higher the relief, the lower the ant species richness. What’s more, if we’re in a forest, the species richness will be greater than in bogs.\n\n\nb. Analysis of Potential Interactions Among the X Variables\nWe aim to study interactions between the factor and the three covariates. Thus, we exclude any interaction among the quantitative explanatory variables. We use a graphical approach to estimate the potential interactive effect among these different variables.\n\n\nCode\npar(mfrow=c(1,3))\n\n# Interactions between Latitude & Location\nplot(dataAnts$Nsp~dataAnts$Latitude,type='n',ylab = \"Ant specific richness\",xlab=\"Latitude\", main=\"A.\")\npoints(dataAnts$Nsp[dataAnts$Location==\"Bog\"]~dataAnts$Latitude[dataAnts$Location==\"Bog\"],pch=16,cex=2,col='saddlebrown')\npoints(dataAnts$Nsp[dataAnts$Location==\"Forest\"]~dataAnts$Latitude[dataAnts$Location==\"Forest\"],pch=17,cex=2,col='palegreen4')\n\n# Interactions between Altitude & Localisation\nplot(dataAnts$Nsp~dataAnts$Elevation,type='n',ylab = \"Ant specific richness\",xlab=\"Elevation\", main=\"B.\")\npoints(dataAnts$Nsp[dataAnts$Location==\"Bog\"]~dataAnts$Elevation[dataAnts$Location==\"Bog\"],pch=16,cex=2,col='saddlebrown')\npoints(dataAnts$Nsp[dataAnts$Location==\"Forest\"]~dataAnts$Elevation[dataAnts$Location==\"Forest\"],pch=17,cex=2,col='palegreen4')\n\n# Interactions between Superficie de la tourbière & Localisation\nplot(dataAnts$Nsp~dataAnts$LogArea,type='n',ylab = \"Ant specific richness\",xlab=\"Bog area\", main=\"C.\")\npoints(dataAnts$Nsp[dataAnts$Location==\"Bog\"]~dataAnts$LogArea[dataAnts$Location==\"Bog\"],pch=16,cex=2,col='saddlebrown')\npoints(dataAnts$Nsp[dataAnts$Location==\"Forest\"]~dataAnts$LogArea[dataAnts$Location==\"Forest\"],pch=17,cex=2,col='palegreen4')\n\n\n\n\n\nFigure 8: Analyse of relation between explanatory variable\n\n\n\n\nGenerally if we look at Figure 8, we can assume an interaction between covariates if the slopes formed by the two point clouds are different. Here, the clouds do not clearly reveal any similarity or difference in trend for each graph. It is therefore difficult to draw conclusions about these interactions.\n\n\nc. Checking for Potential Collinearity Among the X Variables\nWe aim to avoid collinearity among the explanatory variables in our modeling to prevent multiple variables from providing the same information. To do this, we must examine the statistical relationships that may exist among the variables by calculating the correlation between quantitative \\(X\\) variables, and analyzing the influence of the qualitative \\(X\\) on the quantitative \\(X\\) variables using plot graphics.\n\n\nCode\n# Checking for collinearity between independent continuous variables\n# Creating a scatterplot for each pair of covariates\nnewdata&lt;-cbind(dataAnts$Latitude,dataAnts$Elevation,dataAnts$LogArea)\ncolnames(newdata)&lt;-c('Latitude','Elevation','Log Bog area')\nnewdata&lt;-data.frame(newdata)\nplot(newdata,pch=16,col='deepskyblue4')\n\n\n\n\n\nFigure 9: Analyse of collinearity between independant continuous variables, scatterplot for each pair of covariates\n\n\n\n\n\n\nCode\n# Calculating correlation for each pair of covariates\nM&lt;-cor(newdata)\ncorrplot.mixed(M,upper=\"square\",lower.col=\"black\", tl.col=\"black\",cl.cex = 0.8,tl.cex = 0.7,number.cex =0.8)\n\n\n\n\n\nFigure 10: Analyse of collinearity between independant continuous variables, correlation for each pair of covariates\n\n\n\n\n\n\nCode\npar(mfrow=c(1,3))\n\n# Checking for collinearity between categories and continuous variables\n# Latitude and Location\nboxplot(dataAnts$Latitude~dataAnts$Location, varwidth = TRUE, ylab = \"Latitude\", xlab = \"Location\",col=c('saddlebrown','palegreen4'))\n\n# Altitude and Location\nboxplot(dataAnts$Elevation~dataAnts$Location, varwidth = TRUE, ylab = \"Elevation\", xlab = \"Location\",col=c('saddlebrown','palegreen4'))\n\n# Bog Area and Location\nboxplot(dataAnts$LogArea~dataAnts$Location, varwidth = TRUE, ylab = \"Bog area\", xlab = \"Location\",col=c('saddlebrown','palegreen4'))\n\n\n\n\n\nFigure 11: Analyse of collinearity between categories and continuous variables\n\n\n\n\nIn the first graph (Figure 9), we can see that the point clouds do not appear to show any trend toward collinearity. This impression is confirmed by the calculated values in the following figure (Figure 10), where the values are well below 0.7, which is commonly used as a threshold for collinearity (above this, variables are considered correlated). The almost complete overlap of the boxplots (Figure 11) further supports the non-collinearity of these factors.\nConclusion :\nThere does not appear to be any collinearity among the variables, so we can retain them all.\n\n\n\n\nSTATISTICAL ANALYSIS\n\n1. Model construction\nWe aim to produce the best model for predicting the number of species. The response variable is a count (a discrete quantitative variable) with small numbers (&lt;30), so the appropriate distribution is the Poisson distribution. We’re going to model it using a generalized linear Poisson model.\nTo arrive at the “candidate” model to be tested, we’ll start with the “complete” model, i.e. with all the explanatory variables and their interactions, and use Backward selection to select the variables and interactions to be retained.\nLet’s start with the complete model:\n\n\nCode\n# model formulation with the fonction glm() and family=poisson(link=\"log\")\nmod1&lt;-glm(Nsp~ Location\n        + Latitude\n        + Elevation\n        + LogArea\n        + Location:Latitude\n        + Location:Elevation\n        + Location:LogArea\n        ,data=dataAnts\n        ,family=poisson(link=\"log\"))\n\n\nBased on this complete model, we will eliminate the insignificant interactions step by step.\n\n\nCode\n# Step 1\ndrop1(mod1,test=\"Chi\")\n\n\nSingle term deletions\n\nModel:\nNsp ~ Location + Latitude + Elevation + LogArea + Location:Latitude + \n    Location:Elevation + Location:LogArea\n                   Df Deviance    AIC     LRT Pr(&gt;Chi)\n&lt;none&gt;                  39.973 216.33                 \nLocation:Latitude   1   39.981 214.34 0.00801   0.9287\nLocation:Elevation  1   40.370 214.72 0.39675   0.5288\nLocation:LogArea    1   40.075 214.43 0.10247   0.7489\n\n\nAll three interactions are insignificant. We remove the ‘Location:Latitude’ interaction as it is the ‘least significant’. We can also see that the drop1() function informs us that it’s by removing this interaction that we get the best AIC.\nWe obtain the following model:\n\n\nCode\n# Step 2\nmod1&lt;-glm(Nsp~ Location\n        + Latitude\n        + Elevation\n        + LogArea\n        + Location:Elevation\n        + Location:LogArea\n        ,data=dataAnts\n        ,family=poisson(link=\"log\"))\n\ndrop1(mod1,test=\"Chi\")\n\n\nSingle term deletions\n\nModel:\nNsp ~ Location + Latitude + Elevation + LogArea + Location:Elevation + \n    Location:LogArea\n                   Df Deviance    AIC     LRT  Pr(&gt;Chi)    \n&lt;none&gt;                  39.981 214.34                      \nLatitude            1   55.094 227.45 15.1134 0.0001012 ***\nLocation:Elevation  1   40.426 212.78  0.4446 0.5049344    \nLocation:LogArea    1   40.078 212.43  0.0974 0.7550075    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nIn the same way, we remove the ‘Location:LogArea’ interaction.\n\n\nCode\n# Step 3\nmod1&lt;-glm(Nsp~ Location\n        + Latitude\n        + Elevation\n        + LogArea\n        + Location:Elevation\n        ,data=dataAnts\n        ,family=poisson(link=\"log\"))\n\ndrop1(mod1,test=\"Chi\")\n\n\nSingle term deletions\n\nModel:\nNsp ~ Location + Latitude + Elevation + LogArea + Location:Elevation\n                   Df Deviance    AIC     LRT  Pr(&gt;Chi)    \n&lt;none&gt;                  40.078 212.43                      \nLatitude            1   55.176 225.53 15.0976 0.0001021 ***\nLogArea             1   40.273 210.63  0.1943 0.6593240    \nLocation:Elevation  1   40.499 210.85  0.4208 0.5165445    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nWe also remove the ‘Location:Elevation’ interaction. We now look at the significance of the explanatory variables.\n\n\nCode\n# Step 4\nmod1&lt;-glm(Nsp~ Location\n        + Latitude\n        + Elevation\n        + LogArea\n        ,data=dataAnts\n        ,family=poisson(link=\"log\"))\n\ndrop1(mod1,test=\"Chi\")\n\n\nSingle term deletions\n\nModel:\nNsp ~ Location + Latitude + Elevation + LogArea\n          Df Deviance    AIC     LRT  Pr(&gt;Chi)    \n&lt;none&gt;         40.499 210.85                      \nLocation   1   70.185 238.54 29.6856 5.081e-08 ***\nLatitude   1   55.621 223.97 15.1221 0.0001008 ***\nElevation  1   49.909 218.26  9.4100 0.0021580 ** \nLogArea    1   40.690 209.04  0.1913 0.6618646    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nAs the ‘LogArea’ variable does not have a siginificative effect, we eliminate it from the model.\n\n\nCode\n# Step 5\nmod1&lt;-glm(Nsp~ Location\n        + Latitude\n        + Elevation\n        ,data=dataAnts\n        ,family=poisson(link=\"log\"))\n\ndrop1(mod1,test=\"Chi\")\n\n\nSingle term deletions\n\nModel:\nNsp ~ Location + Latitude + Elevation\n          Df Deviance    AIC     LRT  Pr(&gt;Chi)    \n&lt;none&gt;         40.690 209.04                      \nLocation   1   70.376 236.73 29.6856 5.081e-08 ***\nLatitude   1   56.649 223.00 15.9590 6.473e-05 ***\nElevation  1   50.284 216.64  9.5938  0.001952 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nThe remaining explanatory variables are significant, so we retain this model as a candidate.\nWe will then identify the candidate model using an approach other than the significance of the p-values: the AIC with the stepwise mode.\n\n\nCode\n# complete model construction\nmodelcomplet&lt;- glm(Nsp~ Location\n        + Latitude\n        + Elevation\n        + LogArea\n        + Location:Latitude\n        + Location:Elevation\n        + Location:LogArea\n        ,data=dataAnts\n        ,family=poisson(link=\"log\"))\n\n# model selection\nmodfinal&lt;-stepAIC(modelcomplet,direction=\"both\")\n\n\nStart:  AIC=216.33\nNsp ~ Location + Latitude + Elevation + LogArea + Location:Latitude + \n    Location:Elevation + Location:LogArea\n\n                     Df Deviance    AIC\n- Location:Latitude   1   39.981 214.34\n- Location:LogArea    1   40.075 214.43\n- Location:Elevation  1   40.370 214.72\n&lt;none&gt;                    39.973 216.33\n\nStep:  AIC=214.34\nNsp ~ Location + Latitude + Elevation + LogArea + Location:Elevation + \n    Location:LogArea\n\n                     Df Deviance    AIC\n- Location:LogArea    1   40.078 212.43\n- Location:Elevation  1   40.426 212.78\n&lt;none&gt;                    39.981 214.34\n+ Location:Latitude   1   39.973 216.33\n- Latitude            1   55.094 227.45\n\nStep:  AIC=212.43\nNsp ~ Location + Latitude + Elevation + LogArea + Location:Elevation\n\n                     Df Deviance    AIC\n- LogArea             1   40.273 210.63\n- Location:Elevation  1   40.499 210.85\n&lt;none&gt;                    40.078 212.43\n+ Location:LogArea    1   39.981 214.34\n+ Location:Latitude   1   40.075 214.43\n- Latitude            1   55.176 225.53\n\nStep:  AIC=210.63\nNsp ~ Location + Latitude + Elevation + Location:Elevation\n\n                     Df Deviance    AIC\n- Location:Elevation  1   40.690 209.04\n&lt;none&gt;                    40.273 210.63\n+ LogArea             1   40.078 212.43\n+ Location:Latitude   1   40.270 212.62\n- Latitude            1   56.212 224.57\n\nStep:  AIC=209.04\nNsp ~ Location + Latitude + Elevation\n\n                     Df Deviance    AIC\n&lt;none&gt;                    40.690 209.04\n+ Location:Elevation  1   40.273 210.63\n+ LogArea             1   40.499 210.85\n+ Location:Latitude   1   40.650 211.00\n- Elevation           1   50.284 216.64\n- Latitude            1   56.649 223.00\n- Location            1   70.376 236.73\n\n\nCode\n# final model\ndrop1(modfinal,test=\"Chi\")\n\n\nSingle term deletions\n\nModel:\nNsp ~ Location + Latitude + Elevation\n          Df Deviance    AIC     LRT  Pr(&gt;Chi)    \n&lt;none&gt;         40.690 209.04                      \nLocation   1   70.376 236.73 29.6856 5.081e-08 ***\nLatitude   1   56.649 223.00 15.9590 6.473e-05 ***\nElevation  1   50.284 216.64  9.5938  0.001952 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nCode\nsummary(modfinal)\n\n\n\nCall:\nglm(formula = Nsp ~ Location + Latitude + Elevation, family = poisson(link = \"log\"), \n    data = dataAnts)\n\nCoefficients:\n                 Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)    11.9368121  2.6214970   4.553 5.28e-06 ***\nLocationForest  0.6354389  0.1195664   5.315 1.07e-07 ***\nLatitude       -0.2357930  0.0616638  -3.824 0.000131 ***\nElevation      -0.0011411  0.0003749  -3.044 0.002337 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 102.76  on 43  degrees of freedom\nResidual deviance:  40.69  on 40  degrees of freedom\nAIC: 209.04\n\nNumber of Fisher Scoring iterations: 4\n\n\nNote: it is recommended to use AIC with more than 40 individuals per parameter, otherwise there is AICc ((YannickOutreman?)).\nConclusion :\nBoth methods arrive at the same candidate model: Nsp~Latitude+Elevation+LogArea.\n\n\n2. Coefficients analysis\nThe next step is to analyze the coefficients. We’ll be looking at the precise effect of the selected explanatory variables (Latitude, Elevation, LogArea) on ant species richness.\n\n\nCode\n# Coefficients \nsummary(mod1)\n\n\n\nCall:\nglm(formula = Nsp ~ Location + Latitude + Elevation, family = poisson(link = \"log\"), \n    data = dataAnts)\n\nCoefficients:\n                 Estimate Std. Error z value Pr(&gt;|z|)    \n(Intercept)    11.9368121  2.6214970   4.553 5.28e-06 ***\nLocationForest  0.6354389  0.1195664   5.315 1.07e-07 ***\nLatitude       -0.2357930  0.0616638  -3.824 0.000131 ***\nElevation      -0.0011411  0.0003749  -3.044 0.002337 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 102.76  on 43  degrees of freedom\nResidual deviance:  40.69  on 40  degrees of freedom\nAIC: 209.04\n\nNumber of Fisher Scoring iterations: 4\n\n\nCode\n#                 Estimate Std. Error z value Pr(&gt;|z|)    \n#(Intercept)    11.9368121  2.6214970   4.553 5.28e-06 ***\n#LocationForest  0.6354389  0.1195664   5.315 1.07e-07 ***\n#Latitude       -0.2357930  0.0616638  -3.824 0.000131 ***\n#Elevation      -0.0011411  0.0003749  -3.044 0.002337 ** \n\n#Null deviance: 102.76  on 43  degrees of freedom\n#Residual deviance:  40.69  on 40  degrees of freedom\n\n\nThe model’s summary() allows us to see the coefficients corresponding to each variable, as well as the intercept (based on the population mean). For a factor (qualitative variable), the coefficient corresponds to the comparison between the given modality and the so-called “reference” modality, whose coefficient is equal to 0. The deviance scores will be used in the following section. This table shows the different coefficients:\nLocation factor\n- \\(Location_{Bog}\\) = 0 (reference modality for Location)\n- \\(Location_{Forest}\\) = \\(+0.63^{**}\\)\nLatitude covariate\n- \\(\\beta_{Latitude}\\) = \\(-0.23^{***}\\)\nElevation covariate\n- \\(\\beta_{Elevation}\\) = \\(-0.001^{***}\\)\nThe candidate model with the coefficients is written (equation 5): \\[ log(Species\\:Richness) = 11.93^{***} + (Location_{Bog} = 0 ;\\:Location_{Forest} = +0.63^{***})\\:- 0.23^{***}.Latitude\\: -0.001^{***}. Elevation   \\tag{5}\\]\nReminder: to model a discrete quantitative variable with a generalized linear model, we use a link function. Here, with Poisson distribution, we use the log() function.\n\n\n3. Explanatory power of the model\nTo determine the quality of our model, we’ll calculate the distance between the candidate model and the null model. The null model is a model that summarizes the data with a single parameter: the mean of \\(Y\\). This model does not explain the data.\nOne way of determining model quality is to calculate a pseudo R²*. To do this, we determine the distance between the deviance of the null model and the residual deviance of the candidate model (equation 6).\n\\[Pseudo\\:R^2=100\\:.\\:\\frac{Null\\:Deviance- Residual\\:Deviance}{Null\\:Deviance} \\tag{6}\\]\nWe can calculate the pseudo R² in three different ways: with the McFadden method, the Cox and Snell method or the Nagelkerke method. The last two methods require the ‘rcompagnon’ package.\nIn our example, as seen in the previous section, the null model has a deviance of 102.76 and the residual deviance is 40.69.\nWe will therefore calculate the quality of the model with the following lines:\n\n\nCode\n# Estimate of deviance explained\n(mod1$null.deviance-mod1$deviance)/mod1$null.deviance\n\n\n[1] 0.6040372\n\n\nCode\n# Some others estimates of deviance explained - package 'rcompanion'\nlibrary(rcompanion)\nnagelkerke(mod1)\n\n\n$Models\n                                                                                      \nModel: \"glm, Nsp ~ Location + Latitude + Elevation, poisson(link = \\\"log\\\"), dataAnts\"\nNull:  \"glm, Nsp ~ 1, poisson(link = \\\"log\\\"), dataAnts\"                              \n\n$Pseudo.R.squared.for.model.vs.null\n                             Pseudo.R.squared\nMcFadden                             0.235913\nCox and Snell (ML)                   0.756039\nNagelkerke (Cragg and Uhler)         0.757956\n\n$Likelihood.ratio.test\n Df.diff LogLik.diff  Chisq    p.value\n      -3     -31.036 62.073 2.1197e-13\n\n$Number.of.observations\n         \nModel: 44\nNull:  44\n\n$Messages\n[1] \"Note: For models fit with REML, these statistics are based on refitting with ML\"\n\n$Warnings\n[1] \"None\"\n\n\nHere, the estimate of deviance explained is 60% or 75%, depending on the method used.\n\n\nCode\nplot(fitted(mod1)~dataAnts$Nsp,col='dodgerblue3',pch=16,ylab=\"Estimated values\",xlab=\"Observed values\")\nabline(0,1)\n\n\n\n\n\nFigure 12: Representation of predict values\n\n\n\n\n\n\n4. Model validation\nThe independence of residuals is the only limitation of the generalized linear model. Analysis of the residuals therefore enables us to identify possible trends and check for the presence of influential statistical units.\nTo begin with, checking for overdispersion is essential when running a Poisson generalized linear model. For all generalized linear models using count data, we need to check for the absence of overdispersion.\nTo do this, we calculate a parameter called the ‘scale parameter’. If its value is significantly greater than 1 (from 1.6 or 1.7), there is overdispersion. The model is therefore invalid.\n\na. Checking for overdispersion\nWhen the dispersion index is greater than 1.5, there are various explanations.\nIt may be due to :\n\nOutliers are present in the data set. They need to be eliminated.\nMissing covariates. They need to be added to the model.\nMissing interactions. Add them to the model.\nZero inflation occurs. Use negative Binomial regression with zero inflation ((Long_1997?))\nA dependency between the data and a factor or variable is present. A general linear mixed model should be used. ((Johnson_et_al_2015?))\nRelationship between data and variables or factors is not linear. A generalized additive model must be used. ((Irz_et_Levi-Valensin_2016?))\nThe link function is bad. The link function must be changed.\nThe variation of \\(Y\\) is large. We must use a generalized linear model following a negative binomial distribution. ((Chahine_1965?))\n\nIn our example, we will calculate the scale parameter. To do this, we will use the command :\n\n\nCode\n# Scale parameter calculation\nE1 &lt;- resid(mod1, type = \"pearson\") # (Y - mu) / sqrt(mu)\nN  &lt;- nrow(dataAnts)\np  &lt;- length(coef(mod1))\nsum(E1^2) / (N - p)\n\n\n[1] 1.029116\n\n\nConclusion :\nHere, dispersion is 1.02, there is no overdispersion.\n\n\nb. Residual analysis\nAlthough the assumptions of normality and homogeneity of residuals are not expected in generalized linear models, we can analyze them graphically. By plotting the residuals against the model’s significant \\(Xs\\), we need to validate the absence of a trend in their distribution. If we find a trend, the modeling may be problematic: it may be due to a lack of fit, data dependency or influential observations. Remember that in generalized linear models, we use Pearson residuals because they include heterogeneity of variance and are easy to calculate and understand.\n\n\nCode\nresid&lt;-residuals(mod1, type=\"pearson\")\n\npar(mfrow=c(3,2))\n# Histogram\nhist(resid,col='dodgerblue3',xlab=\"residuals\",main=\"A.\")\n# Quantile-Quantile plot\nqqnorm(resid,pch=16,col='dodgerblue3',xlab='', main=\"B.\")\nqqline(resid,col='red',lwd=2)\n\n# Residuals vs fitted\nplot(resid~fitted(mod1)\n      , col='dodgerblue3'\n      , pch=16, main=\"C.\")\nabline(h = 0)\n\n# Residuals against Location factor\nboxplot(resid~ dataAnts$Location, \n         varwidth = TRUE,\n         ylab = \"Residuals\",\n         xlab = \"Location\",\n         main = \"D.\")\n\n# Residuals against Latitude\nplot(resid~ dataAnts$Latitude, \n         pch=16,\n         col=\"dodgerblue3\",\n         ylab = \"Residuals\",\n         xlab = \"Latitude\",\n         main = \"E.\")\nabline(h = 0)\n\n# Residuals against Elevation\nplot(resid~ dataAnts$Elevation, \n         pch=16,\n         col=\"dodgerblue3\",\n         ylab = \"Residuals\",\n         xlab = \"Elevation\",\n         main = \"F.\")\nabline(h = 0)\n\n\n\n\n\nFigure 13: Analyse of residuals\n\n\n\n\nThe histogram of residuals (Figure 13 A) and the Q-Q plot (Figure 13 B) show relatively normal residuals. The following four graphs (Figure 13 C, D ,E and F) show the distribution of residuals according to model estimates and the three explanatory variables. We can see that the residuals remain homogeneous whatever the values of the explanatory variables.\nConclusion :\nWe can conclude there is no tendency in the residuals.\n\n\nc. Checking for influent individuals\n\n\nCode\npar(mfrow = c(1, 1))\nplot(cooks.distance(mod1), type = \"h\", ylim = c(0, 1), main=\"Figure 26\")\nabline(h = 1, col = 2,lwd = 3)\n\n\n\n\n\nFigure 14: Analyse of influent individuals\n\n\n\n\nConclusion :\nHere (Figure 14), there are no overly influential individuals.\n\n\nd. Residual analysis with DHARMa\nFor a different graphical representation, we can use the ‘DHARMa’ package. This package can be used to analyze residuals, in particular overdispersion and outliers. Residuals that do not comply with expected values are highlighted in red.\n\n\nCode\n# TestDispersion(mod1)\nlibrary(DHARMa)\nsimulationOutput &lt;- simulateResiduals(fittedModel = mod1, plot = F)\nresiduals(simulationOutput)\n\n\n [1] 0.18239618 0.80151718 0.58807555 0.91926545 0.47936926 0.80054278\n [7] 0.21988509 0.20392550 0.63926446 0.23771974 0.93979633 1.00000000\n[13] 0.55147536 0.10846697 0.10852467 0.18784519 0.67846792 0.26581684\n[19] 0.48230426 0.36551653 0.66505642 0.91389210 0.90974035 0.32702672\n[25] 0.27414285 0.55547244 0.04495447 0.01279264 0.77714308 0.53842229\n[31] 0.80358226 0.69900441 0.77700439 0.54884684 0.66172468 0.46419915\n[37] 0.30537691 0.14932406 0.82094811 0.23204016 0.13914854 0.38413168\n[43] 0.14453694 0.91036913\n\n\nCode\nplot(simulationOutput)\nresiduals(simulationOutput, quantileFunction = qnorm, outlierValues = c(-7,7))\n\n\n [1] -0.90627115  0.84705290  0.22259735  1.40014770 -0.05173666  0.84356157\n [7] -0.77258135 -0.82768134  0.35649343 -0.71365672  1.55306609  7.00000000\n[13]  0.12938973 -1.23472214 -1.23441223 -0.88586483  0.46341887 -0.62551412\n[19] -0.04437121 -0.34375165  0.42630289  1.36511850  1.33915783 -0.44813823\n[25] -0.60033094  0.13949991 -1.69587828 -2.23244931  0.76258012  0.09645977\n[31]  0.85448653  0.52153923  0.76211526  0.12274843  0.41717468 -0.08986022\n[37] -0.50899774 -1.03933681  0.91898431 -0.73214458 -1.08415273 -0.29464726\n[43] -1.06015545  1.34303160\n\n\n\n\n\nFigure 15: Dharma\n\n\n\n\n\n\nCode\n# Residuals with covariate\nplotResiduals(simulationOutput, form = dataAnts$Latitude)\n\n\n\n\n\nFigure 16: Dharma\n\n\n\n\nConclusion :\nIn our example, the residuals are not overdispersed and show no outliers (Figure 15, Figure 16).\n\n\n\n\nCONCLUSION\nThe selected model is (equation 5):\n\\[ log(Species\\:Richness) = 11.93^{***} + (Location_{Bog} = 0 ;\\:Location_{Forest} = +0.63^{***})\\:- 0.23^{***}.Latitude\\: -0.001^{***}. Elevation  \\]\nIts dispersion index is estimated at 1.02, indicating the absence of overdispersion, which validates our model.\nFurthermore, we detect no influential data points that could bias the model.\nThe estimated pseudo R² of 0.60 suggests that this model effectively explains our data (the null model deviance is 102.76, while the residual deviance is 40.69).\nWe conclude that ant species richness in the New England bogs depends on:\n\nLocation: Species richness is higher in forests than in bogs, linked to vegetation cover and available light;\nLatitude: Species richness decreases with increasing latitude;\nElevation: Although its effect is smaller, elevation also influences species richness.\n\nIn both forests and bogs, latitude is the most significant predictor of species density.\nHowever, further research on a larger scale is necessary to generalize these findings, as this study covers only a limited geographical area with two habitat types."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Statistics to explore environmental questions",
    "section": "",
    "text": "This website is produced by the M2 MODE student uring year 2024-2025 as part of their assignment in the Online Collaborative Ressources course.\nAfter a short introduction regarding the principles and the tools of a reproducible science, they have been collaborating to produce a book wich presents an example based on environmental data for different statistical examples.\nTable of Contents\n\nReproductive patterns in neotropical bats\nDeterminants of Ant Species Density\nEffects of grazing on Swedish meadows\nExploring data on Pegnuins\nAnalysis of the factors favorable to nest success of different birds species in two USA states, Wisconsin and Illinois"
  },
  {
    "objectID": "simple_chapter.html",
    "href": "simple_chapter.html",
    "title": "A simple chapter with no code",
    "section": "",
    "text": "This chapter is a simple example of qmd format"
  },
  {
    "objectID": "simple_chapter.html#subsection",
    "href": "simple_chapter.html#subsection",
    "title": "A simple chapter with no code",
    "section": "subsection",
    "text": "subsection\na list\n\nblabla\nblabla 2\nblabla 3"
  },
  {
    "objectID": "OCR_pollen.html",
    "href": "OCR_pollen.html",
    "title": "Effects of grazing on Swedish meadows",
    "section": "",
    "text": "Terrestrial ecosystems were dominated for several million years by large herbivorous mammals, which then declined at the end of the Pleistocene under the pressure of the first prehistoric human populations. The loss of these large herbivore species (aurochs, wild horses and anes, woolly rhinoceros…) was also synonymous with the loss of the ecosystem services they provided. (lundgren2020human?)\nFor several years, the “rewilding” movement has been aiming to restore these ecosystem services by reintroducing species into large European natural areas, and the present study seeks to assess the extent to which introduced herbivore species have an influence on vegetation. (garido2019experimental?)"
  },
  {
    "objectID": "OCR_pollen.html#data-visualization",
    "href": "OCR_pollen.html#data-visualization",
    "title": "Effects of grazing on Swedish meadows",
    "section": "1.Data visualization",
    "text": "1.Data visualization\n\nggplot(data=df)+\n  geom_boxplot(aes(x=treatment, y=num.species))+\n  geom_jitter(aes(x=treatment, y=num.species)) + \n  labs(x=\"Treatment\", y=\"Species richness\")\n\n\n\n\nFig 1 : Effect of grassland on species richness\n\n\n\n\nThe specific richness of grazed areas appears to be greater than in ungrazed areas @ref(fig:fig1).\n\nhyp1&lt;-lm(num.species~1,data=df)\nhyp0&lt;-lm(num.species~treatment,data=df)\nanova(hyp0,hyp1)\n\nAnalysis of Variance Table\n\nModel 1: num.species ~ treatment\nModel 2: num.species ~ 1\n  Res.Df    RSS Df Sum of Sq     F    Pr(&gt;F)    \n1    402 2280.1                                 \n2    403 2417.0 -1   -136.87 24.13 1.312e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nThe p-value is less than 0.05, so grazing has a significant effect on specific richness."
  },
  {
    "objectID": "OCR_pollen.html#choice-of-model-in-this-section-we-assume-that-grazing-treatment-depends-on-the-season-and-year-of-observation",
    "href": "OCR_pollen.html#choice-of-model-in-this-section-we-assume-that-grazing-treatment-depends-on-the-season-and-year-of-observation",
    "title": "Effects of grazing on Swedish meadows",
    "section": "2.Choice of model: in this section, we assume that grazing (treatment) depends on the season and year of observation",
    "text": "2.Choice of model: in this section, we assume that grazing (treatment) depends on the season and year of observation\n\nmodComplet&lt;-LinearModel(num.species~(treatment+season+year)*(treatment),data=df,selection = \"aic\")\nmodComplet\n\nResults for the complete model:\n==============================\nCall:\nLinearModel(formula = num.species ~ (treatment + season + year) * \n    (treatment), data = df, selection = \"aic\")\n\nResidual standard error: 2.201 on 394 degrees of freedom\nMultiple R-squared:  0.2103 \nF-statistic: 11.66 on 9 and 394 DF,  p-value: 2.732e-16 \nAIC = 647.3    BIC = 687.3\n\nResults for the model selected by AIC criterion:\n===============================================\nCall:\nLinearModel(formula = num.species ~ treatment + season + year + \n    treatment:year, data = df, selection = \"aic\")\n\nResidual standard error: 2.196 on 396 degrees of freedom\nMultiple R-squared:   0.21 \nF-statistic: 15.03 on 7 and 396 DF,  p-value: 1.95e-17 \nAIC = 643.5    BIC = 675.5\n\nFtest\n                    SS  df      MS F value    Pr(&gt;F)\ntreatment       107.32   1 107.315  22.255 3.315e-06\nseason          194.60   2  97.300  20.178 4.518e-09\nyear            133.15   2  66.575  13.806 1.599e-06\ntreatment:year   41.47   2  20.734   4.300   0.01421\nResiduals      1909.51 396   4.822                  \n\nTtest\n                                    Estimate Std. Error t value  Pr(&gt;|t|)\n(Intercept)                         8.109457   0.115553 70.1793 &lt; 2.2e-16\ntreatment - grazed                  0.525042   0.111295  4.7176 3.315e-06\ntreatment - ungrazed               -0.525042   0.111295 -4.7176 3.315e-06\nseason - autumn                    -0.857605   0.154433 -5.5532 5.150e-08\nseason - spring                     0.127684   0.179319  0.7120 0.4768541\nseason - summer                     0.729922   0.154433  4.7265 3.180e-06\nyear - 2014                         0.924700   0.178175  5.1898 3.370e-07\nyear - 2015                        -0.358379   0.154465 -2.3201 0.0208409\nyear - 2016                        -0.566321   0.154469 -3.6662 0.0002797\ntreatment - grazed : year - 2014   -0.456895   0.168272 -2.7152 0.0069130\ntreatment - ungrazed : year - 2014  0.456895   0.168272  2.7152 0.0069130\ntreatment - grazed : year - 2015    0.089175   0.151774  0.5876 0.5571677\ntreatment - ungrazed : year - 2015 -0.089175   0.151774 -0.5876 0.5571677\ntreatment - grazed : year - 2016    0.367720   0.151555  2.4263 0.0156989\ntreatment - ungrazed : year - 2016 -0.367720   0.151555 -2.4263 0.0156989\n\n\nThe results for the full model are as follows: p-value: 2.554e-16, AIC = 649, BIC = 681. However, the model chosen according to the AIC criterion shows the following results: p-value: 1.41e-17, AIC = 645.2 and BIC = 669.2. As the AIC criterion is smaller for this model than for the full model, we choose to retain: num.species ~ treatment + season + year + treatment:year. There is therefore an interaction between the pasture and its year of observation."
  },
  {
    "objectID": "OCR_pollen.html#validation-of-the-chosen-model-with-the-bartlett-test",
    "href": "OCR_pollen.html#validation-of-the-chosen-model-with-the-bartlett-test",
    "title": "Effects of grazing on Swedish meadows",
    "section": "3.Validation of the chosen model with the Bartlett test",
    "text": "3.Validation of the chosen model with the Bartlett test\n\nmodelAIC&lt;-lm(num.species~treatment+season+year+treatment:year,data=df)\n\nres&lt;-residuals(modelAIC)\nboxplot(res~treatment,data=df)\n\n\n\n\nValidation of the chosen model with the Bartlett test\n\n\n\nbartlett.test(res~treatment,data=df)\n\n\n    Bartlett test of homogeneity of variances\n\ndata:  res by treatment\nBartlett's K-squared = 1.9684, df = 1, p-value = 0.1606\n\nboxplot(res~season,data=df)\n\n\n\n\nValidation of the chosen model with the Bartlett test\n\n\n\nbartlett.test(res~season,data=df)\n\n\n    Bartlett test of homogeneity of variances\n\ndata:  res by season\nBartlett's K-squared = 4.3645, df = 2, p-value = 0.1128\n\nboxplot(res~year,data=df)\n\n\n\n\nValidation of the chosen model with the Bartlett test\n\n\n\nbartlett.test(res~year,data=df)\n\n\n    Bartlett test of homogeneity of variances\n\ndata:  res by year\nBartlett's K-squared = 3.7679, df = 2, p-value = 0.152\n\nboxplot(res~treatment:year,data=df)\n\n\n\n\nValidation of the chosen model with the Bartlett test\n\n\n\ndf$interaction &lt;- interaction(df$treatment, df$year)\nbartlett.test(res ~ interaction, data = df)\n\n\n    Bartlett test of homogeneity of variances\n\ndata:  res by interaction\nBartlett's K-squared = 6.3, df = 5, p-value = 0.2781\n\n\nFor the Bartlett tests, the p-values are all greater than 0.05, which means that homoscedasticity is respected for all our parameters, or that the variances are all equal for all our observations @ref(fig:fig2)."
  },
  {
    "objectID": "OCR_pollen.html#residual-normality-test-with-shapiro",
    "href": "OCR_pollen.html#residual-normality-test-with-shapiro",
    "title": "Effects of grazing on Swedish meadows",
    "section": "4. Residual normality test with Shapiro",
    "text": "4. Residual normality test with Shapiro\n\nhist(res,main=\"Histogramme residus\",xlab=\"Residus\")\n\n\n\n\nResidual normality test with Shapiro\n\n\n\nshapiro.test(res)\n\n\n    Shapiro-Wilk normality test\n\ndata:  res\nW = 0.99555, p-value = 0.3061\n\n\nResidual normality is respected, as our p-value is greater than 0.05: the data are compatible with a normal distribution. Our linear model is therefore valid, as residual normality is a key assumption for applying this model @ref(fig:fig3).\nConclusion:  Species richness therefore depends on grazing, season and year, as well as on the interaction grazing:year."
  },
  {
    "objectID": "OCR_pollen.html#effect-of-grazing-on-the-plant-height",
    "href": "OCR_pollen.html#effect-of-grazing-on-the-plant-height",
    "title": "Effects of grazing on Swedish meadows",
    "section": "1. Effect of grazing on the plant height",
    "text": "1. Effect of grazing on the plant height\nPotential relationship between Height and effect of treatment :\nLet’s start by representing plant size as a function of the applied treatment (grazing or no grazing) to have an idea of the possible effect.\n\nboxplot(df$logHeight.score~df$treatment, varwidth = TRUE, ylab = \"plant height (log)\", xlab = \"Treatment\", col='darkgrey', main = \"\", title = \"effect of grazing on the height\")\n\n\n\n\nEffect of treatment on height graph\n\n\n\nggplot(data=df)+\n  geom_boxplot(aes(x=treatment, y=logHeight.score))+\n  geom_jitter(aes(x=treatment, y=logHeight.score))+\n  ylab(\"Plant height (log)\") +\n  xlab(\"Treatment\")\n\n\n\n\nEffect of treatment on height graph\n\n\n\n\nInterpretation :\nThe median for the no grazing treatment is slightly higher than for the grazing treatment @ref(fig:fig4). The data also seems slightly more dispersed and spread out. So we could say that the plants without grazing are potentially higher than the ones which had the treatment.\nStatistical analysis of the relationship between Height and effect of treatment :\nWe saw earlier that there could be a potential effect of treatment on the plant’s height, we now want to know if this effect is really significant.\nWe perform an ANOVA to compare a random model with our model.\nSignificance test: Hypothesis H0: Grazing has no effect on plant height. Hypothesis H1: Grazing has an effect on plant height.\nThe p-value is 2.39e-4 &lt; 0.05. The test is significant, so hypothesis H0 is rejected. Grazing significantly reduces plant size."
  },
  {
    "objectID": "OCR_pollen.html#effect-of-grazing-on-the-seed-mass",
    "href": "OCR_pollen.html#effect-of-grazing-on-the-seed-mass",
    "title": "Effects of grazing on Swedish meadows",
    "section": "2. Effect of grazing on the seed mass",
    "text": "2. Effect of grazing on the seed mass\nNow, let’s study the seed mass of plants in relation to grazing.\nPotential relationship between seed mass and effect of treatment :\nLet’s start by representing the seed mass of plants as a function of the applied treatment (grazing or no grazing) to have an idea of the possible effect.\n\nboxplot(df$logSeedMass.score~df$treatment, varwidth = TRUE, ylab = \"Seed mass (log)\", xlab = \"Treatment\", col='darkgrey', main = \"\", title = \"effect of grazing on seed mass\")\n\n\n\n\nEffect of treatment on seed mass\n\n\n\nggplot(data=df)+\n  geom_boxplot(aes(x=treatment, y=logSeedMass.score))+\n  geom_jitter(aes(x=treatment, y=logSeedMass.score))+\n  labs(y = \"Seed mass (log)\", x = \"Treatment\")\n\n\n\n\nEffect of treatment on seed mass\n\n\n\n\nInterpretation :\nThe medians are almost identical @ref(fig:fig5). The data for the no grazing treatment also seems more dispersed and spread out. So we could say that there is potentially no effect of treatment on seed mass.\nStatistical analysis of the relationship between Height and effect of treatment :\nWe saw earlier that there could be no potential effect of treatment on seed mass. We now want to know if there is no significant difference.\nWe perform an ANOVA to compare the model where we only consider the effect of grazing with a model where the effect of grazing is random.\nSignificance test: Hypothesis H0: Grazing has no effect on seed mass. Hypothesis H1: Grazing has an effect on seed mass.\n\nhyp2&lt;-lm(logSeedMass.score~1,data=df)\nhyp3&lt;-lm(logSeedMass.score~treatment,data=df)\nanova(hyp2,hyp3)\n\nAnalysis of Variance Table\n\nModel 1: logSeedMass.score ~ 1\nModel 2: logSeedMass.score ~ treatment\n  Res.Df    RSS Df Sum of Sq      F Pr(&gt;F)\n1    403 457.54                           \n2    402 456.58  1   0.96445 0.8492 0.3573\n\n\nThe p-value = 0.3573 &gt; 0.05, so the seed mass under hypothesis H1 is not significantly different from that under hypothesis H0. We can conclude that there is no effect of grazing on seed mass."
  },
  {
    "objectID": "OCR_pollen.html#is-the-height-of-plants-only-affected-by-grazing",
    "href": "OCR_pollen.html#is-the-height-of-plants-only-affected-by-grazing",
    "title": "Effects of grazing on Swedish meadows",
    "section": "3. Is the height of plants only affected by grazing ?",
    "text": "3. Is the height of plants only affected by grazing ?\nWe will now analyze the effect of grazing on plant size more precisely. We want to know if the size is influenced by grazing (treatment) alone or by its interaction with other factors.\nFor this analysis, we will test the effects of grazing and its interaction with other factors on plant size through model analysis using the BIC criterion.\n\nhyp4&lt;-LinearModel(logHeight.score~(treatment+season+year+observer+logSeedMass.score+RatioPoll+R.score+C.score+S.score)*\n                    (treatment+season+year+observer+logSeedMass.score+RatioPoll+R.score+C.score+S.score), data=df, selection = \"bic\")\nhyp4\n\nResults for the complete model:\n==============================\nCall:\nLinearModel(formula = logHeight.score ~ (treatment + season + \n    year + observer + logSeedMass.score + RatioPoll + R.score + \n    C.score + S.score) * (treatment + season + year + observer + \n    logSeedMass.score + RatioPoll + R.score + C.score + S.score), \n    data = df, selection = \"bic\")\n\nResidual standard error: 0.6471 on 351 degrees of freedom\nMultiple R-squared:  0.8309 \nF-statistic: 33.16 on 52 and 351 DF,  p-value: 1.753e-106 \nAIC = -302.5    BIC = -90.45\n\nResults for the model selected by BIC criterion:\n===============================================\nCall:\nLinearModel(formula = logHeight.score ~ treatment + logSeedMass.score + \n    RatioPoll + R.score + C.score + S.score + treatment:logSeedMass.score + \n    treatment:RatioPoll + logSeedMass.score:R.score + logSeedMass.score:S.score + \n    RatioPoll:C.score + R.score:C.score + C.score:S.score, data = df, \n    selection = \"bic\")\n\nResidual standard error: 0.6667 on 390 degrees of freedom\nMultiple R-squared:  0.8005 \nF-statistic: 120.4 on 13 and 390 DF,  p-value: 1.368e-127 \nAIC = -313.8    BIC = -257.8\n\nFtest\n                                 SS  df     MS  F value    Pr(&gt;F)\ntreatment                     0.689   1  0.689   1.5498 0.2139129\nlogSeedMass.score             4.090   1  4.090   9.2027 0.0025783\nRatioPoll                     2.833   1  2.833   6.3736 0.0119787\nR.score                       0.024   1  0.024   0.0550 0.8147233\nC.score                      81.942   1 81.942 184.3546 &lt; 2.2e-16\nS.score                       0.018   1  0.018   0.0397 0.8420779\ntreatment:logSeedMass.score   4.390   1  4.390   9.8773 0.0018013\ntreatment:RatioPoll           3.009   1  3.009   6.7695 0.0096260\nlogSeedMass.score:R.score     6.250   1  6.250  14.0607 0.0002038\nlogSeedMass.score:S.score    11.658   1 11.658  26.2274 4.779e-07\nRatioPoll:C.score             3.110   1  3.110   6.9962 0.0084984\nR.score:C.score               4.854   1  4.854  10.9205 0.0010390\nC.score:S.score               4.599   1  4.599  10.3465 0.0014055\nResiduals                   173.347 390  0.444                   \n\nTtest\n                                           Estimate Std. Error  t value\n(Intercept)                               -2.771317   0.181401 -15.2773\ntreatment - grazed                        -0.057289   0.046019  -1.2449\ntreatment - ungrazed                       0.057289   0.046019   1.2449\nlogSeedMass.score                          0.238069   0.078477   3.0336\nRatioPoll                                 -0.073921   0.029280  -2.5246\nR.score                                    0.338994   1.445631   0.2345\nC.score                                    6.611139   0.486911  13.5777\nS.score                                   -0.272817   1.368404  -0.1994\ntreatment - grazed : logSeedMass.score    -0.118967   0.037854  -3.1428\ntreatment - ungrazed : logSeedMass.score   0.118967   0.037854   3.1428\ntreatment - grazed : RatioPoll             0.042710   0.016415   2.6018\ntreatment - ungrazed : RatioPoll          -0.042710   0.016415  -2.6018\nlogSeedMass.score : R.score                2.521365   0.672407   3.7498\nlogSeedMass.score : S.score               -3.791413   0.740326  -5.1213\nRatioPoll : C.score                        0.221980   0.083923   2.6450\nR.score : C.score                        -13.670288   4.136717  -3.3046\nC.score : S.score                         13.387882   4.162125   3.2166\n                                          Pr(&gt;|t|)\n(Intercept)                              &lt; 2.2e-16\ntreatment - grazed                       0.2139129\ntreatment - ungrazed                     0.2139129\nlogSeedMass.score                        0.0025783\nRatioPoll                                0.0119787\nR.score                                  0.8147233\nC.score                                  &lt; 2.2e-16\nS.score                                  0.8420779\ntreatment - grazed : logSeedMass.score   0.0018013\ntreatment - ungrazed : logSeedMass.score 0.0018013\ntreatment - grazed : RatioPoll           0.0096260\ntreatment - ungrazed : RatioPoll         0.0096260\nlogSeedMass.score : R.score              0.0002038\nlogSeedMass.score : S.score              4.779e-07\nRatioPoll : C.score                      0.0084984\nR.score : C.score                        0.0010390\nC.score : S.score                        0.0014055\n\n\nAfter the analysis, the final model with the lower BIC is : logH ~ treatment + logS + RatioPoll + R.score + C.score + S.score + treatment:logS + treatment:RatioPoll + logS:R.score + logS:S.score + RatioPoll:C.score + R.score:C.score + C.score:S.score\nThe results show that the factor treatment (grazing) by itself has no significant effect (p-value = 0.21 &gt; 0.05) on the height of plants and same goes for R.score and S.score. This means that the effect of treatment that we previously saw was mainly due to interactions between treatment and other factors."
  },
  {
    "objectID": "OCR_pollen.html#visualization-of-data-and-one-factor-analysis-of-variance",
    "href": "OCR_pollen.html#visualization-of-data-and-one-factor-analysis-of-variance",
    "title": "Effects of grazing on Swedish meadows",
    "section": "1. Visualization of data and one-factor analysis of variance",
    "text": "1. Visualization of data and one-factor analysis of variance\n\n# Boxplot \npar(mfrow=c(1,2))\n\n\nboxplot(df$RatioPoll~df$treatment, varwidth = TRUE, ylab = \"Ratio Pollinisation\", xlab = \"treatment\", col='blue', main = \"\")\n\n\n\n\nData visualization\n\n\n\n\nThe boxplot @ref(fig:fig6) shows no significant differences between plots grazed and those not grazed.\n\n# Anova\npoll1&lt;-lm(RatioPoll~1,data=df)\npoll2&lt;-lm(RatioPoll~treatment,data=df)\nanova(poll1,poll2)\n\nAnalysis of Variance Table\n\nModel 1: RatioPoll ~ 1\nModel 2: RatioPoll ~ treatment\n  Res.Df    RSS Df Sum of Sq      F  Pr(&gt;F)  \n1    403 2956.5                              \n2    402 2931.7  1    24.786 3.3987 0.06598 .\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nThe P-value is not significant at the 5% threshold, so we reject the hypothesis that grazing has an effect on the RatioPoll. The Anova test confirms our graphical observation: there is no difference between the grazed and natural plots."
  },
  {
    "objectID": "OCR_pollen.html#model-test",
    "href": "OCR_pollen.html#model-test",
    "title": "Effects of grazing on Swedish meadows",
    "section": "2.Model test",
    "text": "2.Model test\n\npoll3&lt;-LinearModel(RatioPoll~(treatment+season+year+observer+R.score+S.score+C.score)*\n                     (treatment+season+year+observer+R.score+S.score+C.score),data=df,selection = \"aic\")\npoll3\n\nResults for the complete model:\n==============================\nCall:\nLinearModel(formula = RatioPoll ~ (treatment + season + year + \n    observer + R.score + S.score + C.score) * (treatment + season + \n    year + observer + R.score + S.score + C.score), data = df, \n    selection = \"aic\")\n\nResidual standard error: 2.562 on 370 degrees of freedom\nMultiple R-squared:  0.1787 \nF-statistic: 2.439 on 33 and 370 DF,  p-value: 3.229e-05 \nAIC = 792.6    BIC = 928.6\n\nResults for the model selected by AIC criterion:\n===============================================\nCall:\nLinearModel(formula = RatioPoll ~ treatment + season + year + \n    R.score + S.score + C.score + treatment:R.score + treatment:C.score + \n    season:R.score + season:S.score + year:R.score + year:C.score + \n    R.score:C.score + S.score:C.score, data = df, selection = \"aic\")\n\nResidual standard error: 2.537 on 383 degrees of freedom\nMultiple R-squared:  0.1662 \nF-statistic: 3.816 on 20 and 383 DF,  p-value: 1.16e-07 \nAIC = 772.7    BIC = 856.7\n\nFtest\n                       SS  df     MS F value   Pr(&gt;F)\ntreatment            0.46   1  0.463  0.0719 0.788707\nseason              37.94   2 18.970  2.9472 0.053681\nyear                11.28   2  5.640  0.8762 0.417215\nR.score             32.37   1 32.371  5.0291 0.025497\nS.score              2.80   1  2.803  0.4354 0.509748\nC.score              0.00   1  0.001  0.0002 0.990072\ntreatment:R.score   52.95   1 52.954  8.2269 0.004356\ntreatment:C.score   65.29   1 65.287 10.1429 0.001567\nseason:R.score      31.54   2 15.770  2.4500 0.087647\nseason:S.score      24.73   2 12.366  1.9211 0.147854\nyear:R.score        43.06   2 21.532  3.3451 0.036290\nyear:C.score        26.21   2 13.107  2.0362 0.131930\nR.score:C.score     28.24   1 28.243  4.3878 0.036853\nS.score:C.score     19.80   1 19.804  3.0767 0.080223\nResiduals         2465.27 383  6.437                 \n\nTtest\n                                 Estimate Std. Error t value Pr(&gt;|t|)\n(Intercept)                      0.216628   0.554131  0.3909 0.696064\ntreatment - grazed               0.100399   0.374374  0.2682 0.788707\ntreatment - ungrazed            -0.100399   0.374374 -0.2682 0.788707\nseason - autumn                 -0.982083   0.406102 -2.4183 0.016058\nseason - spring                  0.456660   0.475236  0.9609 0.337202\nseason - summer                  0.525422   0.455257  1.1541 0.249170\nyear - 2014                      0.748663   0.571102  1.3109 0.190674\nyear - 2015                     -0.303283   0.479913 -0.6320 0.527794\nyear - 2016                     -0.445380   0.480008 -0.9279 0.354064\nR.score                         12.133698   5.410655  2.2426 0.025497\nS.score                         -3.199071   4.848189 -0.6598 0.509748\nC.score                          0.025179   2.022135  0.0125 0.990072\ntreatment - grazed : R.score     6.020273   2.098934  2.8683 0.004356\ntreatment - ungrazed : R.score  -6.020273   2.098934 -2.8683 0.004356\ntreatment - grazed : C.score    -3.909367   1.227511 -3.1848 0.001567\ntreatment - ungrazed : C.score   3.909367   1.227511  3.1848 0.001567\nseason - autumn : R.score        5.258101   2.401900  2.1891 0.029190\nseason - spring : R.score       -2.739087   3.015881 -0.9082 0.364332\nseason - summer : R.score       -2.519015   2.651050 -0.9502 0.342612\nseason - autumn : S.score        4.873384   3.018905  1.6143 0.107288\nseason - spring : S.score       -6.191616   3.371962 -1.8362 0.067102\nseason - summer : S.score        1.318232   2.969647  0.4439 0.657364\nyear - 2014 : R.score           -7.443157   3.103236 -2.3985 0.016939\nyear - 2015 : R.score            2.072046   2.435265  0.8509 0.395384\nyear - 2016 : R.score            5.371111   2.368027  2.2682 0.023874\nyear - 2014 : C.score            2.467530   1.456367  1.6943 0.091020\nyear - 2015 : C.score           -0.196500   1.156556 -0.1699 0.865178\nyear - 2016 : C.score           -2.271030   1.181944 -1.9214 0.055419\nR.score : C.score              -35.308042  16.855766 -2.0947 0.036853\nS.score : C.score               26.694777  15.219008  1.7540 0.080223\n\n\nThe model proposed by R does have a lower BIC than our initial model. However, some of the interactions retained by R have no significant effect. We decided to test a model without these interactions."
  },
  {
    "objectID": "OCR_pollen.html#model-adjustment",
    "href": "OCR_pollen.html#model-adjustment",
    "title": "Effects of grazing on Swedish meadows",
    "section": "3.Model adjustment",
    "text": "3.Model adjustment\n\npoll4&lt;-lm(RatioPoll~( treatment + season + year + \n    observer + R.score + S.score + C.score + treatment:R.score + \n    treatment:C.score + year:C.score + \n    observer:R.score + R.score:C.score),data=df)\nsummary(poll4)\n\n\nCall:\nlm(formula = RatioPoll ~ (treatment + season + year + observer + \n    R.score + S.score + C.score + treatment:R.score + treatment:C.score + \n    year:C.score + observer:R.score + R.score:C.score), data = df)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-4.5392 -1.1080 -0.4220  0.2947 29.6572 \n\nCoefficients: (1 not defined because of singularities)\n                           Estimate Std. Error t value Pr(&gt;|t|)   \n(Intercept)                 1.09759    1.02902   1.067  0.28680   \ntreatmentungrazed          -0.44174    0.74260  -0.595  0.55229   \nseasonspring               -0.87180    0.35892  -2.429  0.01559 * \nseasonsummer                0.07737    0.30486   0.254  0.79979   \nyear2015                   -1.02099    0.89211  -1.144  0.25313   \nyear2016                   -0.67267    0.91384  -0.736  0.46212   \nobserverB                        NA         NA      NA       NA   \nR.score                     4.06738    6.16403   0.660  0.50974   \nS.score                     4.06607    2.32128   1.752  0.08062 . \nC.score                     0.06155    3.33199   0.018  0.98527   \ntreatmentungrazed:R.score -11.89261    4.19861  -2.833  0.00486 **\ntreatmentungrazed:C.score   7.72917    2.47671   3.121  0.00194 **\nyear2015:C.score           -3.34651    2.37134  -1.411  0.15898   \nyear2016:C.score           -5.55088    2.36817  -2.344  0.01958 * \nobserverB:R.score          10.16478    4.53211   2.243  0.02547 * \nR.score:C.score           -11.47597   14.17758  -0.809  0.41875   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.582 on 389 degrees of freedom\nMultiple R-squared:  0.123, Adjusted R-squared:  0.09146 \nF-statistic: 3.898 on 14 and 389 DF,  p-value: 2.989e-06\n\n\nWe have observed that the R.score:C.score interaction is not significant, we test a new model without it.\n\npoll5&lt;-lm(RatioPoll~( treatment + season + year + \n    observer + R.score + S.score + C.score + treatment:R.score + \n    treatment:C.score + year:C.score + \n    observer:R.score ),data=df)\nsummary(poll5)\n\n\nCall:\nlm(formula = RatioPoll ~ (treatment + season + year + observer + \n    R.score + S.score + C.score + treatment:R.score + treatment:C.score + \n    year:C.score + observer:R.score), data = df)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-4.1056 -1.0829 -0.3976  0.2776 29.5917 \n\nCoefficients: (1 not defined because of singularities)\n                          Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)                 1.5512     0.8627   1.798  0.07294 .  \ntreatmentungrazed          -0.6179     0.7097  -0.871  0.38443    \nseasonspring               -0.8549     0.3582  -2.387  0.01746 *  \nseasonsummer                0.0786     0.3047   0.258  0.79658    \nyear2015                   -1.1152     0.8841  -1.261  0.20794    \nyear2016                   -0.7649     0.9063  -0.844  0.39919    \nobserverB                       NA         NA      NA       NA    \nR.score                     0.9309     4.7917   0.194  0.84607    \nS.score                     4.3275     2.2977   1.883  0.06039 .  \nC.score                    -1.8351     2.3679  -0.775  0.43881    \ntreatmentungrazed:R.score -12.5848     4.1088  -3.063  0.00234 ** \ntreatmentungrazed:C.score   8.7848     2.1046   4.174 3.69e-05 ***\nyear2015:C.score           -3.1669     2.3599  -1.342  0.18039    \nyear2016:C.score           -5.3600     2.3554  -2.276  0.02341 *  \nobserverB:R.score          10.4201     4.5191   2.306  0.02165 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.581 on 390 degrees of freedom\nMultiple R-squared:  0.1215,    Adjusted R-squared:  0.09227 \nF-statistic: 4.151 on 13 and 390 DF,  p-value: 1.82e-06\n\n\nThe p-value of S.score is not significant and does not appear in any significant interactions. We therefore decide to remove it\n\npoll6&lt;-lm(RatioPoll~( treatment + season + year + \n    observer + R.score + C.score + treatment:R.score + \n    treatment:C.score + year:C.score + \n    observer:R.score ),data=df)\nsummary(poll6)\n\n\nCall:\nlm(formula = RatioPoll ~ (treatment + season + year + observer + \n    R.score + C.score + treatment:R.score + treatment:C.score + \n    year:C.score + observer:R.score), data = df)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-4.3524 -1.1314 -0.4478  0.2407 29.8179 \n\nCoefficients: (1 not defined because of singularities)\n                          Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)                 1.7220     0.8607   2.001  0.04612 *  \ntreatmentungrazed          -0.5616     0.7113  -0.789  0.43034    \nseasonspring               -0.7979     0.3580  -2.229  0.02641 *  \nseasonsummer                0.1205     0.3049   0.395  0.69286    \nyear2015                   -1.1891     0.8861  -1.342  0.18038    \nyear2016                   -0.8061     0.9090  -0.887  0.37575    \nobserverB                       NA         NA      NA       NA    \nR.score                     1.2011     4.8051   0.250  0.80275    \nC.score                    -0.8569     2.3177  -0.370  0.71179    \ntreatmentungrazed:R.score -11.2879     4.0639  -2.778  0.00574 ** \ntreatmentungrazed:C.score   8.3717     2.1000   3.987    8e-05 ***\nyear2015:C.score           -3.6014     2.3562  -1.528  0.12721    \nyear2016:C.score           -5.9907     2.3390  -2.561  0.01081 *  \nobserverB:R.score          11.4602     4.4998   2.547  0.01125 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.589 on 391 degrees of freedom\nMultiple R-squared:  0.1136,    Adjusted R-squared:  0.08635 \nF-statistic: 4.174 on 12 and 391 DF,  p-value: 3.488e-06"
  },
  {
    "objectID": "OCR_pollen.html#validity-of-the-chosen-model",
    "href": "OCR_pollen.html#validity-of-the-chosen-model",
    "title": "Effects of grazing on Swedish meadows",
    "section": "4. Validity of the chosen model",
    "text": "4. Validity of the chosen model\nNow,we want to check the normality of residuals\n\npollfinal&lt;-lm(RatioPoll~(treatment + season + year + \n    observer + R.score + C.score + treatment:R.score + \n    treatment:C.score + year:C.score + \n    observer:R.score ),data=df)\nres&lt;-residuals(pollfinal)\nhist(res,main=\"Histogram residuals\",xlab=\"Residus\")\n\n\n\n\nCheck of the normality of residuals\n\n\n\nshapiro.test(res)\n\n\n    Shapiro-Wilk normality test\n\ndata:  res\nW = 0.58302, p-value &lt; 2.2e-16\n\n\nThe residuals are not normally distributed @ref(fig:fig7). We’re going to try and do some transformations using log and sqrt.\n\npoll7&lt;-lm(log(RatioPoll+1)~(treatment + season + year + \n    observer + R.score + C.score + treatment:R.score + \n    treatment:C.score + year:C.score + \n    observer:R.score ),data=df )\nsummary(poll7)\n\n\nCall:\nlm(formula = log(RatioPoll + 1) ~ (treatment + season + year + \n    observer + R.score + C.score + treatment:R.score + treatment:C.score + \n    year:C.score + observer:R.score), data = df)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-0.8616 -0.3817 -0.1199  0.2218  2.8725 \n\nCoefficients: (1 not defined because of singularities)\n                          Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)                0.54228    0.18640   2.909 0.003830 ** \ntreatmentungrazed         -0.07940    0.15406  -0.515 0.606579    \nseasonspring              -0.24842    0.07754  -3.204 0.001467 ** \nseasonsummer               0.05885    0.06603   0.891 0.373370    \nyear2015                  -0.30506    0.19190  -1.590 0.112717    \nyear2016                  -0.19844    0.19686  -1.008 0.314073    \nobserverB                       NA         NA      NA       NA    \nR.score                    2.37006    1.04064   2.277 0.023296 *  \nC.score                   -0.80696    0.50195  -1.608 0.108721    \ntreatmentungrazed:R.score -3.21826    0.88011  -3.657 0.000290 ***\ntreatmentungrazed:C.score  1.65481    0.45479   3.639 0.000311 ***\nyear2015:C.score           0.16798    0.51029   0.329 0.742186    \nyear2016:C.score          -0.42087    0.50656  -0.831 0.406573    \nobserverB:R.score          1.51327    0.97453   1.553 0.121276    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.5607 on 391 degrees of freedom\nMultiple R-squared:  0.1889,    Adjusted R-squared:  0.164 \nF-statistic: 7.588 on 12 and 391 DF,  p-value: 1.16e-12\n\n\nThe p-value of the shapiro test is still less than 0.05, so the residuals are still not normally distributed @ref(fig:fig8).\n\npoll7&lt;-LinearModel(sqrt(RatioPoll)~( season + C.score + treatment:R.score + \n    treatment:C.score + year:C.score ),data=df)\npoll7\n\n\nCall:\nLinearModel(formula = sqrt(RatioPoll) ~ (season + C.score + treatment:R.score + \n    treatment:C.score + year:C.score), data = df)\n\nResidual standard error: 0.7061 on 395 degrees of freedom\nMultiple R-squared:  0.1748 \nF-statistic: 10.46 on 8 and 395 DF,  p-value: 2.525e-13 \nAIC = -272.2    BIC = -236.2\n\nFtest\n                       SS  df      MS F value    Pr(&gt;F)\nseason              7.389   2  3.6947  7.4097 0.0006932\nC.score             0.001   1  0.0009  0.0019 0.9655856\ntreatment:R.score  23.467   2 11.7333 23.5310 2.213e-10\nC.score:treatment   6.411   1  6.4105 12.8562 0.0003785\nC.score:year        1.769   2  0.8846  1.7741 0.1709912\nResiduals         196.959 395  0.4986                  \n\nTtest\n                      Estimate Std. Error t value  Pr(&gt;|t|)\n(Intercept)           0.401349   0.094246  4.2585 2.574e-05\nseason - autumn       0.069439   0.050345  1.3793 0.1685968\nseason - spring      -0.213646   0.057100 -3.7416 0.0002099\nseason - summer       0.144207   0.050304  2.8667 0.0043695\nC.score              -0.011798   0.273266 -0.0432 0.9655856\ntreatment - grazed    4.700511   0.687383  6.8383 3.058e-11\ntreatment - ungrazed -4.700511   0.687383 -6.8383 3.058e-11\nR.score               0.349497   0.643971  0.5427 0.5876277\nyear - 2014          -0.912854   0.254592 -3.5856 0.0003785\nyear - 2015           0.246445   0.192734  1.2787 0.2017603\nyear - 2016           0.666409   0.266422  2.5013 0.0127768\n\npollfinal&lt;-lm(sqrt(RatioPoll)~( season + C.score + treatment:R.score + \n    treatment:C.score + year:C.score ),data=df)\nres&lt;-residuals(pollfinal)\nhist(res,main=\"Histogram residuals\",xlab=\"Residus\")\n\n\n\n\nTransformed residuals histogram\n\n\n\nshapiro.test(res)\n\n\n    Shapiro-Wilk normality test\n\ndata:  res\nW = 0.87207, p-value &lt; 2.2e-16\n\n\nConclusion:  We cannot evaluate the impact of grazing on the pollination strategy of plants because the constraints of the general linear model are not respected. In addition, we cannot apply a generalized linear model given the type and values of our data."
  }
]