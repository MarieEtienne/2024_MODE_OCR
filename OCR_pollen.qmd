---
title: "Effets du pâturage sur les prairies suédoises"
group: "Bastien, Elia, Caroline, Alexia, Marine, Lily, Julie" 
>>>>>>> 75e9da09555ae3bad45e7f54a26d7c51188f42d7

bibliography: references.bib
execute: 
  freeze: auto
output: 
  html_document:
   toc: true
   toc_float: true
---

This chapter is a simple example using R

You can import R package using the code

```{r}
library(tidyverse)
library(FactoMineR)
library(dplyr)
```


and then describe the purpose of your chapter as well as executing R command.


For example a basic summary of a dataset is given by 

```{r}
df <- read.table("pollen.csv", sep = ";" , header = TRUE)
```

and produce a graph

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                      PARTIE 1 : Effet du paturage sur la richesse specifique
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

# Visualisation des donnees
```{r}
ggplot(data=df)+
  geom_boxplot(aes(x=treatment, y=num.species))+
  geom_jitter(aes(x=treatment, y=num.species)) + 
  labs(x="Treatment", y="Species richness") +
  ggtitle('Effect of grassland on species richness')
```
La richesse specifique des zones paturees semble etre plus importante que dans les zones non paturees. 

```{r}
hyp1<-lm(num.species~1,data=df)
hyp0<-lm(num.species~treatment,data=df)
anova(hyp0,hyp1)
```
La p-value est inferieure a 0,05 donc le paturage a un effet significatif sur la richesse specifique. 

# Choix du modele : dans cette partie, nous considerons que le paturage (treatment) depend de la saison et de l'annee d'observation. 

```{r}
modComplet<-LinearModel(num.species~(treatment+season+year)*(treatment),data=df,selection = "aic")
modComplet
```
Les resultats pour le modele complet sont les suivants : p-value: 2.554e-16, AIC = 649, BIC = 681
Cependant, le modele choisi selon le critere AIC montre les resultats suivants : p-value: 1.41e-17, 
AIC = 645.2 et BIC = 669.2. Le critere AIC etant plus petit pour ce modele que le modele complet, on choisit
de conserver : num.species ~ treatment + season + year + treatment:year. Il y a donc interaction entre le paturage et son annee d'observation.   

# Validation du modele choisi avec le test de Bartlett
```{r}
modelAIC<-lm(num.species~treatment+season+year+treatment:year,data=df)

res<-residuals(modelAIC)
boxplot(res~treatment,data=df)
bartlett.test(res~treatment,data=df)

boxplot(res~season,data=df)
bartlett.test(res~season,data=df)

boxplot(res~year,data=df)
bartlett.test(res~year,data=df)

boxplot(res~treatment:year,data=df)
df$interaction <- interaction(df$treatment, df$year)
bartlett.test(res ~ interaction, data = df)
```
Pour les tests de Bartlett, les p-value sont toutes supérieures à 0.05, ce qui veut dire que l'homoscédasticité est respectée pour tous nos parametres soit que les variances sont toutes egales pour toutes nos observations.

#Test normalité des résidus avec Shapiro.
hist(res,main="Histogramme residus",xlab="Residus")
shapiro.test(res)

La normalite des residus est respectee car notre p-value est superieure a 0,05 : les donnees sont compatibles avec une distribution normale. Notre modele lineaire est donc valide car la normalite des residus est une hypothese cle pour appliquer ce modele.

A citation @bauer2023writing
