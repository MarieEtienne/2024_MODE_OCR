---
title: "Effets du pâturage sur les prairies suédoises"
author: "Bastien, Elia, Caroline, Alexia, Marine, Lily, Julie" 
bibliography: references.bib
execute: 
  freeze: auto
output: 
  html_document:
   toc: true
   toc_float: true
---

Les ecosystemes terrestres ont ete domines pendant plusieurs millions d'annees par les grands mammiferes herbivores, qui ont ensuite decline à la fin du Pleistocene sous la pression des premieres populations humaines prehistoriques. La perte de ces especes de grands herbivores (aurochs, chevaux et anes sauvages, rhinoceros laineux...) a egalement ete synonyme de la perte des services ecosystemiques qu'ils apportaient. (https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7148574/)

Depuis plusieurs annees, le courant du reensauvagement ("rewilding" en anglais) a pour but de restaurer ces services ecosytemique en reintroduisant des especes dans les grands espaces naturels europeens.L'etude presente cherche a evaluer dans quelle mesure les especes d'herbivores introduites ont une influence sur la vegetation. (https://besjournals.onlinelibrary.wiley.com/doi/10.1111/1365-2664.13338)


PRESENTATION DE L'EXPERIENCE

Blabla sur l'experience



Effet du paturage sur la richesse specifique
```{r}
<<<<<<< HEAD
df %>% ggplot(data = df) + 
```


Partie 2 : effet du paturage sur la morphologie des plantes

Nous pouvons tout d'abord effectuer une observation graphique des donnees.

#Taille
Commencons par representer la taille des plantes en fonction du paturage.

```{r}
boxplot(df$logHeight.score~df$?..treatment, varwidth = TRUE, ylab = "LogH", xlab = "Treatment", col='darkgrey', main = "", title = "effet du p?turage sur la hauteur")

ggplot(data=df)+
  geom_boxplot(aes(x=?..treatment, y=logHeight.score))+
  geom_jitter(aes(x=?..treatment, y=logHeight.score))
```

#Masse
Etudions a present la masse des graines des plantes en fonction du paturage.

```{r}
boxplot(df$logSeedMass.score~df$?..treatment, varwidth = TRUE, ylab = "LogS", xlab = "Treatment", col='darkgrey', main = "", title = "effet du paturage sur la masse des graines")

ggplot(data=df)+
  geom_boxplot(aes(x=?..treatment, y=logSeedMass.score))+
  geom_jitter(aes(x=?..treatment, y=logSeedMass.score))
```



PARTIE 3: GRAZINF EFFECT ON POLLINISATION STRATEGIES 

Data importation

```{r pollen_read_data}
df <- read_delim("pollen.csv", delim = ";", 
    escape_double = FALSE, trim_ws = TRUE)
```



```{r}
# renommer la premiere colonne pour Marine et Alexia car var treatment est ?..treatment et pose pblm
names(df)[1] <- "treatment"
names(df)
```

```{r}
# Boxplot 
par(mfrow=c(1,2))

boxplot(df$RatioPoll~df$?..treatment, varwidth = TRUE, ylab = "Ratio Pollinisation", xlab = "treatment", col='blue', main = "")

```


The boxplot shows no significant differences between plots grazed and those not grazed.

```{r}
# Anova
poll1<-lm(RatioPoll~1,data=df)
poll2<-lm(RatioPoll~treatment,data=df)
anova(poll1,poll2)
```

The P-value is not significant at the 5% threshold, so we reject the hypothesis that grazing has an effect on the RatioPoll. The Anova test confirms our graphical observation: there is no difference between the grazed and natural plots.

```{r}
poll3<-LinearModel(RatioPoll~(treatment+season+year+observer+R.score+S.score+C.score)*
                     (treatment+season+year+observer+R.score+S.score+C.score),data=df,selection = "aic")
poll3
```

The model proposed by R does have a lower BIC than our initial model. However, some of the interactions retained by R have no significant effect. We decided to test a model without these interactions. 

```{r}
poll4<-LinearModel(RatioPoll~( treatment + season + year + 
    observer + R.score + S.score + C.score + treatment:R.score + 
    treatment:C.score + year:C.score + 
    observer:R.score + R.score:C.score),data=df)
poll4
```
We have observed that the R.score:C.score interaction is not significant, we test a new model without it.
```{r}
poll5<-LinearModel(RatioPoll~( treatment + season + year + 
    observer + R.score + S.score + C.score + treatment:R.score + 
    treatment:C.score + year:C.score + 
    observer:R.score ),data=df)
poll5
```
We delete R.score because it is the less significant.

```{r}
poll6<-LinearModel(RatioPoll~( season + C.score + treatment:R.score + 
    treatment:C.score + year:C.score ),data=df)
poll6
```

