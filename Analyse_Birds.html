<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Rudy, Tanguy, Manon, Garan, AnaÃ«lle, Oceane, Victor">

<title>The Companion book a M1 MODE student should have! - Analysis of the Factors Favorable to Nest Success of Different Bird Species in Two USA States, Wisconsin and Illinois</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">The Companion book a M1 MODE student should have!</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://marieetienne.github.io/MODE_reproduciblescience/" rel="" target=""><i class="bi bi-home" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/MarieEtienne/2024_MODE_OCR" rel="" target=""><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://marieetienne.github.io/MODE_reproduciblescience/instructions.html" rel="" target="">
 <span class="menu-text">Instructions</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-courses-materials" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Courses Materials</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-courses-materials">    
        <li>
    <a class="dropdown-item" href="https://marieetienne.github.io/reproductibilite/_presentation/english_version.html" rel="" target="">
 <span class="dropdown-text">Git Intro</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-book-content" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Book content</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-book-content">    
        <li>
    <a class="dropdown-item" href="./fichier_r.html" rel="" target="">
 <span class="dropdown-text">Reproductive patterns in neotropical bats</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./Determinants_ant_diversity.html" rel="" target="">
 <span class="dropdown-text">Determinants of Ant Species Density</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./OCR_pollen.html" rel="" target="">
 <span class="dropdown-text">Effects of grazing on Swedish meadows</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./Analyse_Birds.html" rel="" target="">
 <span class="dropdown-text">Nest success of different birds specie</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./Penguins_chapter.html" rel="" target="">
 <span class="dropdown-text">Penguins Exploration</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#data-presentation" id="toc-data-presentation" class="nav-link active" data-scroll-target="#data-presentation">Data presentation</a></li>
  <li><a href="#what-kind-of-questions-can-we-rise" id="toc-what-kind-of-questions-can-we-rise" class="nav-link" data-scroll-target="#what-kind-of-questions-can-we-rise">What kind of questions can we rise ?</a></li>
  <li><a href="#first-look-at-the-data" id="toc-first-look-at-the-data" class="nav-link" data-scroll-target="#first-look-at-the-data">First look at the data :</a></li>
  <li><a href="#data-exploration" id="toc-data-exploration" class="nav-link" data-scroll-target="#data-exploration"><u>1. Data exploration</u></a>
  <ul class="collapse">
  <li><a href="#repartition-of-the-data-through-time" id="toc-repartition-of-the-data-through-time" class="nav-link" data-scroll-target="#repartition-of-the-data-through-time">Repartition of the data through time</a></li>
  </ul></li>
  <li><a href="#ii.-analysing-the-relationship-between-nest-fate-and-county-habitat-species-year-initiation-date-using-a-generalized-linear-model-glm-with-a-binomial-distribution" id="toc-ii.-analysing-the-relationship-between-nest-fate-and-county-habitat-species-year-initiation-date-using-a-generalized-linear-model-glm-with-a-binomial-distribution" class="nav-link" data-scroll-target="#ii.-analysing-the-relationship-between-nest-fate-and-county-habitat-species-year-initiation-date-using-a-generalized-linear-model-glm-with-a-binomial-distribution">II. Analysing the relationship between nest fate and county, habitat, species, year, initiation date using a generalized linear model (GLM) with a binomial distribution</a>
  <ul class="collapse">
  <li><a href="#a.-data-exploration" id="toc-a.-data-exploration" class="nav-link" data-scroll-target="#a.-data-exploration">A. Data Exploration</a>
  <ul class="collapse">
  <li><a href="#outlier-in-y" id="toc-outlier-in-y" class="nav-link" data-scroll-target="#outlier-in-y">Outlier in <span class="math inline">\(Y\)</span></a></li>
  <li><a href="#for-quantitative-xs-outlier-and-distribution-of-x-values" id="toc-for-quantitative-xs-outlier-and-distribution-of-x-values" class="nav-link" data-scroll-target="#for-quantitative-xs-outlier-and-distribution-of-x-values">For quantitative Xs : outlier and distribution of <span class="math inline">\(X\)</span> values</a></li>
  <li><a href="#for-each-qualitative-explanatory-variable-x-modalities-and-number-of-individuals-for-each-of-them" id="toc-for-each-qualitative-explanatory-variable-x-modalities-and-number-of-individuals-for-each-of-them" class="nav-link" data-scroll-target="#for-each-qualitative-explanatory-variable-x-modalities-and-number-of-individuals-for-each-of-them">For each qualitative explanatory variable <span class="math inline">\(X\)</span> : Modalities and number of individuals for each of them</a></li>
  <li><a href="#relationships-between-y-and-xs" id="toc-relationships-between-y-and-xs" class="nav-link" data-scroll-target="#relationships-between-y-and-xs">Relationships between Y and Xs ?</a></li>
  <li><a href="#analysing-interaction-between-xs" id="toc-analysing-interaction-between-xs" class="nav-link" data-scroll-target="#analysing-interaction-between-xs">Analysing interaction between Xs</a></li>
  <li><a href="#checking-collinearity-between-xs" id="toc-checking-collinearity-between-xs" class="nav-link" data-scroll-target="#checking-collinearity-between-xs">Checking collinearity between <span class="math inline">\(Xs\)</span></a></li>
  </ul></li>
  <li><a href="#b.-statistical-analysis" id="toc-b.-statistical-analysis" class="nav-link" data-scroll-target="#b.-statistical-analysis">B. Statistical Analysis</a>
  <ul class="collapse">
  <li><a href="#model-building-up" id="toc-model-building-up" class="nav-link" data-scroll-target="#model-building-up">Model building up</a></li>
  <li><a href="#model-coefficient-and-its-equation" id="toc-model-coefficient-and-its-equation" class="nav-link" data-scroll-target="#model-coefficient-and-its-equation">Model coefficient and its equation</a></li>
  <li><a href="#explanation-provided-by-the-model" id="toc-explanation-provided-by-the-model" class="nav-link" data-scroll-target="#explanation-provided-by-the-model">Explanation provided by the model</a></li>
  </ul></li>
  <li><a href="#c.-model-validation" id="toc-c.-model-validation" class="nav-link" data-scroll-target="#c.-model-validation">C. Model validation</a>
  <ul class="collapse">
  <li><a href="#checking-for-influential-individuals" id="toc-checking-for-influential-individuals" class="nav-link" data-scroll-target="#checking-for-influential-individuals">Checking for influential individuals</a></li>
  <li><a href="#prediction-with-different-data" id="toc-prediction-with-different-data" class="nav-link" data-scroll-target="#prediction-with-different-data">Prediction with different data</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#iii.-analysing-the-relationship-between-nest-fate-and-county-habitat-species-year-initiation-date-using-a-generalized-linear-model-glm-with-a-poisson-distribution" id="toc-iii.-analysing-the-relationship-between-nest-fate-and-county-habitat-species-year-initiation-date-using-a-generalized-linear-model-glm-with-a-poisson-distribution" class="nav-link" data-scroll-target="#iii.-analysing-the-relationship-between-nest-fate-and-county-habitat-species-year-initiation-date-using-a-generalized-linear-model-glm-with-a-poisson-distribution">III. Analysing the relationship between nest fate and county, habitat, species, year, initiation date using a generalized linear model (GLM) with a Poisson distribution</a>
  <ul class="collapse">
  <li><a href="#variables-presentation" id="toc-variables-presentation" class="nav-link" data-scroll-target="#variables-presentation">Variables presentation:</a></li>
  <li><a href="#a.-data-exploration-1" id="toc-a.-data-exploration-1" class="nav-link" data-scroll-target="#a.-data-exploration-1">A. Data exploration</a>
  <ul class="collapse">
  <li><a href="#outlayer-values-in-the-response-variable-y-the-number-of-young-in-the-nest-number_fledged-and-values-distribution" id="toc-outlayer-values-in-the-response-variable-y-the-number-of-young-in-the-nest-number_fledged-and-values-distribution" class="nav-link" data-scroll-target="#outlayer-values-in-the-response-variable-y-the-number-of-young-in-the-nest-number_fledged-and-values-distribution">Outlayer values in the response variable <span class="math inline">\(Y\)</span> (the number of young in the nest, Number_Fledged) and values distribution:</a></li>
  <li><a href="#outlayer-values-in-the-explanatory-variable-xs-and-values-distribution" id="toc-outlayer-values-in-the-explanatory-variable-xs-and-values-distribution" class="nav-link" data-scroll-target="#outlayer-values-in-the-explanatory-variable-xs-and-values-distribution">Outlayer values in the explanatory variable <span class="math inline">\(Xs\)</span> and values distribution:</a></li>
  <li><a href="#analyze-the-relation-between-y-and-xs" id="toc-analyze-the-relation-between-y-and-xs" class="nav-link" data-scroll-target="#analyze-the-relation-between-y-and-xs">Analyze the relation between Y and Xs</a></li>
  <li><a href="#analyze-the-interactions-between-xs" id="toc-analyze-the-interactions-between-xs" class="nav-link" data-scroll-target="#analyze-the-interactions-between-xs">Analyze the interactions between Xs</a></li>
  <li><a href="#checking-collinearity-between-categorical-independent-variables-xs" id="toc-checking-collinearity-between-categorical-independent-variables-xs" class="nav-link" data-scroll-target="#checking-collinearity-between-categorical-independent-variables-xs">Checking collinearity between categorical independent variables Xs:</a></li>
  </ul></li>
  <li><a href="#b.-statistical-analysis-1" id="toc-b.-statistical-analysis-1" class="nav-link" data-scroll-target="#b.-statistical-analysis-1">B. Statistical Analysis</a></li>
  <li><a href="#building-of-the-model" id="toc-building-of-the-model" class="nav-link" data-scroll-target="#building-of-the-model">Building of the model</a></li>
  <li><a href="#c.-model-validation-1" id="toc-c.-model-validation-1" class="nav-link" data-scroll-target="#c.-model-validation-1">C. Model validation:</a></li>
  <li><a href="#conclusions" id="toc-conclusions" class="nav-link" data-scroll-target="#conclusions">Conclusions:</a></li>
  </ul></li>
  <li><a href="#iv.-anova" id="toc-iv.-anova" class="nav-link" data-scroll-target="#iv.-anova">IV. ANOVA</a>
  <ul class="collapse">
  <li><a href="#outliers-in-y-and-distribution-of-values-of-y" id="toc-outliers-in-y-and-distribution-of-values-of-y" class="nav-link" data-scroll-target="#outliers-in-y-and-distribution-of-values-of-y">Outliers in <span class="math inline">\(Y\)</span> and distribution of values of <span class="math inline">\(Y\)</span></a></li>
  <li><a href="#outliers-and-distribution-of-the-values-of-x" id="toc-outliers-and-distribution-of-the-values-of-x" class="nav-link" data-scroll-target="#outliers-and-distribution-of-the-values-of-x">Outliers and distribution of the values of <span class="math inline">\(X\)</span></a></li>
  <li><a href="#removal-of-poorly-represented-modalities-10-data" id="toc-removal-of-poorly-represented-modalities-10-data" class="nav-link" data-scroll-target="#removal-of-poorly-represented-modalities-10-data">Removal of poorly represented modalities (&lt; 10 data)</a></li>
  <li><a href="#analyzing-the-potential-relationship-between-y-vs-xs" id="toc-analyzing-the-potential-relationship-between-y-vs-xs" class="nav-link" data-scroll-target="#analyzing-the-potential-relationship-between-y-vs-xs">Analyzing the potential relationship between Y vs Xs</a></li>
  <li><a href="#analysis-of-possible-interactions-between-the-four-xs" id="toc-analysis-of-possible-interactions-between-the-four-xs" class="nav-link" data-scroll-target="#analysis-of-possible-interactions-between-the-four-xs">Analysis of possible interactions between the four Xs</a></li>
  <li><a href="#search-for-candidate-model" id="toc-search-for-candidate-model" class="nav-link" data-scroll-target="#search-for-candidate-model">Search for candidate model</a></li>
  <li><a href="#analysis-of-the-coefficients-of-the-candidate-model" id="toc-analysis-of-the-coefficients-of-the-candidate-model" class="nav-link" data-scroll-target="#analysis-of-the-coefficients-of-the-candidate-model">Analysis of the coefficients of the candidate model</a></li>
  <li><a href="#explanatory-power-of-the-model-rÂ²" id="toc-explanatory-power-of-the-model-rÂ²" class="nav-link" data-scroll-target="#explanatory-power-of-the-model-rÂ²">Explanatory power of the model: RÂ²</a></li>
  <li><a href="#validation-of-modeling" id="toc-validation-of-modeling" class="nav-link" data-scroll-target="#validation-of-modeling">Validation of modeling</a>
  <ul class="collapse">
  <li><a href="#normality-of-residuals" id="toc-normality-of-residuals" class="nav-link" data-scroll-target="#normality-of-residuals">Normality of residuals</a></li>
  <li><a href="#homogeneity-of-variance" id="toc-homogeneity-of-variance" class="nav-link" data-scroll-target="#homogeneity-of-variance">Homogeneity of variance</a></li>
  <li><a href="#independence" id="toc-independence" class="nav-link" data-scroll-target="#independence">Independence</a></li>
  <li><a href="#verification-of-influential-individuals" id="toc-verification-of-influential-individuals" class="nav-link" data-scroll-target="#verification-of-influential-individuals">Verification of influential individuals</a></li>
  <li><a href="#conclusion-of-our-anova" id="toc-conclusion-of-our-anova" class="nav-link" data-scroll-target="#conclusion-of-our-anova">Conclusion of our ANOVA</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#v.-famd" id="toc-v.-famd" class="nav-link" data-scroll-target="#v.-famd">V. FAMD</a>
  <ul class="collapse">
  <li><a href="#generical-exploration" id="toc-generical-exploration" class="nav-link" data-scroll-target="#generical-exploration">Generical exploration</a></li>
  <li><a href="#realisation-of-the-famd" id="toc-realisation-of-the-famd" class="nav-link" data-scroll-target="#realisation-of-the-famd">Realisation of the FAMD</a></li>
  <li><a href="#realisation-of-a-hierarchical-clustering" id="toc-realisation-of-a-hierarchical-clustering" class="nav-link" data-scroll-target="#realisation-of-a-hierarchical-clustering">Realisation of a Hierarchical clustering</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Analysis of the Factors Favorable to Nest Success of Different Bird Species in Two USA States, Wisconsin and Illinois</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Rudy, Tanguy, Manon, Garan, AnaÃ«lle, Oceane, Victor </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<p><strong>Do not forget to set your working directory in the right place</strong> <strong>Menu : Session/Set Working Directory/Choose directory</strong> <em>And indicate Git/2024_MODE_OCR</em></p>
<section id="data-presentation" class="level1">
<h1>Data presentation</h1>
<p>The dataset (available following this link https://zenodo.org/records/8251495 ) used for this work contains nest records from different studies conducted in North America and more specifically in Wisconsin and Illinois. It was conducted in 13 different counties : Dane, Grant, Green, Iowa, Lafayette, Monroe, Rock, Lee, Ogle, Will, Grundy, Carroll, and Jo Daviess counties. The dataset contains the records of 3257 nests and for each of them different observations.</p>
<p>These observations are the following:</p>
<ul>
<li><strong><em>State</em></strong>: Illinois or Wisconsin - <em>qualitative explanatory variable</em></li>
<li><strong><em>County</em></strong>: Dane (Wisconsin), Grant (Wisconsin), Green (Wisconsin), Iowa (Wisconsin), Lafayette (Wisconsin), Monroe (Wisconsin), Rock (Wisconsin), Lee (Illinois), Ogle (Illinois), Will (Illinois), Grundy (Illinois), Carroll (Illinois), and Jo Daviess (Illinois) - <em>qualitative explanatory variable</em></li>
<li><strong><em>Habitat</em></strong>: Cool-season Grassland, Pasture, Prairie, Warm-season Grassland - <em>qualitative explanatory variable</em></li>
<li><strong><em>Species</em></strong>: Species of birds - Bobolink, Dickcissel, Eastern Meadowlark, Grasshopper Sparrow, Henslowâs Sparrow, Savannah Sparrow, Vesper Sparrow, and Western Meadowlark - <em>qualitative explanatory variable</em></li>
<li><strong><em>Years</em></strong>: from 1991 to 2011 - <em>qualitative explanatory variable</em></li>
<li><strong><em>Nest Fate</em></strong>: the fate of the chicks -&gt; Successly fledged at least one young (1) or Failed (0)- <em>quantitative explanatory variable</em></li>
<li><strong><em>Initiation Date</em></strong>: Date of the first laided egg - <em>quantitative explanatory variable</em></li>
<li><strong><em>Number fledged</em></strong>: Number of chicks that survived and fledged the nest - <em>quantitative explanatory variable</em></li>
<li><strong><em>Nest End Date</em></strong>: the date when the fate of it was recorded - <em>quantitative explanatory variable</em></li>
</ul>
<p>All theses observations are presented in a table with the following collums :</p>
<ul>
<li><em>Nest_ID</em> = unique nest identifier</li>
<li><em>State</em> = State in which nest was located (Illinois or Wisconsin)</li>
<li><em>County</em> = County in the state in which nest was located</li>
<li><em>Habitat</em> = Grassy habitat in which nest was located (pasture, cool-season grassland, warm-season grassland, or prairie)</li>
<li><em>Species</em> = English common name</li>
<li><em>Year</em> = Year nest was found</li>
<li><em>Nest_Fate</em> = Successly fledged at least one young (1) or Failed (0).</li>
<li><em>Initiation_Date</em> = Coded date when the first egg was laid. April 1 = 1; May 1 = 31; June 1 = 62; July 1 = 92; August 1 = 123; September 1 = 154</li>
<li><em>Number_Fledged</em> = For a successful nest, number of young in nest on nest end date; For a failed nest, Number_Fledged is 0</li>
<li><em>Nest_End_Date</em> = Coded date when the nest failed or was successful. April 1 = 1; May 1 = 31; June 1 = 62; July 1 = 92; August 1 = 123; September 1 = 154</li>
</ul>
</section>
<section id="what-kind-of-questions-can-we-rise" class="level1">
<h1>What kind of questions can we rise ?</h1>
<p>Import dataset</p>
<p>Charge the packages Download the spDataLarge package, unavailable on CRAN</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(spDataLarge)) {</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stop</span>(<span class="st">"The package 'spDataLarge' must be installed from the following depot : https://nowosad.github.io/drat/ </span><span class="sc">\n</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="st">        Use the following command in order to install : </span><span class="sc">\n</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="st">        install.packages('spDataLarge', repos = 'https://nowosad.github.io/drat/', type = 'source')"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: spDataLarge</code></pre>
</div>
</div>
<p>The rest of the packages</p>
</section>
<section id="first-look-at-the-data" class="level1">
<h1>First look at the data :</h1>
<p>You can visualize the first rows of the dataset by running the following cell :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View the firsts lines of the dataset</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Nest_ID    State County Habitat  Species Year Nest_Fate Initiation_Date
1 745JAAP Illinois   Will Pasture Bobolink 1995         0              58
2 748JAAP Illinois   Will Pasture Bobolink 1995         0              52
3 753JAAP Illinois   Will Pasture Bobolink 1995         1              51
4 754JAAP Illinois   Will Pasture Bobolink 1995         0              60
5 755JAAP Illinois   Will Pasture Bobolink 1995         0              53
6 758JAAP Illinois   Will Pasture Bobolink 1995         0              65
  Number_Fledged Nest_End_Date
1              0            78
2              0            74
3              6            75
4              0            75
5              0            69
6              0            78</code></pre>
</div>
</div>
<p>In order to picture the data in a more visual way, we will represent our dataset on a map. The first step in our map creation is the separation of the dataset by the counties.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>data_list_county <span class="ot">&lt;-</span> <span class="fu">split</span>(data, data<span class="sc">$</span>County)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>data_will <span class="ot">&lt;-</span> data_list_county[[<span class="st">"Will"</span>]]</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>data_jo_daviess <span class="ot">&lt;-</span> data_list_county[[<span class="st">"Jo_Daviess"</span>]]</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>data_lafayette <span class="ot">&lt;-</span> data_list_county[[<span class="st">"Lafayette"</span>]]</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>data_iowa <span class="ot">&lt;-</span> data_list_county[[<span class="st">"Iowa"</span>]]</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>data_dane <span class="ot">&lt;-</span> data_list_county[[<span class="st">"Dane"</span>]]</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>data_green <span class="ot">&lt;-</span> data_list_county[[<span class="st">"Green"</span>]]</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>data_grant <span class="ot">&lt;-</span> data_list_county[[<span class="st">"Grant"</span>]]</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>data_grundy <span class="ot">&lt;-</span> data_list_county[[<span class="st">"Grundy"</span>]]</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>data_lee_ogle <span class="ot">&lt;-</span> data_list_county[[<span class="st">"Lee/Ogle"</span>]]</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>data_lee <span class="ot">&lt;-</span> data_list_county[[<span class="st">"Lee"</span>]]</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>data_rock <span class="ot">&lt;-</span> data_list_county[[<span class="st">"Rock"</span>]]</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>data_monroe <span class="ot">&lt;-</span> data_list_county[[<span class="st">"Monroe"</span>]]</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>data_carroll <span class="ot">&lt;-</span> data_list_county[[<span class="st">"Carroll"</span>]]</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>data_carroll_whiteside <span class="ot">&lt;-</span> data_list_county[[<span class="st">"Carroll/Whiteside"</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We are now adding columns for the coordinates of each county, the coordinates were obtained by searching for the counties on openstreetmap.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>data_will <span class="ot">&lt;-</span> data_will <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">longitude_column =</span> <span class="sc">-</span><span class="fl">88.0817</span>,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">latitude_column =</span> <span class="fl">41.5250</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>data_jo_daviess <span class="ot">&lt;-</span> data_jo_daviess <span class="sc">%&gt;%</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">longitude_column =</span> <span class="sc">-</span><span class="fl">90.4290</span>,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">latitude_column =</span> <span class="fl">42.4167</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>data_grundy <span class="ot">&lt;-</span> data_grundy <span class="sc">%&gt;%</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">longitude_column =</span> <span class="sc">-</span><span class="fl">88.4210</span>,</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">latitude_column =</span> <span class="fl">41.3570</span>)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>data_lee <span class="ot">&lt;-</span> data_lee <span class="sc">%&gt;%</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">longitude_column =</span> <span class="sc">-</span><span class="fl">89.4850</span>,</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">latitude_column =</span> <span class="fl">41.8430</span>)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>data_carroll <span class="ot">&lt;-</span> data_carroll <span class="sc">%&gt;%</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">longitude_column =</span> <span class="sc">-</span><span class="fl">89.9826</span>,</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">latitude_column =</span> <span class="fl">42.0956</span>)</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>data_lafayette <span class="ot">&lt;-</span> data_lafayette <span class="sc">%&gt;%</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">longitude_column =</span> <span class="sc">-</span><span class="fl">90.1160</span>,</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>         <span class="at">latitude_column =</span> <span class="fl">42.6825</span>)</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>data_iowa <span class="ot">&lt;-</span> data_iowa <span class="sc">%&gt;%</span></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">longitude_column =</span> <span class="sc">-</span><span class="fl">90.1160</span>,</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>         <span class="at">latitude_column =</span> <span class="fl">42.6825</span>)</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>data_dane <span class="ot">&lt;-</span> data_dane <span class="sc">%&gt;%</span></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">longitude_column =</span> <span class="sc">-</span><span class="fl">89.4012</span>,</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>         <span class="at">latitude_column =</span> <span class="fl">43.0731</span>)</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>data_green <span class="ot">&lt;-</span> data_green <span class="sc">%&gt;%</span></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">longitude_column =</span> <span class="sc">-</span><span class="fl">89.6387</span>,</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>         <span class="at">latitude_column =</span> <span class="fl">42.6017</span>)</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>data_grant <span class="ot">&lt;-</span> data_grant <span class="sc">%&gt;%</span></span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">longitude_column =</span> <span class="sc">-</span><span class="fl">90.7082</span>,</span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>         <span class="at">latitude_column =</span> <span class="fl">42.8475</span>)</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>data_rock <span class="ot">&lt;-</span> data_rock <span class="sc">%&gt;%</span></span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">longitude_column =</span> <span class="sc">-</span><span class="fl">89.0187</span>,</span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>         <span class="at">latitude_column =</span> <span class="fl">42.6828</span>)</span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a>data_monroe <span class="ot">&lt;-</span> data_monroe <span class="sc">%&gt;%</span></span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">longitude_column =</span> <span class="sc">-</span><span class="fl">90.8129</span>,</span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a>         <span class="at">latitude_column =</span> <span class="fl">43.9447</span>)</span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a>data_lee_ogle <span class="ot">&lt;-</span> data_lee_ogle <span class="sc">%&gt;%</span></span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">longitude_column =</span> <span class="sc">-</span><span class="fl">89.4038</span>,</span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>         <span class="at">latitude_column =</span> <span class="fl">41.9293</span>)</span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>data_carroll_whiteside <span class="ot">&lt;-</span> data_carroll_whiteside <span class="sc">%&gt;%</span></span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">longitude_column =</span> <span class="sc">-</span><span class="fl">89.9742</span>,</span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>         <span class="at">latitude_column =</span> <span class="fl">41.9527</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, for each county dataset, we subdivide the said dataset for each year when at least one nest has been observed in this county.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>county_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"data_will"</span>, <span class="st">"data_jo_daviess"</span>, <span class="st">"data_lafayette"</span>, <span class="st">"data_iowa"</span>, </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"data_dane"</span>, <span class="st">"data_green"</span>, <span class="st">"data_grant"</span>, <span class="st">"data_grundy"</span>, </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"data_lee_ogle"</span>, <span class="st">"data_lee"</span>, <span class="st">"data_rock"</span>, <span class="st">"data_monroe"</span>, </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>                  <span class="st">"data_carroll"</span>, <span class="st">"data_carroll_whiteside"</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>county_dataframes <span class="ot">&lt;-</span> <span class="fu">mget</span>(county_names)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>tables <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq_along</span>(county_dataframes)) {</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    county <span class="ot">&lt;-</span> county_dataframes[[i]]</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    county_name <span class="ot">&lt;-</span> county_names[i]</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.data.frame</span>(county)) {</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"Error: "</span>, county_name, <span class="st">" is not a dataframe"</span>))</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">next</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="st">"Year"</span> <span class="sc">%in%</span> <span class="fu">colnames</span>(county)) {</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>        <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"Error: "</span>, county_name, <span class="st">" does not contain a 'Year' column"</span>))</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">next</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>    data_county_year <span class="ot">&lt;-</span> <span class="fu">split</span>(county, county<span class="sc">$</span>Year)</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(year <span class="cf">in</span> <span class="fu">min</span>(county<span class="sc">$</span>Year)<span class="sc">:</span><span class="fu">max</span>(county<span class="sc">$</span>Year)){</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>        tableau <span class="ot">&lt;-</span> data_county_year[[<span class="fu">as.character</span>(year)]]</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(tableau)) {</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>            variable_name <span class="ot">&lt;-</span> <span class="fu">paste0</span>(county_name, <span class="st">"_"</span>, year)</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>            tables <span class="ot">&lt;-</span> <span class="fu">c</span>(tables, variable_name)</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>            <span class="fu">assign</span>(variable_name, tableau, <span class="at">envir =</span> .GlobalEnv)</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We went from a full dataset with everything mixed-up to multiple datasets for each year and each county when an observation is available.</p>
<p>Here are, for example, the first rows of the dataframe related to the county of Will in 1995</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_will_1995)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Nest_ID    State County Habitat  Species Year Nest_Fate Initiation_Date
1 745JAAP Illinois   Will Pasture Bobolink 1995         0              58
2 748JAAP Illinois   Will Pasture Bobolink 1995         0              52
3 753JAAP Illinois   Will Pasture Bobolink 1995         1              51
4 754JAAP Illinois   Will Pasture Bobolink 1995         0              60
5 755JAAP Illinois   Will Pasture Bobolink 1995         0              53
6 758JAAP Illinois   Will Pasture Bobolink 1995         0              65
  Number_Fledged Nest_End_Date longitude_column latitude_column
1              0            78         -88.0817          41.525
2              0            74         -88.0817          41.525
3              6            75         -88.0817          41.525
4              0            75         -88.0817          41.525
5              0            69         -88.0817          41.525
6              0            78         -88.0817          41.525</code></pre>
</div>
</div>
<p>The main information that we want to present on the map are the mean number of fledged birds by nest and the amount of data available for each county and each year.</p>
<p>Here is the creation of a summary dataframe that contains all these informations for each dataframe.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>annee <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>taux_de_reussite <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>nb_donnees <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>lat <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>lon<span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Creation of a summary for each year</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(table_name <span class="cf">in</span> tables){</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  tablecreated <span class="ot">&lt;-</span> <span class="fu">get</span>(table_name)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  annee <span class="ot">&lt;-</span> <span class="fu">c</span>(annee, tablecreated<span class="sc">$</span>Year[<span class="dv">1</span>])</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  taux_de_reussite <span class="ot">&lt;-</span> <span class="fu">c</span>(taux_de_reussite, <span class="fu">sum</span>(tablecreated<span class="sc">$</span>Number_Fledged)<span class="sc">/</span><span class="fu">nrow</span>(tablecreated))</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  nb_donnees <span class="ot">&lt;-</span> <span class="fu">c</span>(nb_donnees, <span class="fu">nrow</span>(tablecreated))</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  lat <span class="ot">&lt;-</span> <span class="fu">c</span>(lat, tablecreated<span class="sc">$</span>latitude_column[<span class="dv">1</span>])</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  lon <span class="ot">&lt;-</span> <span class="fu">c</span>(lon, tablecreated<span class="sc">$</span>longitude_column[<span class="dv">1</span>])</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a dataframe of thoose summaries</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>tableau <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">annee =</span> annee, </span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">Mean_number_fledged_by_nest =</span> taux_de_reussite, </span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">nb_donnees =</span> nb_donnees, </span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">lat =</span> lat, </span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">lon =</span> lon</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Seting the dataframe as a spatial class in order to create a map</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>tableau_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(tableau, <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"lon"</span>, <span class="st">"lat"</span>), <span class="at">crs =</span> <span class="dv">4326</span>)</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>tableau_sf <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(tableau_sf, <span class="at">crs =</span> <span class="fu">st_crs</span>(us_states))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>As we now have all the data of interest in one single organized table, we can actually create the map.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"view"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>tmap mode set to interactive viewing</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>bird_anim <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(us_states) <span class="sc">+</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span> </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(tableau_sf) <span class="sc">+</span> </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_symbols</span>(<span class="at">size =</span> <span class="st">"Mean_number_fledged_by_nest"</span>, <span class="at">col =</span> <span class="st">"nb_donnees"</span>, </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">style =</span> <span class="st">"quantile"</span>, <span class="at">title.size =</span> <span class="st">"Mean number fledged by nest"</span>, <span class="at">title.col =</span> <span class="st">"Number of nest observed"</span>) <span class="sc">+</span> </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">title =</span> <span class="st">"Bird Observations Over Time"</span>, </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="st">"left"</span>, <span class="st">"bottom"</span>),</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">FALSE</span>, </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.show =</span> T) <span class="sc">+</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_facets</span>(<span class="at">by =</span> <span class="st">"annee"</span>, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">1</span>, <span class="at">free.coords =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And now, we just have to run the following cell to display the map.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_animation</span>(bird_anim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Creating frames</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>========</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>===</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>====</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>====</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>====</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>====</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>===</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>====</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>====</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>====</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>====</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>====</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>===</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>====</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>====</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>====</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>====</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>===</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>====</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>====</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Creating animation</code></pre>
</div>
</div>
<p>Please, check out the newly created map on the âViewerâ panel of your Rstudio application.</p>
<p>I believe that the first thing we can say about the data, is that it is unevenly distributed. Depending on the year and the county, the number of observed nests changes ; and sometimes not even a single observation is available.</p>
</section>
<section id="data-exploration" class="level1">
<h1><u>1. Data exploration</u></h1>
<section id="repartition-of-the-data-through-time" class="level3">
<h3 class="anchored" data-anchor-id="repartition-of-the-data-through-time">Repartition of the data through time</h3>
<section id="statistical-tests" class="level5">
<h5 class="anchored" data-anchor-id="statistical-tests">Statistical tests</h5>
<p>In this part, several statistical tests are performed in order to answer questions.</p>
<ul>
<li><em>First question : Does the number of fledged birds depend on the species ?</em></li>
</ul>
<p>H0 : there is no differences between species</p>
<p>First, we observe the data with a boxplot. There is no significant differences through the boxplots.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> data, </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Habitat, </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> Nest_End_Date)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>       ) <span class="sc">+</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Habitat)) <span class="sc">+</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Nest_End_Date depending on the Habitat"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analyse_Birds_files/figure-html/boxplots-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 2
 $ axis.text.x: list()
  ..- attr(*, "class")= chr [1:2] "element_blank" "element"
 $ plot.title :List of 11
  ..$ family       : NULL
  ..$ face         : chr "bold"
  ..$ colour       : NULL
  ..$ size         : NULL
  ..$ hjust        : NULL
  ..$ vjust        : NULL
  ..$ angle        : NULL
  ..$ lineheight   : NULL
  ..$ margin       : NULL
  ..$ debug        : NULL
  ..$ inherit.blank: logi FALSE
  ..- attr(*, "class")= chr [1:2] "element_text" "element"
 - attr(*, "class")= chr [1:2] "theme" "gg"
 - attr(*, "complete")= logi FALSE
 - attr(*, "validate")= logi TRUE</code></pre>
</div>
</div>
<p>Then, we test the normality of the data. All the p-values are ranged in a dataframe.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">|&gt;</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Selection of only two columns of interest</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(  </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    Species, </span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    Number_Fledged</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculation of the p-value of the shapiro test for each species</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(Species) <span class="sc">|&gt;</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">shap =</span> <span class="fu">shapiro.test</span>(Number_Fledged)<span class="sc">$</span>p</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 Ã 2
  Species                 shap
  &lt;fct&gt;                  &lt;dbl&gt;
1 Bobolink            2.64e-23
2 Dickcissel          5.49e-29
3 Eastern_Meadowlark  5.26e-36
4 Grasshopper_Sparrow 1.80e-32
5 Henslow's_Sparrow   5.38e-11
6 Savannah_Sparrow    1.65e-35
7 Vesper_Sparrow      2.70e-18
8 Western_Meadowlark  4.43e-10</code></pre>
</div>
</div>
<p>Conclusion : each subset does not follow the normality. We can perform a U test (non parametric test) :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Construction of an empty 8x8 dataframe. It will contains each p-value of the U test</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>cor_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="dv">8</span>, <span class="at">ncol =</span> <span class="dv">8</span>, <span class="cn">NA</span>)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Retrive the species names</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>species <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">unique</span>(data<span class="sc">$</span>Species))</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Rename the matrix</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(cor_df) <span class="ot">&lt;-</span> species</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(cor_df) <span class="ot">&lt;-</span> species</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>data_species <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> </span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>    Species, </span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>    Number_Fledged</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">arrange</span>(Species)</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (sp1 <span class="cf">in</span> (<span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(species)))){</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (sp2 <span class="cf">in</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(species))){</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Retrieve the data of the species 1</span></span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>    species_1 <span class="ot">&lt;-</span> data_species <span class="sc">|&gt;</span></span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">filter</span>(Species <span class="sc">==</span> species[sp1]) <span class="sc">|&gt;</span></span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">select</span>(Number_Fledged)</span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Retrieve the data of the species 2</span></span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>    species_2 <span class="ot">&lt;-</span> data_species <span class="sc">|&gt;</span></span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">filter</span>(Species <span class="sc">==</span> species[sp2]) <span class="sc">|&gt;</span></span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">select</span>(Number_Fledged)</span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Formating of the vector containing the number of fledged birds. </span></span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a>    species_1 <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(species_1)<span class="sc">$</span>Number_Fledged</span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a>    species_2 <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(species_2)<span class="sc">$</span>Number_Fledged</span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a>    <span class="do">## To put the p.values on the correlation matrix</span></span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a>    cor_df[sp1,sp2] <span class="ot">&lt;-</span> <span class="fu">wilcox.test</span>(species_1, species_2)<span class="sc">$</span>p.value</span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb42-41"><a href="#cb42-41" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, we can observe the p-values in the following matrix :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggcorrplot</span>(</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">corr =</span> cor_df,</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">lab =</span> <span class="cn">TRUE</span>,</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">lab_size =</span> <span class="dv">3</span>,</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">show.diag =</span> <span class="cn">TRUE</span>,</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"upper"</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>,</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">angle =</span> <span class="dv">45</span>),</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>)</span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">low =</span> <span class="st">"tomato2"</span>, </span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">high =</span> <span class="st">"springgreen3"</span>, </span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">midpoint =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"P-values of the U-tests with the number of fledged birds as variable"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Scale for fill is already present.
Adding another scale for fill, which will replace the existing scale.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Analyse_Birds_files/figure-html/printpvalues-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Observation : we see that there is globally no differences in the mean of the groups. So we keep H0.</p>
<ul>
<li><em>Second question : we want to summarise the information depending on different factor.</em></li>
</ul>
<p>In the following chunks, a list named <em>data_summariser</em> is created and it will contains several dataframes. These dataframes summarise the different quantitative variables (i.e.&nbsp;Nest_Fate, Initiation_Date, Number_Fledged and Nest_End_Date) by the means and for each factor (i.e.&nbsp;County, State, Species and Habitat). There is one dataframe per factor. The goal is to better visualise the repartition of the species as a function of a factor AND to see the means.</p>
<p>Here, we summarise with the factor : Species.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Calculation of the mean of each variables depending on the Species</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>data_sp <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    Species,Nest_Fate,Initiation_Date, Number_Fledged, Nest_End_Date</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">|&gt;</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>    Species</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">count =</span> <span class="fu">n</span>(),</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">prop_Nest_Fate =</span> <span class="fu">sum</span>(Nest_Fate) <span class="sc">/</span> <span class="fu">length</span>(Nest_Fate),</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_Init_Date =</span> <span class="fu">mean</span>(Initiation_Date),</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_Number_Fledged =</span> <span class="fu">mean</span>(Number_Fledged),</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_Nest_End_Date =</span> <span class="fu">mean</span>(Nest_End_Date),</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Calculation of the mean of each variables depending on the habitat</span></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>data_hab <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>    Habitat,Nest_Fate,Initiation_Date, Number_Fledged, Nest_End_Date</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">|&gt;</span></span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>    Habitat</span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">count =</span> <span class="fu">n</span>(),</span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">prop_Nest_Fate =</span> <span class="fu">sum</span>(Nest_Fate) <span class="sc">/</span> <span class="fu">length</span>(Nest_Fate),</span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_Init_Date =</span> <span class="fu">mean</span>(Initiation_Date),</span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_Number_Fledged =</span> <span class="fu">mean</span>(Number_Fledged),</span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_Nest_End_Date =</span> <span class="fu">mean</span>(Nest_End_Date),</span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a><span class="do">## Calculation of the mean of each variables depending on the state</span></span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>data_state <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span></span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a>    State,Nest_Fate,Initiation_Date, Number_Fledged, Nest_End_Date</span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">|&gt;</span></span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(</span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a>    State</span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(</span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">count =</span> <span class="fu">n</span>(),</span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">prop_Nest_Fate =</span> <span class="fu">sum</span>(Nest_Fate) <span class="sc">/</span> <span class="fu">length</span>(Nest_Fate),</span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_Init_Date =</span> <span class="fu">mean</span>(Initiation_Date),</span>
<span id="cb45-45"><a href="#cb45-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_Number_Fledged =</span> <span class="fu">mean</span>(Number_Fledged),</span>
<span id="cb45-46"><a href="#cb45-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_Nest_End_Date =</span> <span class="fu">mean</span>(Nest_End_Date),</span>
<span id="cb45-47"><a href="#cb45-47" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb45-48"><a href="#cb45-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-49"><a href="#cb45-49" aria-hidden="true" tabindex="-1"></a><span class="do">## Calculation of the mean of each variables depending on the county</span></span>
<span id="cb45-50"><a href="#cb45-50" aria-hidden="true" tabindex="-1"></a>data_county <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span></span>
<span id="cb45-51"><a href="#cb45-51" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb45-52"><a href="#cb45-52" aria-hidden="true" tabindex="-1"></a>    State, County, Nest_Fate,Initiation_Date, Number_Fledged, Nest_End_Date</span>
<span id="cb45-53"><a href="#cb45-53" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">|&gt;</span></span>
<span id="cb45-54"><a href="#cb45-54" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(</span>
<span id="cb45-55"><a href="#cb45-55" aria-hidden="true" tabindex="-1"></a>    State, County</span>
<span id="cb45-56"><a href="#cb45-56" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb45-57"><a href="#cb45-57" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(</span>
<span id="cb45-58"><a href="#cb45-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">count =</span> <span class="fu">n</span>(),</span>
<span id="cb45-59"><a href="#cb45-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">prop_Nest_Fate =</span> <span class="fu">sum</span>(Nest_Fate) <span class="sc">/</span> <span class="fu">length</span>(Nest_Fate),</span>
<span id="cb45-60"><a href="#cb45-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_Init_Date =</span> <span class="fu">mean</span>(Initiation_Date),</span>
<span id="cb45-61"><a href="#cb45-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_Number_Fledged =</span> <span class="fu">mean</span>(Number_Fledged),</span>
<span id="cb45-62"><a href="#cb45-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_Nest_End_Date =</span> <span class="fu">mean</span>(Nest_End_Date),</span>
<span id="cb45-63"><a href="#cb45-63" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'State'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>data_sp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 Ã 6
  Species             count prop_Nest_Fate mean_Init_Date mean_Number_Fledged
  &lt;fct&gt;               &lt;int&gt;          &lt;dbl&gt;          &lt;dbl&gt;               &lt;dbl&gt;
1 Bobolink              390          0.472           59.5               1.72 
2 Dickcissel            470          0.347           85.9               1.05 
3 Eastern_Meadowlark    726          0.321           61.4               1.01 
4 Grasshopper_Sparrow   693          0.404           73.6               1.39 
5 Henslow's_Sparrow      72          0.389           63.2               1.18 
6 Savannah_Sparrow      664          0.295           66.5               0.887
7 Vesper_Sparrow        174          0.345           69.4               0.908
8 Western_Meadowlark     68          0.426           68.9               1.49 
# â¹ 1 more variable: mean_Nest_End_Date &lt;dbl&gt;</code></pre>
</div>
</div>
<p>We create a list called data_summariser that will contains each previously created tables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>data_summariser <span class="ot">&lt;-</span><span class="fu">list</span>()  <span class="co"># Creation of the due list data_summariser</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>data_summariser<span class="sc">$</span>Species <span class="ot">&lt;-</span> data_sp <span class="co"># Add the Species table</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>data_summariser<span class="sc">$</span>Habitat <span class="ot">&lt;-</span> data_hab </span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>data_summariser<span class="sc">$</span>State <span class="ot">&lt;-</span> data_state</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>data_summariser<span class="sc">$</span>County <span class="ot">&lt;-</span> data_county</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>data_summariser</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Species
# A tibble: 8 Ã 6
  Species             count prop_Nest_Fate mean_Init_Date mean_Number_Fledged
  &lt;fct&gt;               &lt;int&gt;          &lt;dbl&gt;          &lt;dbl&gt;               &lt;dbl&gt;
1 Bobolink              390          0.472           59.5               1.72 
2 Dickcissel            470          0.347           85.9               1.05 
3 Eastern_Meadowlark    726          0.321           61.4               1.01 
4 Grasshopper_Sparrow   693          0.404           73.6               1.39 
5 Henslow's_Sparrow      72          0.389           63.2               1.18 
6 Savannah_Sparrow      664          0.295           66.5               0.887
7 Vesper_Sparrow        174          0.345           69.4               0.908
8 Western_Meadowlark     68          0.426           68.9               1.49 
# â¹ 1 more variable: mean_Nest_End_Date &lt;dbl&gt;

$Habitat
# A tibble: 4 Ã 6
  Habitat               count prop_Nest_Fate mean_Init_Date mean_Number_Fledged
  &lt;fct&gt;                 &lt;int&gt;          &lt;dbl&gt;          &lt;dbl&gt;               &lt;dbl&gt;
1 Cool-season_Grassland   677          0.403           65.3                1.39
2 Pasture                1683          0.319           69.2                1.01
3 Prairie                 496          0.363           70.4                1.12
4 Warm-season_Grassland   401          0.456           72.6                1.48
# â¹ 1 more variable: mean_Nest_End_Date &lt;dbl&gt;

$State
# A tibble: 2 Ã 6
  State     count prop_Nest_Fate mean_Init_Date mean_Number_Fledged
  &lt;fct&gt;     &lt;int&gt;          &lt;dbl&gt;          &lt;dbl&gt;               &lt;dbl&gt;
1 Illinois   1073          0.314           74.6                1.02
2 Wisconsin  2184          0.383           66.2                1.23
# â¹ 1 more variable: mean_Nest_End_Date &lt;dbl&gt;

$County
# A tibble: 14 Ã 7
# Groups:   State [2]
   State     County      count prop_Nest_Fate mean_Init_Date mean_Number_Fledged
   &lt;fct&gt;     &lt;fct&gt;       &lt;int&gt;          &lt;dbl&gt;          &lt;dbl&gt;               &lt;dbl&gt;
 1 Illinois  Carroll        15          0.333           74.7               0.733
 2 Illinois  Carroll/Whâ¦     5          0.2             73.4               0.8  
 3 Illinois  Grundy         53          0.208           72.3               0.642
 4 Illinois  Jo_Daviess    292          0.435           75.8               1.43 
 5 Illinois  Lee            20          0.3             84.3               1.1  
 6 Illinois  Lee/Ogle      297          0.286           78.9               0.892
 7 Illinois  Will          391          0.261           70.3               0.877
 8 Wisconsin Dane          441          0.508           64.3               1.81 
 9 Wisconsin Grant         101          0.198           65.4               0.554
10 Wisconsin Green         181          0.343           64.9               1.10 
11 Wisconsin Iowa          744          0.349           63.9               1.15 
12 Wisconsin Lafayette     481          0.343           69.7               0.983
13 Wisconsin Monroe        233          0.442           70.8               1.33 
14 Wisconsin Rock            3          0.667           94.7               0.667
# â¹ 1 more variable: mean_Nest_End_Date &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Convert dates to months to make a MCA:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Creation of a function to replace the number by a month </span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>num_to_month <span class="ot">&lt;-</span> <span class="cf">function</span>(num){</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (num <span class="sc">%in%</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>)){</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>    res <span class="ot">&lt;-</span> <span class="st">"april"</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (num <span class="sc">%in%</span> (<span class="dv">31</span><span class="sc">:</span><span class="dv">61</span>)){</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>    res <span class="ot">&lt;-</span> <span class="st">"may"</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (num <span class="sc">%in%</span> (<span class="dv">62</span><span class="sc">:</span><span class="dv">91</span>)){</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>    res <span class="ot">&lt;-</span> <span class="st">"june"</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (num <span class="sc">%in%</span> (<span class="dv">92</span><span class="sc">:</span><span class="dv">122</span>)){</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>    res <span class="ot">&lt;-</span> <span class="st">"july"</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (num <span class="sc">%in%</span> (<span class="dv">123</span><span class="sc">:</span><span class="dv">153</span>)){</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>    res <span class="ot">&lt;-</span> <span class="st">"august"</span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>    res <span class="ot">&lt;-</span> <span class="st">"september"</span></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (res)</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, we trasform all the quantitative variable into factors.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Conversion into months </span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>data_ACM <span class="ot">&lt;-</span> data</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>data_ACM<span class="sc">$</span>Initiation_Date <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="at">X =</span> data_ACM<span class="sc">$</span>Initiation_Date, </span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>                                <span class="at">FUN =</span> num_to_month</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>                                )</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>data_ACM<span class="sc">$</span>Nest_End_Date <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="at">X =</span> data_ACM<span class="sc">$</span>Nest_End_Date, </span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>                              <span class="at">FUN =</span> num_to_month</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>                              )</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Conversion into factors</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>data_ACM <span class="ot">&lt;-</span> data_ACM <span class="sc">|&gt;</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Nest_Fate =</span> <span class="fu">as.factor</span>(Nest_Fate),</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">Initiation_Date =</span> <span class="fu">as.factor</span>(<span class="fu">unlist</span>(Initiation_Date)),</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">Number_Fledged =</span> <span class="fu">as.factor</span>(Number_Fledged),</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">Nest_End_Date =</span> <span class="fu">as.factor</span>(<span class="fu">unlist</span>(Nest_End_Date)),</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">Year =</span> <span class="fu">as.factor</span>(Year)</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>                )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="mca-analysis-data-exploring" class="level5">
<h5 class="anchored" data-anchor-id="mca-analysis-data-exploring">MCA analysis (data exploring)</h5>
<p>Before doing the MCA analysis, we must verify that all the modalities represent at least 3% of the data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportions de chaques modalitÃ©s dans chaques variables:</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(data_ACM<span class="sc">$</span>State))<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Illinois Wisconsin 
 32.94443  67.05557 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(data_ACM<span class="sc">$</span>County))<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
          Carroll Carroll/Whiteside              Dane             Grant 
        0.4605465         0.1535155        13.5400675         3.1010132 
            Green            Grundy              Iowa        Jo_Daviess 
        5.5572613         1.6272644        22.8431072         8.9653055 
        Lafayette               Lee          Lee/Ogle            Monroe 
       14.7681916         0.6140620         9.1188210         7.1538225 
             Rock              Will 
        0.0921093        12.0049125 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(data_ACM<span class="sc">$</span>Habitat))<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Cool-season_Grassland               Pasture               Prairie 
             20.78600              51.67332              15.22874 
Warm-season_Grassland 
             12.31194 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(data_ACM<span class="sc">$</span>Species))<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
           Bobolink          Dickcissel  Eastern_Meadowlark Grasshopper_Sparrow 
          11.974209           14.430457           22.290451           21.277249 
  Henslow's_Sparrow    Savannah_Sparrow      Vesper_Sparrow  Western_Meadowlark 
           2.210623           20.386859            5.342340            2.087811 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(data_ACM<span class="sc">$</span>Year))<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
      1991       1992       1993       1994       1995       1996       1997 
 2.0878109  0.8289837  0.7368744  0.7982806  6.3248388  8.0135094 10.1320233 
      1998       1999       2000       2001       2002       2003       2004 
 9.8556954  8.3512435 13.7549893  8.7503838  5.5572613  1.7193737  3.1317163 
      2005       2006       2007       2008       2009       2010       2011 
 1.6886706  2.7939822  4.2677310  5.5265582  2.0571078  2.2413264  1.3816395 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(data_ACM<span class="sc">$</span>Nest_Fate))<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
       0        1 
63.98526 36.01474 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(data_ACM<span class="sc">$</span>Number_Fledged))<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
         0          1          2          3          4          5          6 
63.9852625  3.8378876  6.1099171  9.7635861 10.8688978  5.0046055  0.4298434 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(data_ACM<span class="sc">$</span>Initiation_Date))<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     april     august       july       june        may 
 1.4737488  0.0307031 14.2462389 47.8354314 36.4138778 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(data_ACM<span class="sc">$</span>Nest_End_Date))<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     april     august       july       june        may 
 0.0307031  2.8860915 39.5455941 47.0371508 10.5004605 </code></pre>
</div>
</div>
<p>Some of the modalities are under-represented. We must delete them. The modalities under-represented are: Countries Carroll, Carroll/Whiteside, Grundy, Lee and Rock, Species Henslowâs Sparrow and Western Meadowlark, half of the years modalities, 6 fledged chicks, and months April and August for both nest initiation date and nest end date.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(data_ACM<span class="sc">$</span>County))<span class="sc">*</span><span class="dv">100</span> <span class="sc">&lt;</span> <span class="dv">3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
          Carroll Carroll/Whiteside              Dane             Grant 
             TRUE              TRUE             FALSE             FALSE 
            Green            Grundy              Iowa        Jo_Daviess 
            FALSE              TRUE             FALSE             FALSE 
        Lafayette               Lee          Lee/Ogle            Monroe 
            FALSE              TRUE             FALSE             FALSE 
             Rock              Will 
             TRUE             FALSE </code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We must delete the data of counties Carroll, Carroll/Whiteside, Grundy, Lee and Rock</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>data_ACM <span class="ot">&lt;-</span> data_ACM[<span class="sc">-</span><span class="fu">which</span>(data_ACM<span class="sc">$</span>County <span class="sc">==</span> <span class="st">"Carroll"</span> <span class="sc">|</span> </span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>                              data_ACM<span class="sc">$</span>County <span class="sc">==</span> <span class="st">"Carroll/Whiteside"</span> <span class="sc">|</span> </span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>                              data_ACM<span class="sc">$</span>County <span class="sc">==</span> <span class="st">"Grundy"</span> <span class="sc">|</span> </span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>                              data_ACM<span class="sc">$</span>County <span class="sc">==</span> <span class="st">"Lee"</span> <span class="sc">|</span> </span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>                              data_ACM<span class="sc">$</span>County <span class="sc">==</span> <span class="st">"Rock"</span>),]</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>data_ACM<span class="sc">$</span>County <span class="ot">&lt;-</span> <span class="fu">droplevels</span>(data_ACM<span class="sc">$</span>County)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(data_ACM<span class="sc">$</span>Species))<span class="sc">*</span><span class="dv">100</span> <span class="sc">&lt;</span> <span class="dv">3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
           Bobolink          Dickcissel  Eastern_Meadowlark Grasshopper_Sparrow 
              FALSE               FALSE               FALSE               FALSE 
  Henslow's_Sparrow    Savannah_Sparrow      Vesper_Sparrow  Western_Meadowlark 
               TRUE               FALSE               FALSE                TRUE </code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We must delete the data of species Henslow's_Sparrow and Western_Meadowlark</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>data_ACM <span class="ot">&lt;-</span> data_ACM[<span class="sc">-</span><span class="fu">which</span>(data_ACM<span class="sc">$</span>Species <span class="sc">==</span> <span class="st">"Henslow's_Sparrow"</span> <span class="sc">|</span> </span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>                              data_ACM<span class="sc">$</span>Species <span class="sc">==</span> <span class="st">"Western_Meadowlark"</span>),]</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>data_ACM<span class="sc">$</span>Species <span class="ot">&lt;-</span> <span class="fu">droplevels</span>(data_ACM<span class="sc">$</span>Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(data_ACM<span class="sc">$</span>Year))<span class="sc">*</span><span class="dv">100</span> <span class="sc">&lt;</span> <span class="dv">3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 1991  1992  1993  1994  1995  1996  1997  1998  1999  2000  2001  2002  2003 
 TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE 
 2004  2005  2006  2007  2008  2009  2010  2011 
FALSE  TRUE  TRUE FALSE FALSE  TRUE  TRUE  TRUE </code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">prop.table</span>(<span class="fu">table</span>(data_ACM<span class="sc">$</span>Year))<span class="sc">*</span><span class="dv">100</span> <span class="sc">&lt;</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Mode   FALSE    TRUE 
logical      11      10 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># As half of the modalities are under-represented, we will group the years by 3.</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>data_ACM <span class="ot">&lt;-</span> data_ACM <span class="sc">%&gt;%</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">factor</span>(<span class="fu">case_when</span>(</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>    Year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"1991"</span>, <span class="st">"1992"</span>, <span class="st">"1993"</span>) <span class="sc">~</span> <span class="st">"1991-1993"</span>,</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>    Year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"1994"</span>, <span class="st">"1995"</span>, <span class="st">"1996"</span>) <span class="sc">~</span> <span class="st">"1994-1996"</span>,</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>    Year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"1997"</span>, <span class="st">"1998"</span>, <span class="st">"1999"</span>) <span class="sc">~</span> <span class="st">"1997-1999"</span>,</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>    Year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"2000"</span>, <span class="st">"2001"</span>, <span class="st">"2002"</span>) <span class="sc">~</span> <span class="st">"2000-2002"</span>,</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>    Year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"2003"</span>, <span class="st">"2004"</span>, <span class="st">"2005"</span>) <span class="sc">~</span> <span class="st">"2003-2005"</span>,</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>    Year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"2006"</span>, <span class="st">"2007"</span>, <span class="st">"2008"</span>) <span class="sc">~</span> <span class="st">"2006-2008"</span>,</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>    Year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"2009"</span>, <span class="st">"2010"</span>, <span class="st">"2011"</span>) <span class="sc">~</span> <span class="st">"2009-2011"</span></span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>  ), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"1991-1993"</span>, <span class="st">"1994-1996"</span>, <span class="st">"1997-1999"</span>, <span class="st">"2000-2002"</span>, <span class="st">"2003-2005"</span>, <span class="st">"2006-2008"</span>, <span class="st">"2009-2011"</span>)))</span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(data_ACM<span class="sc">$</span>Year))<span class="sc">*</span><span class="dv">100</span> <span class="sc">&lt;</span> <span class="dv">3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
1991-1993 1994-1996 1997-1999 2000-2002 2003-2005 2006-2008 2009-2011 
    FALSE     FALSE     FALSE     FALSE     FALSE     FALSE     FALSE </code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># None of the years are still under-represented.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(data_ACM<span class="sc">$</span>Number_Fledged))<span class="sc">*</span><span class="dv">100</span> <span class="sc">&lt;</span> <span class="dv">3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    0     1     2     3     4     5     6 
FALSE FALSE FALSE FALSE FALSE FALSE  TRUE </code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We will group the nest with 5 or 6 fledged chicks with a modality labelled "&gt;5"</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(data_ACM<span class="sc">$</span>Number_Fledged) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">levels</span>(data_ACM<span class="sc">$</span>Number_Fledged), <span class="st">"&gt;5"</span>)</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>data_ACM[<span class="fu">which</span>(data_ACM<span class="sc">$</span>Number_Fledged <span class="sc">==</span> <span class="dv">5</span> <span class="sc">|</span> data_ACM<span class="sc">$</span>Number_Fledged <span class="sc">==</span> <span class="dv">6</span>),]<span class="sc">$</span>Number_Fledged <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="st">"&gt;5"</span>)</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>data_ACM<span class="sc">$</span>Number_Fledged <span class="ot">&lt;-</span> <span class="fu">droplevels</span>(data_ACM<span class="sc">$</span>Number_Fledged)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(data_ACM<span class="sc">$</span>Initiation_Date))<span class="sc">*</span><span class="dv">100</span> <span class="sc">&lt;</span> <span class="dv">3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 april august   july   june    may 
  TRUE   TRUE  FALSE  FALSE  FALSE </code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We must delete the data with an initiation date in August and April.</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>data_ACM <span class="ot">&lt;-</span> data_ACM[<span class="sc">-</span><span class="fu">which</span>(data_ACM<span class="sc">$</span>Initiation_Date <span class="sc">==</span> <span class="st">"august"</span> <span class="sc">|</span> </span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>                              data_ACM<span class="sc">$</span>Initiation_Date <span class="sc">==</span> <span class="st">"april"</span>),]</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>data_ACM<span class="sc">$</span>Initiation_Date <span class="ot">&lt;-</span> <span class="fu">droplevels</span>(data_ACM<span class="sc">$</span>Initiation_Date)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(data_ACM<span class="sc">$</span>Nest_End_Date))<span class="sc">*</span><span class="dv">100</span> <span class="sc">&lt;</span> <span class="dv">3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 april august   july   june    may 
  TRUE   TRUE  FALSE  FALSE  FALSE </code></pre>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We must delete the data with an end date in August and April.</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>data_ACM <span class="ot">&lt;-</span> data_ACM[<span class="sc">-</span><span class="fu">which</span>(data_ACM<span class="sc">$</span>Nest_End_Date <span class="sc">==</span> <span class="st">"august"</span> <span class="sc">|</span> </span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>                              data_ACM<span class="sc">$</span>Nest_End_Date <span class="sc">==</span> <span class="st">"april"</span>),]</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>data_ACM<span class="sc">$</span>Nest_End_Date <span class="ot">&lt;-</span> <span class="fu">droplevels</span>(data_ACM<span class="sc">$</span>Nest_End_Date)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, we can check again that no modalities are under-represented (threshold 3%).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportions de chaques modalitÃ©s dans chaques variables:</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(data_ACM<span class="sc">$</span>State))<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Illinois Wisconsin 
 30.26634  69.73366 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(data_ACM<span class="sc">$</span>County))<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
      Dane      Grant      Green       Iowa Jo_Daviess  Lafayette   Lee/Ogle 
 12.832930   3.424421   5.984089  23.555863   7.990315  15.980630   9.477689 
    Monroe       Will 
  7.955725  12.798340 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(data_ACM<span class="sc">$</span>Habitat))<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Cool-season_Grassland               Pasture               Prairie 
             19.43964              53.58008              15.25424 
Warm-season_Grassland 
             11.72605 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(data_ACM<span class="sc">$</span>Species))<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
           Bobolink          Dickcissel  Eastern_Meadowlark Grasshopper_Sparrow 
          13.386371           13.870633           22.103079           22.206849 
   Savannah_Sparrow      Vesper_Sparrow 
          22.552750            5.880318 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(data_ACM<span class="sc">$</span>Year))<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
1991-1993 1994-1996 1997-1999 2000-2002 2003-2005 2006-2008 2009-2011 
 3.562781 14.285714 27.429955 30.854376  6.675891 11.587686  5.603597 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(data_ACM<span class="sc">$</span>Nest_Fate))<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
       0        1 
64.99481 35.00519 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(data_ACM<span class="sc">$</span>Number_Fledged))<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
        0         1         2         3         4        &gt;5 
64.994811  3.493601  6.226219  9.408509 10.446212  5.430647 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(data_ACM<span class="sc">$</span>Initiation_Date))<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    july     june      may 
11.58769 50.22484 38.18748 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(data_ACM<span class="sc">$</span>Nest_End_Date))<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     july      june       may 
41.093047 49.394673  9.512279 </code></pre>
</div>
</div>
<p>All the modalities are enough represented. We can now start the MCA analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># MCA without the Nest IDs.</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>ACM_bird <span class="ot">&lt;-</span> <span class="fu">MCA</span>(data_ACM[,<span class="sc">-</span><span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_eig</span>(ACM_bird, <span class="at">main=</span><span class="st">"histogram of % inertia"</span>, <span class="at">addlabels =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analyse_Birds_files/figure-html/inertiaofaxis-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The inertia holded by the first axis is very low (9.3%)</p>
<p>Letâs see wich modalities are significantly contributing to the analysis, for the axis 1 and 2</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_contrib</span>(ACM_bird, <span class="at">choice=</span><span class="st">'var'</span>, <span class="at">axes=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analyse_Birds_files/figure-html/contributionsofmodalities-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_contrib</span>(ACM_bird, <span class="at">choice=</span><span class="st">'var'</span>, <span class="at">axes=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analyse_Birds_files/figure-html/contributionsofmodalities-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Letâs print only the modalities above the thresold of 1/n, n is the number of modalities, and the modalities above this thresold are significantly contributing to the MCA.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We set the thresold for significant modalities</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>threshold <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">/</span><span class="fu">nrow</span>(ACM_bird<span class="sc">$</span>var<span class="sc">$</span>contrib))<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a><span class="co"># We extract significant contributions for dim 1</span></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>var_contrib <span class="ot">&lt;-</span> <span class="fu">get_mca_var</span>(ACM_bird)<span class="sc">$</span>contrib</span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>significant_vars_dim1 <span class="ot">&lt;-</span> <span class="fu">rownames</span>(var_contrib)[var_contrib[, <span class="dv">1</span>] <span class="sc">&gt;</span> threshold]</span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(significant_vars_dim1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We extract significant contributions for dim 2</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>significant_vars_dim2 <span class="ot">&lt;-</span> <span class="fu">rownames</span>(var_contrib)[var_contrib[, <span class="dv">2</span>] <span class="sc">&gt;</span> threshold]</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(significant_vars_dim2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>significant_vars_tot <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(significant_vars_dim1, significant_vars_dim2))</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(significant_vars_tot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 24</code></pre>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># There is 24 significant modalities on dimension 1 and 2. Let's print them on the graph</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_mca_var</span>(ACM_bird, <span class="at">col.var=</span><span class="st">'blue'</span>, <span class="at">repel =</span> T, <span class="at">alpha.var =</span> <span class="st">"contrib"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analyse_Birds_files/figure-html/printcontributingmodalities-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_mca_var</span>(ACM_bird, <span class="at">col.var=</span><span class="st">'blue'</span>, <span class="at">repel =</span> T, <span class="at">select.var =</span> <span class="fu">list</span>(<span class="at">contrib =</span> <span class="dv">24</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analyse_Birds_files/figure-html/printcontributingmodalities-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Representation of the individuals between axis 1 and 2, coloring for each variable</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plotellipses</span>(ACM_bird, <span class="at">means =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analyse_Birds_files/figure-html/printindividals_modalities-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can see that the nests are clearly separated by the state they come from. We can see a light shift on axis 2 with the nest fate values. The other variables are forming less distinct groups.</p>
<p>On axis 1, the most contributing variable is the state Illinois. It is associated with the specie Dickcissel, with the county Will and Lee/Ogle, years 1994-1996, and the warm season on Grassland. On the other side of the axis, the specie Savannah Sparrow is higly associated with years 2000-2002, and also with the county Lafayette and Iowa and the state Wisconsin.</p>
<p>On axis 2, the most contributing variable is the county Dane, and associated with years 2006-2008 and cool season Grassland. It is also associated with the specie Bobolink, the nest fate equal 1, and the number fledged superior or equal to 5. To say otherwise, the nesting birds have a better success in the county Dane, especially between 2006 and 2008 and during the cool season in grasslands. The specie Bobolink is also highly successive in nesting a lot of chicks. On the other side of the axis, the variable significantly contributing are years 1997-1999, state Illinois, nest end in July, habitat pasture and county Jo Daviess, with nest fate 0 and number fledged 0. Therefore, it is most likely that these conditions are decreasing the probabilities of success in nesting chicks.</p>
</section>
</section>
</section>
<section id="ii.-analysing-the-relationship-between-nest-fate-and-county-habitat-species-year-initiation-date-using-a-generalized-linear-model-glm-with-a-binomial-distribution" class="level1">
<h1>II. Analysing the relationship between nest fate and county, habitat, species, year, initiation date using a generalized linear model (GLM) with a binomial distribution</h1>
<section id="a.-data-exploration" class="level2">
<h2 class="anchored" data-anchor-id="a.-data-exploration">A. Data Exploration</h2>
<p>In this part we choose to explain the nest fate with different variables. We chose to focus on the state of Illinois because adding the state might lead to bad modelling as there might be not enough data for each of them.</p>
<p>Variables are :</p>
<ul>
<li><em>Nest_Fate</em> : Response variable, binary</li>
<li><em>County</em> : qualitative explanatory variable</li>
<li><em>Habitat</em> : qualitative explanatory variable</li>
<li><em>Species</em> : qualitative explanatory variable</li>
<li><em>Year</em> : qualitative explanatory variable</li>
<li><em>Initiation_Date</em> : Quantitative explanatory variable</li>
</ul>
<p><strong>Aim of the study</strong> : We want to model the fate of the nest as a response of the County, the Habitat, the Species, the Year, the Initiation date. We are looking for a model that could explain the distribution of Nest fate.</p>
<p><strong>Method</strong> : Here our response variable is either a sucess or a failure. This response follows a <strong>binomial distribution</strong> with the probability density function <span class="math display">\[P(X = k) = \binom{n}{k} p^k (1-p)^{n-k}\]</span></p>
<p>The term <span class="math display">\[ \binom{n}{k} \]</span> is the binomial coefficient, which represents the number of ways to choose ( k ) successes from ( n ) trials.</p>
<p><span class="math display">\[ p \]</span> is the probability of success on a single trial.</p>
<p><span class="math display">\[1 - p\]</span> is the probability of failure on a single trial.</p>
<p>Every statistical analysis starts with the exploration of the dataset.</p>
<section id="outlier-in-y" class="level3">
<h3 class="anchored" data-anchor-id="outlier-in-y">Outlier in <span class="math inline">\(Y\)</span></h3>
<p>Here we are checking the values of Y (the values of Nest Fate)</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of 0 and 1 in Y</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(data_Illinois<span class="sc">$</span>Nest_Fate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
  0   1 
736 337 </code></pre>
</div>
</div>
<p>According to the results table, it appears that overall, there are roughly twice as many failures as successes.</p>
</section>
<section id="for-quantitative-xs-outlier-and-distribution-of-x-values" class="level3">
<h3 class="anchored" data-anchor-id="for-quantitative-xs-outlier-and-distribution-of-x-values">For quantitative Xs : outlier and distribution of <span class="math inline">\(X\)</span> values</h3>
<p>Here we have one quantitative explanatory variable <span class="math inline">\(X\)</span>. We check its distribution and if there is any outlier value.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Length</span></span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Cleveland plot</span></span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dotchart</span>(data_Illinois<span class="sc">$</span>Initiation_Date,<span class="at">pch=</span><span class="dv">16</span>,<span class="at">col=</span><span class="st">'dodgerblue3'</span>,<span class="at">xlab=</span><span class="st">'Initiation Date'</span>)</span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram</span></span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data_Illinois<span class="sc">$</span>Initiation_Date,<span class="at">col=</span><span class="st">'dodgerblue3'</span>,<span class="at">xlab=</span><span class="st">"Initiation Date"</span>,<span class="at">main=</span><span class="st">""</span>)</span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Quantile-Quantile plot</span></span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(data_Illinois<span class="sc">$</span>Initiation_Date,<span class="at">pch=</span><span class="dv">16</span>,<span class="at">col=</span><span class="st">'dodgerblue3'</span>,<span class="at">xlab=</span><span class="st">''</span>)</span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(data_Illinois<span class="sc">$</span>Initiation_Date,<span class="at">col=</span><span class="st">'red'</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Analyse_Birds_files/figure-html/dataCov-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>We do not observe any outliers and it seems that the initiation date of the nesting period follows a normal distribution.</p>
</section>
<section id="for-each-qualitative-explanatory-variable-x-modalities-and-number-of-individuals-for-each-of-them" class="level3">
<h3 class="anchored" data-anchor-id="for-each-qualitative-explanatory-variable-x-modalities-and-number-of-individuals-for-each-of-them">For each qualitative explanatory variable <span class="math inline">\(X\)</span> : Modalities and number of individuals for each of them</h3>
<p>We need to analyse the modalities and the number of individuals for each modality.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: true</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-fold: true</span></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a><span class="co">#| code-summary: "Show the code"</span></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Factor County</span></span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data_Illinois<span class="sc">$</span>County)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Carroll Carroll/Whiteside              Dane             Grant 
               15                 5                 0                 0 
            Green            Grundy              Iowa        Jo_Daviess 
                0                53                 0               292 
        Lafayette               Lee          Lee/Ogle            Monroe 
                0                20               297                 0 
             Rock              Will 
                0               391 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Factor Habitat</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data_Illinois<span class="sc">$</span>Habitat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cool-season_Grassland               Pasture               Prairie 
                  242                   537                   137 
Warm-season_Grassland 
                  157 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Factor Species</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data_Illinois<span class="sc">$</span>Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Bobolink          Dickcissel  Eastern_Meadowlark Grasshopper_Sparrow 
                 62                 314                 229                 350 
  Henslow's_Sparrow    Savannah_Sparrow      Vesper_Sparrow  Western_Meadowlark 
                  5                  13                  54                  46 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Factor Year</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data_Illinois<span class="sc">$</span>Year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1995 1996 1997 1998 2007 2008 2009 
 166  261  330  166   52   60   38 </code></pre>
</div>
</div>
<p>The results tables provided by our script show different things. First of all for the <strong>County</strong> variable we can observe that some counties have very little records. For example Carrol/Whiteside has 5 records of nest while counties like Jo Daviess have 292 records. This could lead to mis-modelling so attention on the model results is necessary. For <strong>Habitat</strong> variable it seems that one habitat in particular (Pasture) has more records than the other. For the <strong>Species</strong> variable, similarly to county variable, we observe that some species have more records than others. We observe the same for the <strong>Year</strong> variable.</p>
</section>
<section id="relationships-between-y-and-xs" class="level3">
<h3 class="anchored" data-anchor-id="relationships-between-y-and-xs">Relationships between Y and Xs ?</h3>
<p>We can then analyse graphically if we might have relationships between <span class="math inline">\(Y\)</span> and <span class="math inline">\(Xs\)</span>.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">2</span>) <span class="sc">+</span> <span class="fl">0.1</span>) </span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Initiation_Date</span></span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(data_Illinois<span class="sc">$</span>Nest_Fate <span class="sc">~</span> data_Illinois<span class="sc">$</span>Initiation_Date, </span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch=</span><span class="dv">16</span>, </span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="st">'dodgerblue3'</span>,</span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">'Initiation_Date'</span>, </span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">'Nest_Fate'</span>,</span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.lab=</span><span class="fl">1.2</span>,  </span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.axis=</span><span class="fl">1.2</span>)</span>
<span id="cb135-11"><a href="#cb135-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-12"><a href="#cb135-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the color palette</span></span>
<span id="cb135-13"><a href="#cb135-13" aria-hidden="true" tabindex="-1"></a>color <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'dodgerblue3'</span>, <span class="st">'darkred'</span>, <span class="st">'forestgreen'</span>, <span class="st">'gold'</span>, </span>
<span id="cb135-14"><a href="#cb135-14" aria-hidden="true" tabindex="-1"></a>           <span class="st">'purple'</span>, <span class="st">'orange'</span>, <span class="st">'cyan'</span>, <span class="st">'magenta'</span>, </span>
<span id="cb135-15"><a href="#cb135-15" aria-hidden="true" tabindex="-1"></a>           <span class="st">'salmon'</span>, <span class="st">'lightseagreen'</span>, <span class="st">'plum'</span>, </span>
<span id="cb135-16"><a href="#cb135-16" aria-hidden="true" tabindex="-1"></a>           <span class="st">'yellowgreen'</span>, <span class="st">'sandybrown'</span>, <span class="st">'steelblue'</span>)</span>
<span id="cb135-17"><a href="#cb135-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-18"><a href="#cb135-18" aria-hidden="true" tabindex="-1"></a><span class="co"># County</span></span>
<span id="cb135-19"><a href="#cb135-19" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaicplot</span>(data_Illinois<span class="sc">$</span>Nest_Fate <span class="sc">~</span> data_Illinois<span class="sc">$</span>County, </span>
<span id="cb135-20"><a href="#cb135-20" aria-hidden="true" tabindex="-1"></a>           <span class="at">col =</span> color, </span>
<span id="cb135-21"><a href="#cb135-21" aria-hidden="true" tabindex="-1"></a>           <span class="at">main=</span><span class="st">""</span>, </span>
<span id="cb135-22"><a href="#cb135-22" aria-hidden="true" tabindex="-1"></a>           <span class="at">cex.axis=</span><span class="fl">0.8</span>,  </span>
<span id="cb135-23"><a href="#cb135-23" aria-hidden="true" tabindex="-1"></a>           <span class="at">las=</span><span class="dv">2</span>)        </span>
<span id="cb135-24"><a href="#cb135-24" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Relationship Nest Fate &amp; County"</span>, <span class="at">cex.main=</span><span class="fl">1.2</span>)  </span>
<span id="cb135-25"><a href="#cb135-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-26"><a href="#cb135-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Habitat</span></span>
<span id="cb135-27"><a href="#cb135-27" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaicplot</span>(data_Illinois<span class="sc">$</span>Nest_Fate <span class="sc">~</span> data_Illinois<span class="sc">$</span>Habitat, </span>
<span id="cb135-28"><a href="#cb135-28" aria-hidden="true" tabindex="-1"></a>           <span class="at">col =</span> color[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],  </span>
<span id="cb135-29"><a href="#cb135-29" aria-hidden="true" tabindex="-1"></a>           <span class="at">main=</span><span class="st">""</span>,  </span>
<span id="cb135-30"><a href="#cb135-30" aria-hidden="true" tabindex="-1"></a>           <span class="at">cex.axis=</span><span class="fl">0.8</span>,</span>
<span id="cb135-31"><a href="#cb135-31" aria-hidden="true" tabindex="-1"></a>           <span class="at">las=</span><span class="dv">2</span>)</span>
<span id="cb135-32"><a href="#cb135-32" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Relationship Nest Fate &amp; Habitat"</span>, <span class="at">cex.main=</span><span class="fl">1.2</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Analyse_Birds_files/figure-html/datagraph-1.png" class="img-fluid" width="960"></p>
</div>
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Species</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaicplot</span>(data_Illinois<span class="sc">$</span>Nest_Fate <span class="sc">~</span> data_Illinois<span class="sc">$</span>Species, </span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">col =</span> color[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>],  </span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">main=</span><span class="st">""</span>, </span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">cex.axis=</span><span class="fl">0.8</span>,</span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">las=</span><span class="dv">2</span>)</span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Relationship Nest Fate &amp; Species"</span>, <span class="at">cex.main=</span><span class="fl">1.2</span>)  </span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Year</span></span>
<span id="cb136-10"><a href="#cb136-10" aria-hidden="true" tabindex="-1"></a><span class="fu">mosaicplot</span>(data_Illinois<span class="sc">$</span>Nest_Fate <span class="sc">~</span> data_Illinois<span class="sc">$</span>Year, </span>
<span id="cb136-11"><a href="#cb136-11" aria-hidden="true" tabindex="-1"></a>           <span class="at">col =</span> color[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>],  </span>
<span id="cb136-12"><a href="#cb136-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">main=</span><span class="st">""</span>, </span>
<span id="cb136-13"><a href="#cb136-13" aria-hidden="true" tabindex="-1"></a>           <span class="at">cex.axis=</span><span class="fl">0.8</span>,</span>
<span id="cb136-14"><a href="#cb136-14" aria-hidden="true" tabindex="-1"></a>           <span class="at">las=</span><span class="dv">2</span>)</span>
<span id="cb136-15"><a href="#cb136-15" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Relationship Nest Fate &amp; Year"</span>, <span class="at">cex.main=</span><span class="fl">1.2</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Analyse_Birds_files/figure-html/datagraph-2.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>Looking at those graphs it doesnât seems like the <strong>Initiation_date</strong>, the <strong>County</strong> or the <strong>Habitat</strong> has any effects on the <strong>Nest_fate</strong>. Maybe a little bit for <strong>County</strong> but the statistical analysis afterward will enable us to have more information on which variable has an effect. For the <strong>Year</strong> and the <strong>Species</strong> we might observe a little difference, but still really light.</p>
</section>
<section id="analysing-interaction-between-xs" class="level3">
<h3 class="anchored" data-anchor-id="analysing-interaction-between-xs">Analysing interaction between Xs</h3>
<p>In any modelling approach there is a need to check for interactions between variables. In our study we judge that there is none.</p>
</section>
<section id="checking-collinearity-between-xs" class="level3">
<h3 class="anchored" data-anchor-id="checking-collinearity-between-xs">Checking collinearity between <span class="math inline">\(Xs\)</span></h3>
<p>To avoid multicollinearity in modeling, we need to analyze how the explanatory variables <span class="math inline">\(X_s\)</span> are related. It is important to check for collinearity. Indeed if some variables are correlated they measure the same thing and therefore keeping both of them might lead to bad prediction.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Checking collinearity between qualitative explanatory variable</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Contingency table between County and Habitat</span></span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(data_Illinois<span class="sc">$</span>County, data_Illinois<span class="sc">$</span>Habitat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                   
                    Cool-season_Grassland Pasture Prairie Warm-season_Grassland
  Carroll                               0       0      15                     0
  Carroll/Whiteside                     0       0       5                     0
  Dane                                  0       0       0                     0
  Grant                                 0       0       0                     0
  Green                                 0       0       0                     0
  Grundy                                0       6      26                    21
  Iowa                                  0       0       0                     0
  Jo_Daviess                            7     264       7                    14
  Lafayette                             0       0       0                     0
  Lee                                   4      12       4                     0
  Lee/Ogle                            104      39      58                    96
  Monroe                                0       0       0                     0
  Rock                                  0       0       0                     0
  Will                                127     216      22                    26</code></pre>
</div>
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Contingency table between Species and Year</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(data_Illinois<span class="sc">$</span>Species, data_Illinois<span class="sc">$</span>Year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                     
                      1995 1996 1997 1998 2007 2008 2009
  Bobolink              14   22   20    1    2    1    2
  Dickcissel            50   60   83   27   35   31   28
  Eastern_Meadowlark    46  119   41   13    5    1    4
  Grasshopper_Sparrow   41   50  128   93   10   25    3
  Henslow's_Sparrow      4    1    0    0    0    0    0
  Savannah_Sparrow       7    3    3    0    0    0    0
  Vesper_Sparrow         4    6   28   13    0    2    1
  Western_Meadowlark     0    0   27   19    0    0    0</code></pre>
</div>
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Contingency table between Habitat and Species</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(data_Illinois<span class="sc">$</span>Habitat, data_Illinois<span class="sc">$</span>Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                       
                        Bobolink Dickcissel Eastern_Meadowlark
  Cool-season_Grassland       18        162                 42
  Pasture                     37         60                130
  Prairie                      7         37                 39
  Warm-season_Grassland        0         55                 18
                       
                        Grasshopper_Sparrow Henslow's_Sparrow Savannah_Sparrow
  Cool-season_Grassland                  13                 4                2
  Pasture                               220                 0                7
  Prairie                                49                 1                0
  Warm-season_Grassland                  68                 0                4
                       
                        Vesper_Sparrow Western_Meadowlark
  Cool-season_Grassland              1                  0
  Pasture                           37                 46
  Prairie                            4                  0
  Warm-season_Grassland             12                  0</code></pre>
</div>
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplots to check for relationship between Initiation_Date and the qualitative explanatory variables</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Initiation_Date and County</span></span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(data_Illinois<span class="sc">$</span>Initiation_Date <span class="sc">~</span> data_Illinois<span class="sc">$</span>County, </span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab=</span><span class="st">"County"</span>, </span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab=</span><span class="st">"Initiation Date"</span>, </span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">cex.axis=</span><span class="fl">0.8</span>)          </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Analyse_Birds_files/figure-html/datacolin-1.png" class="img-fluid" width="768"></p>
</div>
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Initiation_Date and Habitat</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(data_Illinois<span class="sc">$</span>Initiation_Date <span class="sc">~</span> data_Illinois<span class="sc">$</span>Habitat, </span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab=</span><span class="st">"Habitat"</span>, </span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab=</span><span class="st">"Initiation Date"</span>, </span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">cex.axis=</span><span class="fl">0.8</span>)         </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Analyse_Birds_files/figure-html/datacolin-2.png" class="img-fluid" width="768"></p>
</div>
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Initiation_Date and Species</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(data_Illinois<span class="sc">$</span>Initiation_Date <span class="sc">~</span> data_Illinois<span class="sc">$</span>Species, </span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab=</span><span class="st">"Species"</span>, </span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab=</span><span class="st">"Initiation Date"</span>, </span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">cex.axis=</span><span class="fl">0.4</span>)         </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Analyse_Birds_files/figure-html/datacolin-3.png" class="img-fluid" width="768"></p>
</div>
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Initiation_Date and Year</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(data_Illinois<span class="sc">$</span>Initiation_Date <span class="sc">~</span> data_Illinois<span class="sc">$</span>Year, </span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab=</span><span class="st">"Year"</span>, </span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab=</span><span class="st">"Initiation Date"</span>, </span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">cex.axis=</span><span class="fl">0.8</span>)         </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Analyse_Birds_files/figure-html/datacolin-4.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>Here it seems that there is a strong collinearity between <em>County</em> and <em>Habitat</em> as well as between <strong>Species</strong> and <strong>Year</strong> and also between <strong>Species</strong> and <strong>Habitat</strong>. Therefore, we are not going to keep <strong>County</strong>, <strong>Habitat</strong> and <strong>Year</strong> as explanatory variables in our model.</p>
</section>
</section>
<section id="b.-statistical-analysis" class="level2">
<h2 class="anchored" data-anchor-id="b.-statistical-analysis">B. Statistical Analysis</h2>
<section id="model-building-up" class="level3">
<h3 class="anchored" data-anchor-id="model-building-up">Model building up</h3>
<p>Because our response variable is a binary variable that follows a binomial distribution we have a link function : <strong>the logit</strong>.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model formulation</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>mod1<span class="ot">&lt;-</span><span class="fu">glm</span>(Nest_Fate<span class="sc">~</span>Species</span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> Initiation_Date</span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a>        ,<span class="at">data=</span>data_Illinois</span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a>        ,<span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span><span class="st">"logit"</span>))</span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Then we check for significance</span></span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(mod1,<span class="at">test=</span><span class="st">"Chi"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Single term deletions

Model:
Nest_Fate ~ Species + Initiation_Date
                Df Deviance    AIC    LRT  Pr(&gt;Chi)    
&lt;none&gt;               1296.3 1314.3                     
Species          7   1334.0 1338.0 37.701 3.453e-06 ***
Initiation_Date  1   1296.4 1312.4  0.029    0.8656    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>The results table shows that Initiation_Date is not significant. However the AIC with Initiation_Date is better which means we should keep this variable despite its lack of significance.</p>
</section>
<section id="model-coefficient-and-its-equation" class="level3">
<h3 class="anchored" data-anchor-id="model-coefficient-and-its-equation">Model coefficient and its equation</h3>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficients of the model</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Nest_Fate ~ Species + Initiation_Date, family = binomial(link = "logit"), 
    data = data_Illinois)

Coefficients:
                            Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)                -1.097853   0.381114  -2.881  0.00397 **
SpeciesDickcissel           0.189410   0.329713   0.574  0.56565   
SpeciesEastern_Meadowlark  -0.382551   0.335541  -1.140  0.25424   
SpeciesGrasshopper_Sparrow  0.664586   0.315297   2.108  0.03505 * 
SpeciesHenslow's_Sparrow   -0.327407   1.155216  -0.283  0.77686   
SpeciesSavannah_Sparrow    -0.655641   0.822713  -0.797  0.42549   
SpeciesVesper_Sparrow       0.180147   0.420980   0.428  0.66871   
SpeciesWestern_Meadowlark   0.961508   0.416342   2.309  0.02092 * 
Initiation_Date             0.000686   0.004052   0.169  0.86557   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1335.5  on 1072  degrees of freedom
Residual deviance: 1296.3  on 1064  degrees of freedom
AIC: 1314.3

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
<p>The following equation is the one of the model : <span class="math display">\[\log\left(\frac{p}{1-p}\right) = -1.097853 + 0.189410 \cdot \text{Species}_{\text{Dickcissel}} - 0.382551 \cdot \text{Species}_{\text{Eastern Meadowlark}} + 0.664586 \cdot \text{Species}_{\text{Grasshopper Sparrow}} - 0.327407 \cdot \text{Species}_{\text{Henslow's Sparrow}} - 0.655641 \cdot \text{Species}_{\text{Savannah Sparrow}} + 0.180147 \cdot \text{Species}_{\text{Vesper Sparrow}} + 0.961508 \cdot \text{Species}_{\text{Western Meadowlark}} + 0.000686 \cdot \text{Initiation\_Date}\]</span></p>
<p>where <span class="math inline">\(p\)</span> is the probability that the event is true.</p>
<ul>
<li><strong>Intercept (-1.097853)</strong>: The value of the log-odds when all explanatory variables are zero.</li>
<li><strong>Species Dickcissel (0.189410)</strong>: A positive coefficient, but not significant ((p = 0.56565)), indicating that the effect of this species on the chances of nest success is not statistically significant.</li>
<li><strong>Species Eastern Meadowlark (-0.382551)</strong>: A negative coefficient, not significant ((p = 0.25424)).</li>
<li><strong>Species Grasshopper Sparrow (0.664586)</strong>: A positive and significant coefficient ((p = 0.03505)), suggesting that this species increases the chances of nest success.</li>
<li><strong>Species Henslowâs Sparrow (-0.327407)</strong>: A negative coefficient, not significant ((p = 0.77686)).</li>
<li><strong>Species Savannah Sparrow (-0.655641)</strong>: A negative coefficient, not significant ((p = 0.42549)).</li>
<li><strong>Species Vesper Sparrow (0.180147)</strong>: A positive coefficient, not significant ((p = 0.66871)).</li>
<li><strong>Species Western Meadowlark (0.961508)</strong>: A positive and significant coefficient ((p = 0.02092)).</li>
<li><strong>Initiation Date (0.000686)</strong>: A positive coefficient, but not significant ((p = 0.86557)), indicating that it does not have a statistically significant effect on nest success.</li>
</ul>
</section>
<section id="explanation-provided-by-the-model" class="level3">
<h3 class="anchored" data-anchor-id="explanation-provided-by-the-model">Explanation provided by the model</h3>
<p>One way to evaluate the goodness of fit for our models is to assess the difference between our model and the null model (which summarizes the data with a single parameter: the mean ofð) Y). This null model essentially explains nothing. To do so we calculate a parameter, <span class="math display">\[{pseudo}-R^2\]</span> by examining the distance between the deviance of the null model and the residual deviance of our model.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate of deviance explained</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>(mod1<span class="sc">$</span>null.deviance<span class="sc">-</span>mod1<span class="sc">$</span>deviance)<span class="sc">/</span>mod1<span class="sc">$</span>null.deviance</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0293313</code></pre>
</div>
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Some others estimates of deviance explained - package 'rcompanion'</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nagelkerke</span>(mod1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$Models
                                                                                              
Model: "glm, Nest_Fate ~ Species + Initiation_Date, binomial(link = \"logit\"), data_Illinois"
Null:  "glm, Nest_Fate ~ 1, binomial(link = \"logit\"), data_Illinois"                        

$Pseudo.R.squared.for.model.vs.null
                             Pseudo.R.squared
McFadden                            0.0293313
Cox and Snell (ML)                  0.0358486
Nagelkerke (Cragg and Uhler)        0.0503523

$Likelihood.ratio.test
 Df.diff LogLik.diff  Chisq    p.value
      -8     -19.586 39.172 4.5671e-06

$Number.of.observations
           
Model: 1073
Null:  1073

$Messages
[1] "Note: For models fit with REML, these statistics are based on refitting with ML"

$Warnings
[1] "None"</code></pre>
</div>
</div>
<p>According to this table, the estimate of the explained deviance is <strong>2.9%</strong> which is very low.</p>
</section>
</section>
<section id="c.-model-validation" class="level2">
<h2 class="anchored" data-anchor-id="c.-model-validation">C. Model validation</h2>
<section id="checking-for-influential-individuals" class="level3">
<h3 class="anchored" data-anchor-id="checking-for-influential-individuals">Checking for influential individuals</h3>
<p>We make sure that there is no influential individuals.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">cooks.distance</span>(mod1), <span class="at">type =</span> <span class="st">"h"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="dv">2</span>,<span class="at">lwd =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Analyse_Birds_files/figure-html/Contri-1.png" class="img-fluid" width="384"></p>
</div>
</div>
<p>The graph does not show any influential individuals.</p>
</section>
<section id="prediction-with-different-data" class="level3">
<h3 class="anchored" data-anchor-id="prediction-with-different-data">Prediction with different data</h3>
<p>Here we want to assess if our model is able to well-classify nest based on our data.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We could do a simulation</span></span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>N    <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data_Illinois)</span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a>Pi   <span class="ot">&lt;-</span> <span class="fu">fitted</span>(mod1)</span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a>data_Illinois<span class="sc">$</span>Ysim <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(N, <span class="at">size =</span> <span class="dv">1</span>, Pi)</span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Classification table</span></span>
<span id="cb156-6"><a href="#cb156-6" aria-hidden="true" tabindex="-1"></a>Z <span class="ot">&lt;-</span> <span class="fu">table</span>(data_Illinois<span class="sc">$</span>Nest_Fate, data_Illinois<span class="sc">$</span>Ysim) <span class="sc">/</span> N</span>
<span id="cb156-7"><a href="#cb156-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(Z) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Observed 0"</span>, <span class="st">"Observed 1"</span>)</span>
<span id="cb156-8"><a href="#cb156-8" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(Z) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Predicted 0"</span>, <span class="st">"Predicted 1"</span>)</span>
<span id="cb156-9"><a href="#cb156-9" aria-hidden="true" tabindex="-1"></a>Z</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            
             Predicted 0 Predicted 1
  Observed 0   0.4659832   0.2199441
  Observed 1   0.2041007   0.1099720</code></pre>
</div>
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Correctly classified:</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">diag</span>(Z))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5759553</code></pre>
</div>
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="co"># And repeat this 1000 times, store the results and calculate an average classification table</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a>Pi   <span class="ot">&lt;-</span> <span class="fu">fitted</span>(mod1)</span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a>N    <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data_Illinois)                 </span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a>NSim <span class="ot">&lt;-</span> <span class="dv">1000</span>                           </span>
<span id="cb160-6"><a href="#cb160-6" aria-hidden="true" tabindex="-1"></a>diagZ<span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> N, <span class="at">ncol =</span> NSim)</span>
<span id="cb160-7"><a href="#cb160-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>NSim) {</span>
<span id="cb160-8"><a href="#cb160-8" aria-hidden="true" tabindex="-1"></a>  Ysim <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(N, <span class="at">size =</span> <span class="dv">1</span>, Pi)</span>
<span id="cb160-9"><a href="#cb160-9" aria-hidden="true" tabindex="-1"></a>  Z<span class="ot">&lt;-</span> <span class="fu">table</span>(data_Illinois<span class="sc">$</span>Nest_Fate, Ysim) <span class="sc">/</span> N</span>
<span id="cb160-10"><a href="#cb160-10" aria-hidden="true" tabindex="-1"></a>  diagZ[,i]<span class="ot">&lt;-</span><span class="fu">sum</span>(<span class="fu">diag</span>(Z))</span>
<span id="cb160-11"><a href="#cb160-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb160-12"><a href="#cb160-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Average rate of individuals well-classified by the model</span></span>
<span id="cb160-13"><a href="#cb160-13" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(diagZ[<span class="dv">2</span>,], <span class="at">col=</span><span class="st">'dodgerblue3'</span>,<span class="at">ylab=</span><span class="st">'#Rate of nest fate well-classified'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Analyse_Birds_files/figure-html/Simul-1.png" class="img-fluid" width="384"></p>
</div>
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(diagZ[<span class="dv">2</span>,])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5848928</code></pre>
</div>
</div>
<p>Here we have <strong>58%</strong> of good predictions, which is somewhat below the common threshold of 70% for a model to be considered good. This suggests that the model may need improvement.</p>
<p>This result is not surprising given our initial data. Because they are from different studies some variables barely contains some species or years, etcâ¦ This could explain why our model is not suitable.</p>
</section>
</section>
</section>
<section id="iii.-analysing-the-relationship-between-nest-fate-and-county-habitat-species-year-initiation-date-using-a-generalized-linear-model-glm-with-a-poisson-distribution" class="level1">
<h1>III. Analysing the relationship between nest fate and county, habitat, species, year, initiation date using a generalized linear model (GLM) with a Poisson distribution</h1>
<section id="variables-presentation" class="level2">
<h2 class="anchored" data-anchor-id="variables-presentation">Variables presentation:</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Nest_Fate <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(data<span class="sc">$</span>Nest_Fate)</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>County <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(data<span class="sc">$</span>County)</span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Habitat <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(data<span class="sc">$</span>Habitat)</span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Year <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(data<span class="sc">$</span>Year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><em>County</em> : the county in the state where the state has been found. 14 levels factor.</li>
<li><em>Habitat</em> : the type of habitat in which the nest has been found. 4 levels factor.</li>
<li><em>Species</em> : the species of the bird that has build the nest. 8 levels factor.</li>
<li><em>Year</em> : the year of the nest building. 21 levels factor.</li>
<li><em>Number_Fledged</em> : the number of birds that hatch on the nest when they hatch. Quantitative variable.</li>
</ul>
<p>We want to study the impact of four qualitative variables, the habitat, the county, the species and the year over the number of young hatched in the nest <em>âNumber_Fledgedâ</em>. It is a counting variable, which imply that it follows a Poisson distribution. A negative binomial distribution could be used but is preferred when the count values are high (which is not really the case here since the highest value is of 6)</p>
<p>A Poisson law is used to describe rare, discrete and independent events. Hence the variable <span class="math inline">\(Y\)</span> that follows a Poisson distribution of parameter <span class="math inline">\(\lambda\)</span> is written: <span class="math display">\[Pr(Y=y)=\frac{e^{-\lambda}.\lambda^y}{y!}\]</span> where <span class="math inline">\(y\)</span> represent the value of the count (here <span class="math inline">\(y\)</span> â [0-6]) and <span class="math inline">\(\lambda\)</span> is the mean value and variance of the Poisson distribution (because in a Poisson law E(<span class="math inline">\(y\)</span>)= Var(<span class="math inline">\(y\)</span>)=<span class="math inline">\(\lambda\)</span>).</p>
</section>
<section id="a.-data-exploration-1" class="level2">
<h2 class="anchored" data-anchor-id="a.-data-exploration-1">A. Data exploration</h2>
<p>Before any analysis, it is important to have a look at the data.</p>
<section id="outlayer-values-in-the-response-variable-y-the-number-of-young-in-the-nest-number_fledged-and-values-distribution" class="level3">
<h3 class="anchored" data-anchor-id="outlayer-values-in-the-response-variable-y-the-number-of-young-in-the-nest-number_fledged-and-values-distribution">Outlayer values in the response variable <span class="math inline">\(Y\)</span> (the number of young in the nest, Number_Fledged) and values distribution:</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplot</span></span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(data<span class="sc">$</span>Number_Fledged,<span class="at">col=</span><span class="st">'dodgerblue3'</span>,<span class="at">ylab=</span><span class="st">'Number of young in nest'</span>)</span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Cleveland plot</span></span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dotchart</span>(data<span class="sc">$</span>Number_Fledged,<span class="at">pch=</span><span class="dv">16</span>,<span class="at">col=</span><span class="st">'dodgerblue3'</span>,<span class="at">xlab=</span><span class="st">'Number of young in nest'</span>)</span>
<span id="cb164-6"><a href="#cb164-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram</span></span>
<span id="cb164-7"><a href="#cb164-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data<span class="sc">$</span>Number_Fledged,<span class="at">col=</span><span class="st">'dodgerblue3'</span>,<span class="at">xlab=</span><span class="st">"Number of young in nest"</span>,<span class="at">main=</span><span class="st">""</span>)</span>
<span id="cb164-8"><a href="#cb164-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Quantile-Quantile plot</span></span>
<span id="cb164-9"><a href="#cb164-9" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(data<span class="sc">$</span>Number_Fledged,<span class="at">pch=</span><span class="dv">16</span>,<span class="at">col=</span><span class="st">'dodgerblue3'</span>,<span class="at">xlab=</span><span class="st">''</span>)</span>
<span id="cb164-10"><a href="#cb164-10" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(data<span class="sc">$</span>Number_Fledged,<span class="at">col=</span><span class="st">'red'</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analyse_Birds_files/figure-html/poisson_datahist-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<p>There arenât any outlayer values. There are a lot of value at 0. Maybe we can study only the number of young when there are some. It could be a normal distribution.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get rid of the lines where the Number of young individuals in the nest is equal to 0</span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>data_filtered <span class="ot">&lt;-</span> <span class="fu">subset</span>(data, Number_Fledged <span class="sc">!=</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplot</span></span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(data_filtered<span class="sc">$</span>Number_Fledged,<span class="at">col=</span><span class="st">'dodgerblue3'</span>,<span class="at">ylab=</span><span class="st">'Number of young in nest'</span>)</span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Cleveland plot</span></span>
<span id="cb166-5"><a href="#cb166-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dotchart</span>(data_filtered<span class="sc">$</span>Number_Fledged,<span class="at">pch=</span><span class="dv">16</span>,<span class="at">col=</span><span class="st">'dodgerblue3'</span>,<span class="at">xlab=</span><span class="st">'Number of young in nest'</span>)</span>
<span id="cb166-6"><a href="#cb166-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram</span></span>
<span id="cb166-7"><a href="#cb166-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data_filtered<span class="sc">$</span>Number_Fledged,<span class="at">col=</span><span class="st">'dodgerblue3'</span>,<span class="at">xlab=</span><span class="st">"Number of young in nest"</span>,<span class="at">main=</span><span class="st">""</span>)</span>
<span id="cb166-8"><a href="#cb166-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Quantile-Quantile plot</span></span>
<span id="cb166-9"><a href="#cb166-9" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(data_filtered<span class="sc">$</span>Number_Fledged,<span class="at">pch=</span><span class="dv">16</span>,<span class="at">col=</span><span class="st">'dodgerblue3'</span>,<span class="at">xlab=</span><span class="st">''</span>)</span>
<span id="cb166-10"><a href="#cb166-10" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(data_filtered<span class="sc">$</span>Number_Fledged,<span class="at">col=</span><span class="st">'red'</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analyse_Birds_files/figure-html/poisson_datahist2-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<p>Now we have a better view of the data.</p>
</section>
<section id="outlayer-values-in-the-explanatory-variable-xs-and-values-distribution" class="level3">
<h3 class="anchored" data-anchor-id="outlayer-values-in-the-explanatory-variable-xs-and-values-distribution">Outlayer values in the explanatory variable <span class="math inline">\(Xs\)</span> and values distribution:</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Factor County</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data_filtered<span class="sc">$</span>County)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Carroll Carroll/Whiteside              Dane             Grant 
                5                 1               224                20 
            Green            Grundy              Iowa        Jo_Daviess 
               62                11               260               127 
        Lafayette               Lee          Lee/Ogle            Monroe 
              165                 6                85               103 
             Rock              Will 
                2               102 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Factor Habitat</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data_filtered<span class="sc">$</span>Habitat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Cool-season_Grassland               Pasture               Prairie 
                  273                   537                   180 
Warm-season_Grassland 
                  183 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Factor Species</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data_filtered<span class="sc">$</span>Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           Bobolink          Dickcissel  Eastern_Meadowlark Grasshopper_Sparrow 
                184                 163                 233                 280 
  Henslow's_Sparrow    Savannah_Sparrow      Vesper_Sparrow  Western_Meadowlark 
                 28                 196                  60                  29 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Factor Year</span></span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data_filtered<span class="sc">$</span>Year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1991 1992 1993 1994 1995 1996 1997 1998 1999 2000 2001 2002 2003 2004 2005 2006 
  35    4   13   13   73   45  120  137   98  131   66   75   20   44   27   57 
2007 2008 2009 2010 2011 
  46   73   24   50   22 </code></pre>
</div>
</div>
<p>Problem: there arenât the same number of observations in each level of each factors. Suggestion: normalize by the number of observation for each level.</p>
</section>
<section id="analyze-the-relation-between-y-and-xs" class="level3">
<h3 class="anchored" data-anchor-id="analyze-the-relation-between-y-and-xs">Analyze the relation between Y and Xs</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a><span class="co"># County</span></span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(Number_Fledged<span class="sc">~</span>County, <span class="at">varwidth =</span> <span class="cn">TRUE</span>, <span class="at">ylab =</span> <span class="st">"Number of young in nest"</span>, <span class="at">xlab =</span> <span class="st">"County"</span>, <span class="at">col=</span><span class="fu">terrain.colors</span>(<span class="dv">14</span>), <span class="at">main =</span> <span class="st">""</span>, <span class="at">data=</span>data_filtered)</span>
<span id="cb175-5"><a href="#cb175-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-6"><a href="#cb175-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Habitat</span></span>
<span id="cb175-7"><a href="#cb175-7" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(Number_Fledged<span class="sc">~</span>Habitat, <span class="at">varwidth =</span> <span class="cn">TRUE</span>, <span class="at">ylab =</span> <span class="st">"Number of young in nest"</span>, <span class="at">xlab =</span> <span class="st">"Habitat"</span>, <span class="at">col=</span><span class="fu">terrain.colors</span>(<span class="dv">4</span>), <span class="at">main =</span> <span class="st">""</span>,<span class="at">data=</span>data_filtered)</span>
<span id="cb175-8"><a href="#cb175-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-9"><a href="#cb175-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Species</span></span>
<span id="cb175-10"><a href="#cb175-10" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(Number_Fledged<span class="sc">~</span>Species, <span class="at">varwidth =</span> <span class="cn">TRUE</span>, <span class="at">ylab =</span> <span class="st">"Number of young in nest"</span>, <span class="at">xlab =</span> <span class="st">"Species"</span>, <span class="at">col=</span><span class="fu">terrain.colors</span>(<span class="dv">8</span>), <span class="at">main =</span> <span class="st">""</span>,<span class="at">data=</span>data_filtered)</span>
<span id="cb175-11"><a href="#cb175-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-12"><a href="#cb175-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Year</span></span>
<span id="cb175-13"><a href="#cb175-13" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(Number_Fledged<span class="sc">~</span>Year, <span class="at">varwidth =</span> <span class="cn">TRUE</span>, <span class="at">ylab =</span> <span class="st">"Number of young in nest"</span>, <span class="at">xlab =</span> <span class="st">"Year"</span>, <span class="at">col=</span><span class="fu">terrain.colors</span>(<span class="dv">21</span>), <span class="at">main =</span> <span class="st">""</span>,<span class="at">data=</span>data_filtered)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analyse_Birds_files/figure-html/poisson_datagraph-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Itâs not easy to see if the variables have an impact because some of them have a lot of levels, but it is possible to see small differences between them. The analysis will tell us if they really got an impact over the number of young in the nest.</p>
</section>
<section id="analyze-the-interactions-between-xs" class="level3">
<h3 class="anchored" data-anchor-id="analyze-the-interactions-between-xs">Analyze the interactions between Xs</h3>
<p>There are a lot of levels so itâs hard to plot the interactions. We will see if there are some in the analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Interactions between County &amp; Habitat</span></span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Number_Fledged<span class="sc">~</span>County,<span class="at">type=</span><span class="st">'n'</span>,<span class="at">ylab =</span> <span class="st">"Number of young in nest"</span>,<span class="at">xlab=</span><span class="st">"County"</span>, <span class="at">data=</span>data_filtered)</span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(Number_Fledged[Habitat<span class="sc">==</span><span class="st">"Pasture"</span>]<span class="sc">~</span>County[Habitat<span class="sc">==</span><span class="st">"Pasture"</span>],<span class="at">pch=</span><span class="dv">16</span>,<span class="at">cex=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">'#000099'</span>, <span class="at">data=</span>data_filtered)</span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(Number_Fledged[Habitat<span class="sc">==</span><span class="st">"Cool-season Grassland"</span>]<span class="sc">~</span>County[Habitat<span class="sc">==</span><span class="st">"Cool-season Grassland"</span>],<span class="at">pch=</span><span class="dv">16</span>,<span class="at">cex=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">'green'</span>, <span class="at">data=</span>data_filtered)</span>
<span id="cb176-6"><a href="#cb176-6" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(Number_Fledged[Habitat<span class="sc">==</span><span class="st">"Prairie"</span>]<span class="sc">~</span>County[Habitat<span class="sc">==</span><span class="st">"Prairie"</span>],<span class="at">pch=</span><span class="dv">16</span>,<span class="at">cex=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">'red'</span>, <span class="at">data=</span>data_filtered)</span>
<span id="cb176-7"><a href="#cb176-7" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(Number_Fledged[Habitat<span class="sc">==</span><span class="st">"Warm-season Grassland"</span>]<span class="sc">~</span>County[Habitat<span class="sc">==</span><span class="st">"Warm-season Grassland"</span>],<span class="at">pch=</span><span class="dv">16</span>,<span class="at">cex=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">'yellow'</span>, <span class="at">data=</span>data_filtered)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analyse_Birds_files/figure-html/poisson_dataInter-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>Here the example between county and habitat doesnât show a clear pattern. Itâs hard to conclude on the interaction aspect.</p>
</section>
<section id="checking-collinearity-between-categorical-independent-variables-xs" class="level3">
<h3 class="anchored" data-anchor-id="checking-collinearity-between-categorical-independent-variables-xs">Checking collinearity between categorical independent variables Xs:</h3>
<p>The following code only presents the contingency table between the variables Habitat and Species for convenience, but the same table has to be done with every couple of 4 variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a>contingency_table<span class="ot">&lt;-</span><span class="fu">table</span>(data_filtered<span class="sc">$</span>Habitat,data_filtered<span class="sc">$</span>Species)</span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(contingency_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                       
                        Bobolink Dickcissel Eastern_Meadowlark
  Cool-season_Grassland       89         51                 95
  Pasture                     53         26                 86
  Prairie                      2         21                 32
  Warm-season_Grassland       40         65                 20
                       
                        Grasshopper_Sparrow Henslow's_Sparrow Savannah_Sparrow
  Cool-season_Grassland                  13                21                4
  Pasture                               141                 0              189
  Prairie                                80                 1                0
  Warm-season_Grassland                  46                 6                3
                       
                        Vesper_Sparrow Western_Meadowlark
  Cool-season_Grassland              0                  0
  Pasture                           13                 29
  Prairie                           44                  0
  Warm-season_Grassland              3                  0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>chi2_test<span class="ot">&lt;-</span><span class="fu">chisq.test</span>(contingency_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in chisq.test(contingency_table): Chi-squared approximation may be
incorrect</code></pre>
</div>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chi2_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pearson's Chi-squared test

data:  contingency_table
X-squared = 748.71, df = 21, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(chi2_test<span class="sc">$</span>expected)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                       
                        Bobolink Dickcissel Eastern_Meadowlark
  Cool-season_Grassland 42.82353   37.93606           54.22762
  Pasture               84.23529   74.62148          106.66752
  Prairie               28.23529   25.01279           35.75448
  Warm-season_Grassland 28.70588   25.42967           36.35038
                       
                        Grasshopper_Sparrow Henslow's_Sparrow Savannah_Sparrow
  Cool-season_Grassland            65.16624          6.516624         45.61637
  Pasture                         128.18414         12.818414         89.72890
  Prairie                          42.96675          4.296675         30.07673
  Warm-season_Grassland            43.68286          4.368286         30.57801
                       
                        Vesper_Sparrow Western_Meadowlark
  Cool-season_Grassland      13.964194           6.749361
  Pasture                    27.468031          13.276215
  Prairie                     9.207161           4.450128
  Warm-season_Grassland       9.360614           4.524297</code></pre>
</div>
</div>
<p>Problem : for most of the variables the chiÂ² test canât be done because of the low number of values in each group. The only one that fulfill the conditions and therefore can be made is between Habitat and Species but the result shows that the variables are correlated.</p>
</section>
</section>
<section id="b.-statistical-analysis-1" class="level2">
<h2 class="anchored" data-anchor-id="b.-statistical-analysis-1">B. Statistical Analysis</h2>
<p>Now that we have a better idea of the data implied in this study, we can begin the statistical analysis.</p>
</section>
<section id="building-of-the-model" class="level2">
<h2 class="anchored" data-anchor-id="building-of-the-model">Building of the model</h2>
<p>Because our response variable follows a poisson distribution we use a link function : <strong>the log function</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model formulation</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>mod1<span class="ot">&lt;-</span><span class="fu">glm</span>(Number_Fledged<span class="sc">~</span> County</span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> Species</span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> Habitat</span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> Year</span>
<span id="cb185-6"><a href="#cb185-6" aria-hidden="true" tabindex="-1"></a>        ,<span class="at">data=</span>data_filtered</span>
<span id="cb185-7"><a href="#cb185-7" aria-hidden="true" tabindex="-1"></a>        ,<span class="at">family=</span><span class="fu">poisson</span>(<span class="at">link=</span><span class="st">"log"</span>))</span>
<span id="cb185-8"><a href="#cb185-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Variable type : poisson. Link fonction : log</span></span>
<span id="cb185-9"><a href="#cb185-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Then we check for significance</span></span>
<span id="cb185-10"><a href="#cb185-10" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(mod1,<span class="at">test=</span><span class="st">"Chi"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Single term deletions

Model:
Number_Fledged ~ County + Species + Habitat + Year
        Df Deviance    AIC     LRT Pr(&gt;Chi)   
&lt;none&gt;       541.13 4125.3                    
County  13   557.02 4115.2 15.8822 0.255551   
Species  7   560.94 4131.1 19.8043 0.006008 **
Habitat  3   541.44 4119.6  0.3096 0.958219   
Year    20   551.54 4095.7 10.4077 0.960163   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>We decide to remove the less significative variable : here itâs Year.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model formulation</span></span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a>mod1<span class="ot">&lt;-</span><span class="fu">glm</span>(Number_Fledged<span class="sc">~</span> County</span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> Species</span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> Habitat</span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a>        ,<span class="at">data=</span>data_filtered</span>
<span id="cb187-6"><a href="#cb187-6" aria-hidden="true" tabindex="-1"></a>        ,<span class="at">family=</span><span class="fu">poisson</span>(<span class="at">link=</span><span class="st">"log"</span>))</span>
<span id="cb187-7"><a href="#cb187-7" aria-hidden="true" tabindex="-1"></a><span class="co">#type de la variable : poisson et fonction de lien de type log</span></span>
<span id="cb187-8"><a href="#cb187-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Then we check for significance</span></span>
<span id="cb187-9"><a href="#cb187-9" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(mod1,<span class="at">test=</span><span class="st">"Chi"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Single term deletions

Model:
Number_Fledged ~ County + Species + Habitat
        Df Deviance    AIC     LRT Pr(&gt;Chi)   
&lt;none&gt;       551.54 4095.7                    
County  13   569.19 4087.3 17.6441  0.17151   
Species  7   574.48 4104.6 22.9344  0.00175 **
Habitat  3   551.76 4089.9  0.2194  0.97439   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Now the less significative is Habitat</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model formulation</span></span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a>mod1<span class="ot">&lt;-</span><span class="fu">glm</span>(Number_Fledged<span class="sc">~</span> County</span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> Species</span>
<span id="cb189-4"><a href="#cb189-4" aria-hidden="true" tabindex="-1"></a>        ,<span class="at">data=</span>data_filtered</span>
<span id="cb189-5"><a href="#cb189-5" aria-hidden="true" tabindex="-1"></a>        ,<span class="at">family=</span><span class="fu">poisson</span>(<span class="at">link=</span><span class="st">"log"</span>))</span>
<span id="cb189-6"><a href="#cb189-6" aria-hidden="true" tabindex="-1"></a><span class="co">#type de la variable : poisson et fonction de lien de type log</span></span>
<span id="cb189-7"><a href="#cb189-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Then we check for significance</span></span>
<span id="cb189-8"><a href="#cb189-8" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(mod1,<span class="at">test=</span><span class="st">"Chi"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Single term deletions

Model:
Number_Fledged ~ County + Species
        Df Deviance    AIC    LRT Pr(&gt;Chi)   
&lt;none&gt;       551.76 4089.9                   
County  13   572.82 4085.0 21.056 0.071837 . 
Species  7   574.68 4098.8 22.914 0.001764 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>County is still not significative so we have to remove it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model formulation</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>mod1<span class="ot">&lt;-</span><span class="fu">glm</span>(Number_Fledged<span class="sc">~</span> Species</span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a>        ,<span class="at">data=</span>data_filtered</span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a>        ,<span class="at">family=</span><span class="fu">poisson</span>(<span class="at">link=</span><span class="st">"log"</span>))</span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a><span class="co">#type de la variable : poisson et fonction de lien de type log</span></span>
<span id="cb191-6"><a href="#cb191-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Then we check for significance</span></span>
<span id="cb191-7"><a href="#cb191-7" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(mod1,<span class="at">test=</span><span class="st">"Chi"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Single term deletions

Model:
Number_Fledged ~ Species
        Df Deviance    AIC    LRT Pr(&gt;Chi)    
&lt;none&gt;       572.82 4085.0                    
Species  7   599.76 4097.9 26.938 0.000342 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Number_Fledged ~ Species, family = poisson(link = "log"), 
    data = data_filtered)

Coefficients:
                           Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                 1.29234    0.03863  33.452  &lt; 2e-16 ***
SpeciesDickcissel          -0.18558    0.05934  -3.128 0.001762 ** 
SpeciesEastern_Meadowlark  -0.14760    0.05347  -2.761 0.005769 ** 
SpeciesGrasshopper_Sparrow -0.05604    0.05030  -1.114 0.265207    
SpeciesHenslow's_Sparrow   -0.18190    0.11514  -1.580 0.114157    
SpeciesSavannah_Sparrow    -0.19203    0.05648  -3.400 0.000674 ***
SpeciesVesper_Sparrow      -0.32409    0.08844  -3.665 0.000248 ***
SpeciesWestern_Meadowlark  -0.04452    0.10674  -0.417 0.676633    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 599.76  on 1172  degrees of freedom
Residual deviance: 572.82  on 1165  degrees of freedom
AIC: 4085

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
<p>We have the final model with only the Species.</p>
<ul>
<li><span class="math inline">\(Species{Bobolink }\)</span> = 0 (intercept)<br>
</li>
<li><span class="math inline">\(Species{Dickcissel }\)</span> = <span class="math inline">\(-0.18^{**}\)</span></li>
<li><span class="math inline">\(Species{Eastern Meadowlark }\)</span> = <span class="math inline">\(-0.14^{**}\)</span></li>
<li><span class="math inline">\(Species{Grasshopper Sparrow }\)</span> = <span class="math inline">\(-0.05\)</span></li>
<li><span class="math inline">\(Species{Henslow's Sparrow }\)</span> = <span class="math inline">\(-0.18\)</span></li>
<li><span class="math inline">\(Species{Savannah Sparrow }\)</span> = <span class="math inline">\(-0.19^{***}\)</span></li>
<li><span class="math inline">\(Species{Vesper Sparrow }\)</span> = <span class="math inline">\(-0.32^{***}\)</span></li>
<li><span class="math inline">\(Species{Western Meadowlark }\)</span> = <span class="math inline">\(-0.04\)</span></li>
</ul>
<p>The equation of the model is the following:</p>
<p><span class="math display">\[ Number_Fledged = 1.29^{***} + (Species{Bobolink} = 0 ;\:Species{Dickcissel} = -0.18^{**} ; \:Species{Eastern Meadowlark} = -0.14^{**} ; \:Species{Grasshopper Sparrow} = -0.05 ; \:Species{Henslow's Sparrow} = -0.18 ; \:Species{Savannah Sparrow = -0.19^{***} ; \:Species{Vesper Sparrow = -0.32^{***} ; \:Species{Western Meadowlark} = -0.04) \]</span></p>
<p>According to the modelâs summary, the null deviance is of 599.76 and residual deviance is of 572.82. In order to estimate the explained deviance, one can use the following formula:<br>
</p>
<p><span class="math display">\[Pseudo\:R^2=100\:.\:\frac{Null\:Deviance- Residual\:Deviance}{Null\:Deviance}\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate of deviance explained</span></span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a>(mod1<span class="sc">$</span>null.deviance<span class="sc">-</span>mod1<span class="sc">$</span>deviance)<span class="sc">/</span>mod1<span class="sc">$</span>null.deviance</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.04491502</code></pre>
</div>
</div>
<p>This is very very badâ¦ The variable species doesnât seem to explain a lot of the variation in the number of young individuals in the nest.</p>
</section>
<section id="c.-model-validation-1" class="level2">
<h2 class="anchored" data-anchor-id="c.-model-validation-1">C. Model validation:</h2>
<p>The model that we have done is a generalized linear model so there arenât residual normality or homogeneity. However, it is important to check the independence of residuals.</p>
<p>First of all, in situations where a counting model is used, such as when following a Poisson distribution, the overdispersion has to be checked. It can be done with the following code. If the result is over 1, there are overdispersion and the model should be reconsidered.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scale parameter calculation</span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a>E1 <span class="ot">&lt;-</span> <span class="fu">resid</span>(mod1, <span class="at">type =</span> <span class="st">"pearson"</span>) <span class="co"># (Y - mu) / sqrt(mu)</span></span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a>N  <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data_filtered)</span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a>p  <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">coef</span>(mod1))</span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(E1<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (N <span class="sc">-</span> p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4439871</code></pre>
</div>
</div>
<p>The value is of 0.44 so itâs okay, the residuals arenât overdispersed.</p>
<p>We can also check for the most influential individuals:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">cooks.distance</span>(mod1), <span class="at">type =</span> <span class="st">"h"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="dv">2</span>,<span class="at">lwd =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Analyse_Birds_files/figure-html/poisson_Contri-1.png" class="img-fluid" width="384"></p>
</div>
</div>
<p>There arenât very influential individuals which can be logical because of the high number of them and the low impact of species over the number of young individuals in the nest.</p>
</section>
<section id="conclusions" class="level2">
<h2 class="anchored" data-anchor-id="conclusions">Conclusions:</h2>
<p>The species of the birds has an impact over the number of young individuals in the nest, but it is clearly not the only variable that explain the variation of the response (only 4% are due to the species).</p>
</section>
</section>
<section id="iv.-anova" class="level1">
<h1>IV. ANOVA</h1>
<p>Analysis of variance (ANOVA) is one of the most widely used statistical methods in various disciplines. It allows to model the relationship between a quantitative dependent variable <span class="math inline">\(Y\)</span> according to the different modalities of one or more qualitative explanatory variables <span class="math inline">\(Xs\)</span>.</p>
<p>We will perform an ANOVA to see the effect of qualitatives variables (state, habitat, species, year) on the quantitative variable Initiation_Date in the Bird_dataset.csv dataset.</p>
<p>We need to check the type of the variables :</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dataset : variables as factors</span></span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>State<span class="ot">&lt;-</span><span class="fu">as.factor</span>(data<span class="sc">$</span>State)</span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Habitat<span class="ot">&lt;-</span><span class="fu">as.factor</span>(data<span class="sc">$</span>Habitat)</span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Species<span class="ot">&lt;-</span><span class="fu">as.factor</span>(data<span class="sc">$</span>Species)</span>
<span id="cb200-6"><a href="#cb200-6" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Year<span class="ot">&lt;-</span><span class="fu">as.factor</span>(data<span class="sc">$</span>Year)</span>
<span id="cb200-7"><a href="#cb200-7" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   3257 obs. of  10 variables:
 $ Nest_ID        : Factor w/ 3256 levels "1000JAAP","1005JAAP",..: 974 977 979 980 981 982 983 984 985 986 ...
 $ State          : Factor w/ 2 levels "Illinois","Wisconsin": 1 1 1 1 1 1 1 1 1 1 ...
 $ County         : Factor w/ 14 levels "Carroll","Carroll/Whiteside",..: 14 14 14 14 14 14 14 14 14 14 ...
 $ Habitat        : Factor w/ 4 levels "Cool-season_Grassland",..: 2 2 2 2 2 2 2 2 2 2 ...
 $ Species        : Factor w/ 8 levels "Bobolink","Dickcissel",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ Year           : Factor w/ 21 levels "1991","1992",..: 5 5 5 5 5 5 5 5 5 5 ...
 $ Nest_Fate      : Factor w/ 2 levels "0","1": 1 1 2 1 1 1 2 2 1 1 ...
 $ Initiation_Date: int  58 52 51 60 53 65 52 47 50 65 ...
 $ Number_Fledged : int  0 0 6 0 0 0 5 4 0 0 ...
 $ Nest_End_Date  : int  78 74 75 75 69 78 81 72 63 81 ...</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Checking for missing data</span></span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(data))  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>        Nest_ID           State          County         Habitat         Species 
              0               0               0               0               0 
           Year       Nest_Fate Initiation_Date  Number_Fledged   Nest_End_Date 
              0               0               0               0               0 </code></pre>
</div>
</div>
<p>There is no missing data here.</p>
<p>Before any modeling, we must explore the data in order to avoid possible errors. Below we present the list of steps to follow before proceeding to the modeling:</p>
<ul>
<li><p>1: Check for the presence of outliers in <span class="math inline">\(Y\)</span> and the distribution of the values of <span class="math inline">\(Y\)</span></p></li>
<li><p>2: If <span class="math inline">\(X\)</span> is a <strong>quantitative</strong> explanatory variable, check for the presence of outliers and the distribution of the values of <span class="math inline">\(X\)</span> <strong>OR/AND</strong> If <span class="math inline">\(X\)</span> is a <strong>qualitative</strong> explanatory variable, analyze the number of modalities and the number of individuals per modality</p></li>
<li><p>3: Analyze the potential relationship between <span class="math inline">\(Y\)</span> and the <span class="math inline">\(X_{s}\)</span></p></li>
<li><p>4: Check for the presence of possible interactions between the <span class="math inline">\(X_{s}\)</span></p></li>
</ul>
<section id="outliers-in-y-and-distribution-of-values-of-y" class="level3">
<h3 class="anchored" data-anchor-id="outliers-in-y-and-distribution-of-values-of-y">Outliers in <span class="math inline">\(Y\)</span> and distribution of values of <span class="math inline">\(Y\)</span></h3>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplot</span></span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(data<span class="sc">$</span>Initiation_Date,<span class="at">col=</span><span class="st">'dodgerblue3'</span>,<span class="at">ylab=</span><span class="st">'Initiation date'</span>)</span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Cleveland plot</span></span>
<span id="cb204-5"><a href="#cb204-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dotchart</span>(data<span class="sc">$</span>Initiation_Date,<span class="at">pch=</span><span class="dv">16</span>,<span class="at">col=</span><span class="st">'dodgerblue3'</span>,<span class="at">xlab=</span><span class="st">'Initiation date'</span>)</span>
<span id="cb204-6"><a href="#cb204-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram</span></span>
<span id="cb204-7"><a href="#cb204-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data<span class="sc">$</span>Initiation_Date,<span class="at">col=</span><span class="st">'dodgerblue3'</span>,<span class="at">xlab=</span><span class="st">"Initiation date"</span>,<span class="at">main=</span><span class="st">""</span>)</span>
<span id="cb204-8"><a href="#cb204-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Quantile-Quantile plot</span></span>
<span id="cb204-9"><a href="#cb204-9" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(data<span class="sc">$</span>Initiation_Date,<span class="at">pch=</span><span class="dv">16</span>,<span class="at">col=</span><span class="st">'dodgerblue3'</span>,<span class="at">xlab=</span><span class="st">''</span>)</span>
<span id="cb204-10"><a href="#cb204-10" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(data<span class="sc">$</span>Initiation_Date,<span class="at">col=</span><span class="st">'red'</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Analyse_Birds_files/figure-html/Ini_datahist-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<p>The different graphs show us no outliers for Initiation_Date. In addition, our Y variable seems to follow a Normal Distribution.</p>
</section>
<section id="outliers-and-distribution-of-the-values-of-x" class="level3">
<h3 class="anchored" data-anchor-id="outliers-and-distribution-of-the-values-of-x">Outliers and distribution of the values of <span class="math inline">\(X\)</span></h3>
<p>The four <span class="math inline">\(Xs\)</span> are factors. We can analyze the number of modalities and the number of individuals per modality.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Factor State</span></span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data<span class="sc">$</span>State)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Illinois Wisconsin 
     1073      2184 </code></pre>
</div>
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Factor Habitat</span></span>
<span id="cb207-2"><a href="#cb207-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data<span class="sc">$</span>Habitat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Cool-season_Grassland               Pasture               Prairie 
                  677                  1683                   496 
Warm-season_Grassland 
                  401 </code></pre>
</div>
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Factor Species</span></span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data<span class="sc">$</span>Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           Bobolink          Dickcissel  Eastern_Meadowlark Grasshopper_Sparrow 
                390                 470                 726                 693 
  Henslow's_Sparrow    Savannah_Sparrow      Vesper_Sparrow  Western_Meadowlark 
                 72                 664                 174                  68 </code></pre>
</div>
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Factor Year</span></span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data<span class="sc">$</span>Year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>1991 1992 1993 1994 1995 1996 1997 1998 1999 2000 2001 2002 2003 2004 2005 2006 
  68   27   24   26  206  261  330  321  272  448  285  181   56  102   55   91 
2007 2008 2009 2010 2011 
 139  180   67   73   45 </code></pre>
</div>
</div>
<p>Factor State: The experimental design is not balanced (1071 and 2150 data), but the analysis can be performed because there are enough data in each modality (&gt; 10).</p>
<p>Factor Habitat: The experimental design is not balanced (from 392 to 1683 data), but the analysis can be performed because there are enough data in each modality (&gt; 10).</p>
<p>Factor Species: The experimental design is not balanced. Several species have less than 10 data per modality. It will therefore be necessary to remove these data before continuing the analysis</p>
<p>Factor Year: The experimental design is not balanced (from 24 to 448 data), but the analysis can be performed because there are enough data in each modality (&gt; 10 : threshold from which we consider that carrying out statistical analyses makes sense. You can choose your own threshold).</p>
</section>
<section id="removal-of-poorly-represented-modalities-10-data" class="level3">
<h3 class="anchored" data-anchor-id="removal-of-poorly-represented-modalities-10-data">Removal of poorly represented modalities (&lt; 10 data)</h3>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the number of occurrences for each modality in data$Species</span></span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a>species_count <span class="ot">&lt;-</span> <span class="fu">table</span>(data<span class="sc">$</span>Species)</span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-4"><a href="#cb213-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Keep only terms with 10 or more occurrences</span></span>
<span id="cb213-5"><a href="#cb213-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Species <span class="sc">%in%</span> <span class="fu">names</span>(species_count[species_count <span class="sc">&gt;=</span> <span class="dv">10</span>]))</span>
<span id="cb213-6"><a href="#cb213-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-7"><a href="#cb213-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Show filtered data</span></span>
<span id="cb213-8"><a href="#cb213-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Nest_ID    State County Habitat  Species Year Nest_Fate Initiation_Date
1 745JAAP Illinois   Will Pasture Bobolink 1995         0              58
2 748JAAP Illinois   Will Pasture Bobolink 1995         0              52
3 753JAAP Illinois   Will Pasture Bobolink 1995         1              51
4 754JAAP Illinois   Will Pasture Bobolink 1995         0              60
5 755JAAP Illinois   Will Pasture Bobolink 1995         0              53
6 758JAAP Illinois   Will Pasture Bobolink 1995         0              65
  Number_Fledged Nest_End_Date
1              0            78
2              0            74
3              6            75
4              0            75
5              0            69
6              0            78</code></pre>
</div>
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data<span class="sc">$</span>Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           Bobolink          Dickcissel  Eastern_Meadowlark Grasshopper_Sparrow 
                390                 470                 726                 693 
  Henslow's_Sparrow    Savannah_Sparrow      Vesper_Sparrow  Western_Meadowlark 
                 72                 664                 174                  68 </code></pre>
</div>
</div>
</section>
<section id="analyzing-the-potential-relationship-between-y-vs-xs" class="level3">
<h3 class="anchored" data-anchor-id="analyzing-the-potential-relationship-between-y-vs-xs">Analyzing the potential relationship between Y vs Xs</h3>
<p>We can graphically analyze the possible relationships between Y and X. This graphical analysis of the relationships between Y and X <strong>does not allow us to predict the significance of the relationship</strong>. Statistical modeling remains the only available means to identify whether a relationship exists or not.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplot </span></span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(data<span class="sc">$</span>Initiation_Date<span class="sc">~</span>data<span class="sc">$</span>State, <span class="at">varwidth =</span> <span class="cn">TRUE</span>, <span class="at">ylab =</span> <span class="st">"Initiation date"</span>, <span class="at">xlab =</span> <span class="st">"State"</span>, <span class="at">col=</span><span class="st">'darkgrey'</span>, <span class="at">main =</span> <span class="st">""</span>)</span>
<span id="cb217-4"><a href="#cb217-4" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(data<span class="sc">$</span>Initiation_Date<span class="sc">~</span>data<span class="sc">$</span>Habitat, <span class="at">varwidth =</span> <span class="cn">TRUE</span>, <span class="at">ylab =</span> <span class="st">"Initiation date"</span>, <span class="at">xlab =</span> <span class="st">"Habitat"</span>, <span class="at">col=</span><span class="st">'darkgrey'</span>, <span class="at">main =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Analyse_Birds_files/figure-html/Ini_datagraph-1.png" class="img-fluid" width="576"></p>
</div>
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(data<span class="sc">$</span>Initiation_Date<span class="sc">~</span>data<span class="sc">$</span>Species, <span class="at">varwidth =</span> <span class="cn">TRUE</span>, <span class="at">ylab =</span> <span class="st">"Initiation date"</span>, <span class="at">xlab =</span> <span class="st">"Species"</span>, <span class="at">col=</span><span class="st">'darkgrey'</span>, <span class="at">main =</span> <span class="st">""</span>)</span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(data<span class="sc">$</span>Initiation_Date<span class="sc">~</span>data<span class="sc">$</span>Year, <span class="at">varwidth =</span> <span class="cn">TRUE</span>, <span class="at">ylab =</span> <span class="st">"Initiation date"</span>, <span class="at">xlab =</span> <span class="st">"Year"</span>, <span class="at">col=</span><span class="st">'darkgrey'</span>, <span class="at">main =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Analyse_Birds_files/figure-html/Ini_datagraph-2.png" class="img-fluid" width="576"></p>
</div>
</div>
<p>From the first visualizations, we could make the hypothesis that Year and Species influence Initiation_Date.</p>
</section>
<section id="analysis-of-possible-interactions-between-the-four-xs" class="level3">
<h3 class="anchored" data-anchor-id="analysis-of-possible-interactions-between-the-four-xs">Analysis of possible interactions between the four Xs</h3>
<p>The interaction between two factors can only be tested if the factors are crossed (all the modalities of one factor are represented in all the modalities of the other factor and vice versa = a complete factorial design). To estimate the presence of interactive effects, we will develop a graphical approach.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Interaction table</span></span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(data<span class="sc">$</span>State,data<span class="sc">$</span>Habitat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           
            Cool-season_Grassland Pasture Prairie Warm-season_Grassland
  Illinois                    242     537     137                   157
  Wisconsin                   435    1146     359                   244</code></pre>
</div>
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(data<span class="sc">$</span>State,data<span class="sc">$</span>Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           
            Bobolink Dickcissel Eastern_Meadowlark Grasshopper_Sparrow
  Illinois        62        314                229                 350
  Wisconsin      328        156                497                 343
           
            Henslow's_Sparrow Savannah_Sparrow Vesper_Sparrow
  Illinois                  5               13             54
  Wisconsin                67              651            120
           
            Western_Meadowlark
  Illinois                  46
  Wisconsin                 22</code></pre>
</div>
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(data<span class="sc">$</span>State,data<span class="sc">$</span>Year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>           
            1991 1992 1993 1994 1995 1996 1997 1998 1999 2000 2001 2002 2003
  Illinois     0    0    0    0  166  261  330  166    0    0    0    0    0
  Wisconsin   68   27   24   26   40    0    0  155  272  448  285  181   56
           
            2004 2005 2006 2007 2008 2009 2010 2011
  Illinois     0    0    0   52   60   38    0    0
  Wisconsin  102   55   91   87  120   29   73   45</code></pre>
</div>
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(data<span class="sc">$</span>Habitat,data<span class="sc">$</span>Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                       
                        Bobolink Dickcissel Eastern_Meadowlark
  Cool-season_Grassland      157        163                260
  Pasture                    166         85                322
  Prairie                      9         69                 95
  Warm-season_Grassland       58        153                 49
                       
                        Grasshopper_Sparrow Henslow's_Sparrow Savannah_Sparrow
  Cool-season_Grassland                  32                53               10
  Pasture                               360                 0              644
  Prairie                               200                 1                2
  Warm-season_Grassland                 101                18                8
                       
                        Vesper_Sparrow Western_Meadowlark
  Cool-season_Grassland              2                  0
  Pasture                           40                 66
  Prairie                          120                  0
  Warm-season_Grassland             12                  2</code></pre>
</div>
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(data<span class="sc">$</span>Habitat,data<span class="sc">$</span>Year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                       
                        1991 1992 1993 1994 1995 1996 1997 1998 1999 2000 2001
  Cool-season_Grassland    1    0    0    0   40   79   75    7    0    0   34
  Pasture                  0    0   15   26   92  106  226  272  272  411  158
  Prairie                 11    2    0    0   41   29    9   28    0   32   92
  Warm-season_Grassland   56   25    9    0   33   47   20   14    0    5    1
                       
                        2002 2003 2004 2005 2006 2007 2008 2009 2010 2011
  Cool-season_Grassland   17   18   25   48   88  109  132    4    0    0
  Pasture                 11   19   33    0    2   12   17    7    1    3
  Prairie                151   19   44    0    1   11   12   11    0    3
  Warm-season_Grassland    2    0    0    7    0    7   19   45   72   39</code></pre>
</div>
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(data<span class="sc">$</span>Species,data<span class="sc">$</span>Year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                     
                      1991 1992 1993 1994 1995 1996 1997 1998 1999 2000 2001
  Bobolink               0    0    0    5   20   22   20   29   37   34   20
  Dickcissel            68   27   24    0   50   60   83   27    0    7    5
  Eastern_Meadowlark     0    0    0    3   51  119   41   35   47   60   70
  Grasshopper_Sparrow    0    0    0    0   45   50  128  114   21   66   59
  Henslow's_Sparrow      0    0    0    0    4    1    0    0    0    0    4
  Savannah_Sparrow       0    0    0   14   27    3    3   81  161  262   91
  Vesper_Sparrow         0    0    0    2    4    6   28   13    0   16   36
  Western_Meadowlark     0    0    0    2    5    0   27   22    6    3    0
                     
                      2002 2003 2004 2005 2006 2007 2008 2009 2010 2011
  Bobolink               4   10    6   24   28   32   46    9   29   15
  Dickcissel            11    0    0    0    3   36   33   29    1    6
  Eastern_Meadowlark    36   21   36   18   43   49   62    5   21    9
  Grasshopper_Sparrow   74   15   38    5    3   11   28   15   10   11
  Henslow's_Sparrow      2    1    7    6   11   11    7    4   10    4
  Savannah_Sparrow       0    7    4    2    3    0    2    2    2    0
  Vesper_Sparrow        54    2   10    0    0    0    2    1    0    0
  Western_Meadowlark     0    0    1    0    0    0    0    2    0    0</code></pre>
</div>
</div>
<p>Subsequently, we will not analyze the interactions between the factors since there is no interaction between the Xs variables.</p>
</section>
<section id="search-for-candidate-model" class="level3">
<h3 class="anchored" data-anchor-id="search-for-candidate-model">Search for candidate model</h3>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model formulation</span></span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true" tabindex="-1"></a>mod1<span class="ot">&lt;-</span><span class="fu">lm</span>(Initiation_Date<span class="sc">~</span>State<span class="sc">+</span>Habitat<span class="sc">+</span>Species<span class="sc">+</span>Year,<span class="at">data=</span>data)</span>
<span id="cb231-3"><a href="#cb231-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-4"><a href="#cb231-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Then we check for significance</span></span>
<span id="cb231-5"><a href="#cb231-5" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(mod1,<span class="at">test=</span><span class="st">"F"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Single term deletions

Model:
Initiation_Date ~ State + Habitat + Species + Year
        Df Sum of Sq     RSS   AIC F value    Pr(&gt;F)    
&lt;none&gt;                976530 18639                      
State    1      2745  979275 18646  9.0652  0.002625 ** 
Habitat  3       707  977238 18636  0.7788  0.505682    
Species  7    103831 1080362 18954 48.9863 &lt; 2.2e-16 ***
Year    20     38882 1015412 18726  6.4204 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Since the Habitat factor is not significant, we can remove it in our search for the candidate model.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model formulation</span></span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a>mod2<span class="ot">&lt;-</span><span class="fu">lm</span>(Initiation_Date<span class="sc">~</span>State<span class="sc">+</span>Species<span class="sc">+</span>Year,<span class="at">data=</span>data)</span>
<span id="cb233-3"><a href="#cb233-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-4"><a href="#cb233-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Then we check for significance</span></span>
<span id="cb233-5"><a href="#cb233-5" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(mod2,<span class="at">test=</span><span class="st">"F"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Single term deletions

Model:
Initiation_Date ~ State + Species + Year
        Df Sum of Sq     RSS   AIC F value    Pr(&gt;F)    
&lt;none&gt;                977238 18636                      
State    1      2704  979942 18643  8.9334  0.002821 ** 
Species  7    106384 1083622 18958 50.2010 &lt; 2.2e-16 ***
Year    20     50931 1028169 18761  8.4118 &lt; 2.2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>All factors are significant. So we have our candidate model.</p>
<p>To understand how factors influence Initiation_Date, we need to analyze the coefficients of the model.</p>
</section>
<section id="analysis-of-the-coefficients-of-the-candidate-model" class="level3">
<h3 class="anchored" data-anchor-id="analysis-of-the-coefficients-of-the-candidate-model">Analysis of the coefficients of the candidate model</h3>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficients of the model</span></span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Initiation_Date ~ State + Species + Year, data = data)

Residuals:
    Min      1Q  Median      3Q     Max 
-44.632 -12.483  -0.898  12.648  47.293 

Coefficients:
                           Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                 75.2202     3.1666  23.754  &lt; 2e-16 ***
StateWisconsin              -4.1385     1.3846  -2.989 0.002821 ** 
SpeciesDickcissel           22.1389     1.4608  15.155  &lt; 2e-16 ***
SpeciesEastern_Meadowlark    0.5651     1.1230   0.503 0.614845    
SpeciesGrasshopper_Sparrow  10.9373     1.2108   9.033  &lt; 2e-16 ***
SpeciesHenslow's_Sparrow     7.1495     2.2608   3.162 0.001580 ** 
SpeciesSavannah_Sparrow      2.0384     1.2402   1.644 0.100344    
SpeciesVesper_Sparrow        6.5509     1.7251   3.797 0.000149 ***
SpeciesWestern_Meadowlark    4.8149     2.3779   2.025 0.042969 *  
Year1992                    -8.1836     3.9578  -2.068 0.038750 *  
Year1993                    -9.3039     4.1311  -2.252 0.024379 *  
Year1994                   -10.9649     4.2064  -2.607 0.009184 ** 
Year1995                   -11.7072     2.9317  -3.993 6.66e-05 ***
Year1996                   -10.8870     3.0252  -3.599 0.000324 ***
Year1997                   -10.0784     2.9379  -3.430 0.000610 ***
Year1998                    -9.2642     2.7433  -3.377 0.000742 ***
Year1999                    -6.2924     2.6793  -2.348 0.018910 *  
Year2000                    -4.6532     2.5812  -1.803 0.071518 .  
Year2001                    -6.1430     2.6142  -2.350 0.018840 *  
Year2002                   -10.5584     2.7096  -3.897 9.95e-05 ***
Year2003                   -12.7861     3.3400  -3.828 0.000132 ***
Year2004                   -18.2139     2.9473  -6.180 7.22e-10 ***
Year2005                   -14.2968     3.3841  -4.225 2.46e-05 ***
Year2006                   -18.2607     3.0289  -6.029 1.84e-09 ***
Year2007                   -14.3252     2.8354  -5.052 4.61e-07 ***
Year2008                   -17.6839     2.7534  -6.422 1.54e-10 ***
Year2009                   -19.0075     3.2178  -5.907 3.85e-09 ***
Year2010                   -16.1358     3.1693  -5.091 3.76e-07 ***
Year2011                   -13.8112     3.4968  -3.950 7.99e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 17.4 on 3228 degrees of freedom
Multiple R-squared:  0.2269,    Adjusted R-squared:  0.2202 
F-statistic: 33.84 on 28 and 3228 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="co"># From this listing, you read the coefficients table hereafter :</span></span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-3"><a href="#cb237-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficients:</span></span>
<span id="cb237-4"><a href="#cb237-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                            Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb237-5"><a href="#cb237-5" aria-hidden="true" tabindex="-1"></a><span class="co"># (Intercept)                 75.7832     3.1611  23.974  &lt; 2e-16 ***</span></span>
<span id="cb237-6"><a href="#cb237-6" aria-hidden="true" tabindex="-1"></a><span class="co"># StateWisconsin              -4.4838     1.3892  -3.228 0.001261 ** </span></span>
<span id="cb237-7"><a href="#cb237-7" aria-hidden="true" tabindex="-1"></a><span class="co"># SpeciesDickcissel           21.9212     1.4579  15.036  &lt; 2e-16 ***</span></span>
<span id="cb237-8"><a href="#cb237-8" aria-hidden="true" tabindex="-1"></a><span class="co"># SpeciesEastern Meadowlark    0.5278     1.1198   0.471 0.637432    </span></span>
<span id="cb237-9"><a href="#cb237-9" aria-hidden="true" tabindex="-1"></a><span class="co"># SpeciesGrasshopper Sparrow  10.6652     1.2095   8.818  &lt; 2e-16 ***</span></span>
<span id="cb237-10"><a href="#cb237-10" aria-hidden="true" tabindex="-1"></a><span class="co"># SpeciesSavannah Sparrow      1.9590     1.2370   1.584 0.113382    </span></span>
<span id="cb237-11"><a href="#cb237-11" aria-hidden="true" tabindex="-1"></a><span class="co"># SpeciesVesper Sparrow        6.2687     1.7225   3.639 0.000278 ***</span></span>
<span id="cb237-12"><a href="#cb237-12" aria-hidden="true" tabindex="-1"></a><span class="co"># SpeciesWestern Meadowlark    4.5978     2.3695   1.940 0.052424 .  </span></span>
<span id="cb237-13"><a href="#cb237-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Year1992                    -8.1836     3.9411  -2.076 0.037930 *  </span></span>
<span id="cb237-14"><a href="#cb237-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Year1993                    -9.3039     4.1136  -2.262 0.023780 *  </span></span>
<span id="cb237-15"><a href="#cb237-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Year1994                   -11.0971     4.1890  -2.649 0.008111 ** </span></span>
<span id="cb237-16"><a href="#cb237-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Year1995                   -11.7709     2.9221  -4.028 5.75e-05 ***</span></span>
<span id="cb237-17"><a href="#cb237-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Year1996                   -11.2748     3.0178  -3.736 0.000190 ***</span></span>
<span id="cb237-18"><a href="#cb237-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Year1997                   -10.4340     2.9302  -3.561 0.000375 ***</span></span>
<span id="cb237-19"><a href="#cb237-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Year1998                    -9.4950     2.7335  -3.474 0.000520 ***</span></span>
<span id="cb237-20"><a href="#cb237-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Year1999                    -6.4308     2.6686  -2.410 0.016018 *  </span></span>
<span id="cb237-21"><a href="#cb237-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Year2000                    -4.7644     2.5708  -1.853 0.063934 .  </span></span>
<span id="cb237-22"><a href="#cb237-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Year2001                    -6.3518     2.6071  -2.436 0.014893 *  </span></span>
<span id="cb237-23"><a href="#cb237-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Year2002                   -10.3377     2.7027  -3.825 0.000133 ***</span></span>
<span id="cb237-24"><a href="#cb237-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Year2003                   -12.4141     3.3412  -3.716 0.000206 ***</span></span>
<span id="cb237-25"><a href="#cb237-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Year2004                   -17.6615     2.9707  -5.945 3.06e-09 ***</span></span>
<span id="cb237-26"><a href="#cb237-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Year2005                   -14.4370     3.4662  -4.165 3.20e-05 ***</span></span>
<span id="cb237-27"><a href="#cb237-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Year2006                   -20.7535     3.0848  -6.728 2.04e-11 ***</span></span>
<span id="cb237-28"><a href="#cb237-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Year2007                   -15.3033     2.8578  -5.355 9.17e-08 ***</span></span>
<span id="cb237-29"><a href="#cb237-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Year2008                   -17.9192     2.7567  -6.500 9.28e-11 ***</span></span>
<span id="cb237-30"><a href="#cb237-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Year2009                   -19.0311     3.2531  -5.850 5.41e-09 ***</span></span>
<span id="cb237-31"><a href="#cb237-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Year2010                   -15.0863     3.2508  -4.641 3.61e-06 ***</span></span>
<span id="cb237-32"><a href="#cb237-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Year2011                   -13.2651     3.5681  -3.718 0.000205 ***</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="explanatory-power-of-the-model-rÂ²" class="level3">
<h3 class="anchored" data-anchor-id="explanatory-power-of-the-model-rÂ²">Explanatory power of the model: RÂ²</h3>
<p>We can determine the portion of variance of <span class="math inline">\(Y\)</span> explained by our model.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="co"># RÂ² of the model</span></span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod2)<span class="sc">$</span>adj.r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2201967</code></pre>
</div>
</div>
<p>We obtain the adjusted RÂ² = 0.22. This means that approximately 22% of the variance of Initiation_Date is explained by our modeling.</p>
</section>
<section id="validation-of-modeling" class="level2">
<h2 class="anchored" data-anchor-id="validation-of-modeling">Validation of modeling</h2>
<p>The assumptions of ANOVA are the same as for any general linear model, namely <strong>independence</strong>, <strong>normality of residuals</strong> and <strong>homogeneity of variances</strong>. In addition, one must check the presence of influential statistical units (i.e.&nbsp;observations having a significant contribution to the construction of the model).</p>
<section id="normality-of-residuals" class="level3">
<h3 class="anchored" data-anchor-id="normality-of-residuals">Normality of residuals</h3>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram</span></span>
<span id="cb240-3"><a href="#cb240-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(mod2<span class="sc">$</span>residuals,<span class="at">col=</span><span class="st">'dodgerblue3'</span>,<span class="at">xlab=</span><span class="st">"residuals"</span>,<span class="at">main=</span><span class="st">"Check Normality"</span>)</span>
<span id="cb240-4"><a href="#cb240-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Quantile-Quantile plot</span></span>
<span id="cb240-5"><a href="#cb240-5" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(mod2<span class="sc">$</span>residuals,<span class="at">pch=</span><span class="dv">16</span>,<span class="at">col=</span><span class="st">'dodgerblue3'</span>,<span class="at">xlab=</span><span class="st">''</span>)</span>
<span id="cb240-6"><a href="#cb240-6" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(mod2<span class="sc">$</span>residuals,<span class="at">col=</span><span class="st">'red'</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Analyse_Birds_files/figure-html/ini_ResidNorm-1.png" class="img-fluid" width="576"></p>
</div>
</div>
<p>The residuals seem to follow a Normal Distribution.</p>
</section>
<section id="homogeneity-of-variance" class="level3">
<h3 class="anchored" data-anchor-id="homogeneity-of-variance">Homogeneity of variance</h3>
<p>The assumption of homogeneity of variance is the fact that the variation of the residuals is approximately equal over the entire range of explanatory variables, should be verified by plotting the residuals at the estimated values ââand the residuals at the values ââof the significant variables. The residuals should show <strong>no trend</strong>.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true" tabindex="-1"></a><span class="co"># residuals vs fitted</span></span>
<span id="cb241-3"><a href="#cb241-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">residuals</span>(mod1)<span class="sc">~</span><span class="fu">fitted</span>(mod1)</span>
<span id="cb241-4"><a href="#cb241-4" aria-hidden="true" tabindex="-1"></a>     , <span class="at">col=</span><span class="st">'dodgerblue3'</span></span>
<span id="cb241-5"><a href="#cb241-5" aria-hidden="true" tabindex="-1"></a>     , <span class="at">pch=</span><span class="dv">16</span>)</span>
<span id="cb241-6"><a href="#cb241-6" aria-hidden="true" tabindex="-1"></a><span class="co"># residuals against state factor</span></span>
<span id="cb241-7"><a href="#cb241-7" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(<span class="fu">residuals</span>(mod2)<span class="sc">~</span> data<span class="sc">$</span>State, </span>
<span id="cb241-8"><a href="#cb241-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">varwidth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb241-9"><a href="#cb241-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">col=</span><span class="st">'darkgrey'</span>,</span>
<span id="cb241-10"><a href="#cb241-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">"Residuals"</span>,</span>
<span id="cb241-11"><a href="#cb241-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">"States"</span>,</span>
<span id="cb241-12"><a href="#cb241-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">""</span>)</span>
<span id="cb241-13"><a href="#cb241-13" aria-hidden="true" tabindex="-1"></a><span class="co"># residuals against species factor</span></span>
<span id="cb241-14"><a href="#cb241-14" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(<span class="fu">residuals</span>(mod2)<span class="sc">~</span> data<span class="sc">$</span>Species, </span>
<span id="cb241-15"><a href="#cb241-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">varwidth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb241-16"><a href="#cb241-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">col=</span><span class="st">'brown'</span>,</span>
<span id="cb241-17"><a href="#cb241-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">"Residuals"</span>,</span>
<span id="cb241-18"><a href="#cb241-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">"Species"</span>,</span>
<span id="cb241-19"><a href="#cb241-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">""</span>)</span>
<span id="cb241-20"><a href="#cb241-20" aria-hidden="true" tabindex="-1"></a><span class="co"># residuals against year factor</span></span>
<span id="cb241-21"><a href="#cb241-21" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(<span class="fu">residuals</span>(mod2)<span class="sc">~</span> data<span class="sc">$</span>Year, </span>
<span id="cb241-22"><a href="#cb241-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">varwidth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb241-23"><a href="#cb241-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">col=</span><span class="st">'brown'</span>,</span>
<span id="cb241-24"><a href="#cb241-24" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">"Residuals"</span>,</span>
<span id="cb241-25"><a href="#cb241-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab =</span> <span class="st">"Years"</span>,</span>
<span id="cb241-26"><a href="#cb241-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">main =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Analyse_Birds_files/figure-html/ini_Residhomo-1.png" class="img-fluid" width="768"></p>
</div>
</div>
<p>We do not observe any trend. Therefore the hypothesis of homogeneity of variance is verified.</p>
</section>
<section id="independence" class="level3">
<h3 class="anchored" data-anchor-id="independence">Independence</h3>
<p>ANOVA (like any other general linear model) assumes that all statistical units (and therefore residuals) are independent of each other. This issue must be taken into account at the <em>research design stage</em>. Given the approach here, the statistical individuals are independent. This assumption is verified.</p>
</section>
<section id="verification-of-influential-individuals" class="level3">
<h3 class="anchored" data-anchor-id="verification-of-influential-individuals">Verification of influential individuals</h3>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb242"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb242-2"><a href="#cb242-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">cooks.distance</span>(mod2), <span class="at">type =</span> <span class="st">"h"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb242-3"><a href="#cb242-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="dv">2</span>,<span class="at">lwd =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Analyse_Birds_files/figure-html/ini_Contri-1.png" class="img-fluid" width="384"></p>
</div>
</div>
<p>There is no influential individual.</p>
<p>All conditions being verified, our modeling can be validated.</p>
</section>
<section id="conclusion-of-our-anova" class="level3">
<h3 class="anchored" data-anchor-id="conclusion-of-our-anova">Conclusion of our ANOVA</h3>
<p>The explanatory variables retained in our model are âStateâ, âSpeciesâ and âYearâ.</p>
<p>The equation of our model is:</p>
<p><span class="math display">\[
\text{Y} = 75.7832 - 4.4838 \cdot \text{State}_{\text{Wisconsin}} + 21.9212 \cdot \text{Species}_{\text{Dickcissel}} + 0.5278 \cdot \text{Species}_{\text{Eastern Meadowlark}} + 10.6652 \cdot \text{Species}_{\text{Grasshopper Sparrow}} + 1.9590 \cdot \text{Species}_{\text{Savannah Sparrow}} + 6.2687 \cdot \text{Species}_{\text{Vesper Sparrow}} + 4.5978 \cdot \text{Species}_{\text{Western Meadowlark}} - 8.1836 \cdot \text{Year}_{1992} - 9.3039 \cdot \text{Year}_{1993} - 11.0971 \cdot \text{Year}_{1994} - 11.7709 \cdot \text{Year}_{1995} - 11.2748 \cdot \text{Year}_{1996} - 10.4340 \cdot \text{Year}_{1997} - 9.4950 \cdot \text{Year}_{1998} - 6.4308 \cdot \text{Year}_{1999} - 4.7644 \cdot \text{Year}_{2000} - 6.3518 \cdot \text{Year}_{2001} - 10.3377 \cdot \text{Year}_{2002} - 12.4141 \cdot \text{Year}_{2003} - 17.6615 \cdot \text{Year}_{2004} - 14.4370 \cdot \text{Year}_{2005} - 20.7535 \cdot \text{Year}_{2006} - 15.3033 \cdot \text{Year}_{2007} - 17.9192 \cdot \text{Year}_{2008} - 19.0311 \cdot \text{Year}_{2009} - 15.0863 \cdot \text{Year}_{2010} - 13.2651 \cdot \text{Year}_{2011}
\]</span></p>
<p>In this equation each variable takes the value 1 if the corresponding condition is true and 0 otherwise.</p>
<p>But despite all the conditions of the model being validated, this model only explains 22% (RÂ² = 0.22) of our variable Y (Initiation_Date).</p>
</section>
</section>
</section>
<section id="v.-famd" class="level1">
<h1>V. FAMD</h1>
<section id="generical-exploration" class="level3">
<h3 class="anchored" data-anchor-id="generical-exploration">Generical exploration</h3>
<p>Here, we perform an FAMD on the initial dataframe. The FAMD is used for tables with qualitative and quantitative variables. The ID are removed because of their uselessness.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb243"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a>data_famd <span class="ot">&lt;-</span> data</span>
<span id="cb243-2"><a href="#cb243-2" aria-hidden="true" tabindex="-1"></a><span class="do">### Conversion of the Year into factor</span></span>
<span id="cb243-3"><a href="#cb243-3" aria-hidden="true" tabindex="-1"></a>data_famd<span class="sc">$</span>Year <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(data_famd<span class="sc">$</span>Year)</span>
<span id="cb243-4"><a href="#cb243-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-5"><a href="#cb243-5" aria-hidden="true" tabindex="-1"></a><span class="do">### Removing of ID</span></span>
<span id="cb243-6"><a href="#cb243-6" aria-hidden="true" tabindex="-1"></a>data_famd <span class="ot">&lt;-</span> data_famd <span class="sc">|&gt;</span></span>
<span id="cb243-7"><a href="#cb243-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>Nest_ID)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We can perform the famd (see <span class="citation" data-cites="fig">(<a href="#ref-fig" role="doc-biblioref"><strong>fig?</strong></a>)</span>-)</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a>famd <span class="ot">&lt;-</span> <span class="fu">FAMD</span>(<span class="at">base =</span> data_famd, <span class="at">graph =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>First, letâs see the summary :</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb245"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(famd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
FAMD(base = data_famd, graph = FALSE) 


Eigenvalues
                      Dim.1  Dim.2  Dim.3  Dim.4  Dim.5
Variance              3.416  2.831  2.644  2.327  2.148
% of var.             7.116  5.897  5.509  4.849  4.475
Cumulative % of var.  7.116 13.013 18.522 23.371 27.846

Individuals (the 10 first)
                      Dist    Dim.1    ctr   cos2    Dim.2    ctr   cos2  
1                 |  5.833 |  1.039  0.010  0.032 | -0.144  0.000  0.001 |
2                 |  5.890 |  0.893  0.007  0.023 | -0.069  0.000  0.000 |
3                 |  6.588 |  0.807  0.006  0.015 |  1.015  0.011  0.024 |
4                 |  5.839 |  1.024  0.009  0.031 | -0.144  0.000  0.001 |
5                 |  5.919 |  0.833  0.006  0.020 | -0.049  0.000  0.000 |
6                 |  5.810 |  1.141  0.012  0.039 | -0.204  0.000  0.001 |
7                 |  6.330 |  0.921  0.008  0.021 |  0.856  0.008  0.018 |
8                 |  6.231 |  0.724  0.005  0.014 |  0.834  0.008  0.018 |
9                 |  5.998 |  0.700  0.004  0.014 |  0.012  0.000  0.000 |
10                |  5.799 |  1.186  0.013  0.042 | -0.222  0.001  0.001 |
                   Dim.3    ctr   cos2  
1                 -1.498  0.026  0.066 |
2                 -1.538  0.027  0.068 |
3                 -1.114  0.014  0.029 |
4                 -1.505  0.026  0.066 |
5                 -1.557  0.028  0.069 |
6                 -1.473  0.025  0.064 |
7                 -1.124  0.015  0.032 |
8                 -1.224  0.017  0.039 |
9                 -1.596  0.030  0.071 |
10                -1.459  0.025  0.063 |

Continuous variables
                     Dim.1    ctr   cos2    Dim.2    ctr   cos2    Dim.3    ctr
Initiation_Date   |  0.531  8.252  0.282 | -0.287  2.912  0.082 |  0.117  0.517
Number_Fledged    | -0.031  0.029  0.001 |  0.336  3.996  0.113 |  0.115  0.496
Nest_End_Date     |  0.532  8.273  0.283 | -0.187  1.233  0.035 |  0.143  0.776
                    cos2  
Initiation_Date    0.014 |
Number_Fledged     0.013 |
Nest_End_Date      0.021 |

Categories (the 10 first)
                      Dim.1     ctr    cos2  v.test     Dim.2     ctr    cos2
Illinois          |   2.246  14.243   0.816  48.602 |  -0.380   0.594   0.023
Wisconsin         |  -1.103   6.998   0.816 -48.602 |   0.187   0.292   0.023
Carroll           |   1.468   0.085   0.009   3.084 |  -1.222   0.086   0.006
Carroll/Whiteside |   1.543   0.031   0.004   1.867 |  -1.536   0.045   0.004
Dane              |  -0.291   0.098   0.007  -3.552 |   2.883  14.046   0.684
Grant             |  -1.704   0.772   0.082  -9.410 |  -1.430   0.791   0.058
Green             |  -1.276   0.775   0.080  -9.555 |  -0.816   0.462   0.033
Grundy            |   2.311   0.745   0.075   9.176 |  -0.037   0.000   0.000
Iowa              |  -1.331   3.470   0.373 -22.364 |   0.213   0.129   0.010
Jo_Daviess        |   2.026   3.155   0.213  19.633 |  -1.770   3.506   0.163
                   v.test     Dim.3     ctr    cos2  v.test  
Illinois           -9.037 |  -0.508   1.214   0.042 -12.487 |
Wisconsin           9.037 |   0.249   0.597   0.042  12.487 |
Carroll            -2.819 |   1.454   0.139   0.009   3.471 |
Carroll/Whiteside  -2.043 |   1.652   0.060   0.004   2.273 |
Dane               38.695 |  -0.083   0.013   0.001  -1.154 |
Grant              -8.674 |  -0.774   0.266   0.017  -4.861 |
Green              -6.714 |   0.274   0.059   0.004   2.328 |
Grundy             -0.161 |   0.161   0.006   0.000   0.725 |
Iowa                3.925 |  -0.264   0.228   0.015  -5.046 |
Jo_Daviess        -18.840 |  -0.330   0.140   0.006  -3.634 |</code></pre>
</div>
</div>
</section>
<section id="realisation-of-the-famd" class="level3">
<h3 class="anchored" data-anchor-id="realisation-of-the-famd">Realisation of the FAMD</h3>
<p>We can couple the summary with a plot of the inertia per axes :</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb247"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_eig</span>(<span class="at">X =</span> famd,</span>
<span id="cb247-2"><a href="#cb247-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">addlabels =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-FAMD-eig" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Analyse_Birds_files/figure-html/fig-FAMD-eig-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption class="figure-caption">Figure&nbsp;1: Percentage of explained variances depending on the dimensions</figcaption>
</figure>
</div>
</div>
</div>
<p><em>Conclusion :</em> We can see that keeping three axes is necessary to cover as much inertia as possible while being parcimonious. However, we will simplify the analysis by keeping only two axes in the interpretation parts. Now, we can see the contribution of the variables to the factorial axes :</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb248"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_contrib</span>(<span class="at">X =</span> famd,</span>
<span id="cb248-3"><a href="#cb248-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">choice =</span> <span class="st">"var"</span>,</span>
<span id="cb248-4"><a href="#cb248-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">axes =</span> <span class="dv">1</span></span>
<span id="cb248-5"><a href="#cb248-5" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb248-6"><a href="#cb248-6" aria-hidden="true" tabindex="-1"></a><span class="do">### County / State / Year / Species</span></span>
<span id="cb248-7"><a href="#cb248-7" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_contrib</span>(<span class="at">X =</span> famd,</span>
<span id="cb248-8"><a href="#cb248-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">choice =</span> <span class="st">"var"</span>,</span>
<span id="cb248-9"><a href="#cb248-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">axes =</span> <span class="dv">2</span></span>
<span id="cb248-10"><a href="#cb248-10" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb248-11"><a href="#cb248-11" aria-hidden="true" tabindex="-1"></a><span class="do">### Year / Habitat / County / Species</span></span>
<span id="cb248-12"><a href="#cb248-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-13"><a href="#cb248-13" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_contrib</span>(<span class="at">X =</span> famd,</span>
<span id="cb248-14"><a href="#cb248-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">choice =</span> <span class="st">"var"</span>,</span>
<span id="cb248-15"><a href="#cb248-15" aria-hidden="true" tabindex="-1"></a>             <span class="at">axes =</span> <span class="dv">3</span></span>
<span id="cb248-16"><a href="#cb248-16" aria-hidden="true" tabindex="-1"></a>             )</span>
<span id="cb248-17"><a href="#cb248-17" aria-hidden="true" tabindex="-1"></a>famd<span class="sc">$</span>var<span class="sc">$</span>contrib[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>] <span class="sc">&gt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">9</span><span class="sc">*</span><span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                Dim.1 Dim.2 Dim.3
Initiation_Date FALSE FALSE FALSE
Number_Fledged  FALSE FALSE FALSE
Nest_End_Date   FALSE FALSE FALSE
State            TRUE FALSE FALSE
County           TRUE  TRUE  TRUE
Habitat         FALSE  TRUE  TRUE
Species          TRUE  TRUE  TRUE
Year             TRUE  TRUE  TRUE
Nest_Fate       FALSE FALSE FALSE</code></pre>
</div>
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb250"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="do">### County / Habitat / Year / Species</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-FAMD-contrib-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Analyse_Birds_files/figure-html/fig-FAMD-contrib-1.png" class="img-fluid figure-img" width="768"></p>
<figcaption class="figure-caption">Figure&nbsp;2: Contributions of the variables to the axes</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-FAMD-contrib-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Analyse_Birds_files/figure-html/fig-FAMD-contrib-2.png" class="img-fluid figure-img" width="768"></p>
<figcaption class="figure-caption">Figure&nbsp;3: Contributions of the variables to the axes</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display">
<div id="fig-FAMD-contrib-3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Analyse_Birds_files/figure-html/fig-FAMD-contrib-3.png" class="img-fluid figure-img" width="768"></p>
<figcaption class="figure-caption">Figure&nbsp;4: Contributions of the variables to the axes</figcaption>
</figure>
</div>
</div>
</div>
<p>We can see that the only variables that contributed to the axes are the qualitative variables such as County, State, Year, Habitat and Species. The quantitative variables have low contributions.</p>
<p>And now, letâs observe the projections of the variables and of the observations :</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb251"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Axes 1 and 2</span></span>
<span id="cb251-2"><a href="#cb251-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_famd_var</span>(<span class="at">X =</span> famd, </span>
<span id="cb251-3"><a href="#cb251-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">repel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb251-4"><a href="#cb251-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">axes =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb251-5"><a href="#cb251-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">col.var =</span> <span class="st">"red"</span>,</span>
<span id="cb251-6"><a href="#cb251-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha.var =</span> <span class="dv">2</span>,</span>
<span id="cb251-7"><a href="#cb251-7" aria-hidden="true" tabindex="-1"></a>              <span class="st">"quali.var"</span></span>
<span id="cb251-8"><a href="#cb251-8" aria-hidden="true" tabindex="-1"></a>              )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Analyse_Birds_files/figure-html/famd_axes_12-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_famd_var</span>(<span class="at">X =</span> famd, </span>
<span id="cb252-2"><a href="#cb252-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">repel =</span> <span class="cn">TRUE</span>,</span>
<span id="cb252-3"><a href="#cb252-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">axes =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb252-4"><a href="#cb252-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">col.var =</span> <span class="st">"red"</span>,</span>
<span id="cb252-5"><a href="#cb252-5" aria-hidden="true" tabindex="-1"></a>              <span class="st">"quanti.var"</span></span>
<span id="cb252-6"><a href="#cb252-6" aria-hidden="true" tabindex="-1"></a>              )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Analyse_Birds_files/figure-html/famd_axes_12-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb253"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_famd_ind</span>(<span class="at">X =</span> famd, </span>
<span id="cb253-2"><a href="#cb253-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">repel =</span> <span class="cn">FALSE</span>,</span>
<span id="cb253-3"><a href="#cb253-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">axes =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb253-4"><a href="#cb253-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">col.ind =</span> <span class="st">"orange"</span>,</span>
<span id="cb253-5"><a href="#cb253-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">col.quali.var =</span> <span class="st">"red"</span></span>
<span id="cb253-6"><a href="#cb253-6" aria-hidden="true" tabindex="-1"></a>              )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Analyse_Birds_files/figure-html/famd_axes_12-3.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="realisation-of-a-hierarchical-clustering" class="level3">
<h3 class="anchored" data-anchor-id="realisation-of-a-hierarchical-clustering">Realisation of a Hierarchical clustering</h3>
<p>We can use the function fviz_cluster to visualise the optimal number of clusters to make. The k-means method is used.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a>famd_g <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(famd<span class="sc">$</span>ind<span class="sc">$</span>coord[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a>class <span class="ot">&lt;-</span> <span class="fu">HCPC</span>(famd_g,</span>
<span id="cb254-3"><a href="#cb254-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">nb.clust =</span> <span class="dv">3</span></span>
<span id="cb254-4"><a href="#cb254-4" aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb254-5"><a href="#cb254-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-6"><a href="#cb254-6" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_nbclust</span>(<span class="at">x =</span> famd_g,</span>
<span id="cb254-7"><a href="#cb254-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">method =</span> <span class="st">"silhouette"</span>,</span>
<span id="cb254-8"><a href="#cb254-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">FUNcluster =</span> kmeans,</span>
<span id="cb254-9"><a href="#cb254-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">linecolor =</span> <span class="st">"green3"</span></span>
<span id="cb254-10"><a href="#cb254-10" aria-hidden="true" tabindex="-1"></a>             )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Three clusters is the best choice according to the k-means method.</p>
<p>We can define classes for a Hierarchical Clustering thanks to the function fviz_cluster.</p>
<div class="cell">
<details>
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb255"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_cluster</span>(class, <span class="at">axes =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="at">ellipse.type =</span> <span class="st">"convex"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Analyse_Birds_files/figure-html/cluster_graph-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The fviz_cluster function shows three clusters. The projection of the variables shows an homogeneous scatterplots. The projection of the observations suggests two groups of individuals, separated merely by the axe of the ordinates. To determine the kinds of the groups, we have to gather variables.</p>
<p>The blue cluster is characterised by :</p>
<ul>
<li>Year = 1991, 1992, 1993, 1995, 1996 et 1997, 1998</li>
<li>County = Jo_Daviess, Lee, Lee/Ogle, Grundy, Rock, Will (Illinois)</li>
<li>State : Illinois</li>
<li>Species : Dickcissel, Western_Meadowlark,</li>
<li>Habitat : Prairie, Warm-season Grassland</li>
</ul>
<p>The red cluster is characterised by :</p>
<ul>
<li>Year : 1994, 1999, 2000, 2001, 2002</li>
<li>County : Green, Grant , Monroe, Lafayette</li>
<li>State : Wisconsin</li>
<li>Species : Savanah Sparrow</li>
<li>Habitat : Pasture</li>
</ul>
<p>The green side is characterised by :</p>
<ul>
<li>Year : 2003, 2004, 2005, 2006</li>
<li>County : Dane</li>
<li>State : Wisconsin</li>
<li>Species : Bobolink, Henslowâs Sparrow, Eastern Meadowlark</li>
<li>Habitat : Cool-season Grassland</li>
</ul>
<p>It is necessary to note that several species are near the border between the Illinois and the Wisconsin. Thus they can be seen in both states, which can be counter-intuitive by seeing the FAMD. However, the only factor that can explain this distribution could be years of sampling. There is a clear separation of the years depending on the part of the graphics.</p>
<p><span class="citation" data-cites="byers2017 ellison2013 herkert2003 renfrew2005 ribic ribic2012 vos2013">(<a href="#ref-byers2017" role="doc-biblioref"><strong>byers2017?</strong></a>; <a href="#ref-ellison2013" role="doc-biblioref"><strong>ellison2013?</strong></a>; <a href="#ref-herkert2003" role="doc-biblioref"><strong>herkert2003?</strong></a>; <a href="#ref-renfrew2005" role="doc-biblioref"><strong>renfrew2005?</strong></a>; <a href="#ref-ribic" role="doc-biblioref"><strong>ribic?</strong></a>; <a href="#ref-ribic2012" role="doc-biblioref"><strong>ribic2012?</strong></a>; <a href="#ref-vos2013" role="doc-biblioref"><strong>vos2013?</strong></a>)</span></p>
</section>
<section id="references" class="level3">
<h3 class="anchored" data-anchor-id="references">References</h3>
<div id="refs" role="list">

</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>