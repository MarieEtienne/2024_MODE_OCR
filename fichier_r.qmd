---
editor: 
  markdown: 
    wrap: 72
---

------------------------------------------------------------------------

title: "analyse_data_faune" group: "SLH ARMY"

bibliography: references.bib execute: freeze: auto output:
html_document: toc: true toc_float: true ---

PLAN POUR GLM:

-   CHARGEMENT DES DONNEES

```{r}
data_coefla = read.csv(file = "data_coefla.csv", header = T, sep = ";")
data_chiro  = read.csv(file = "data_chiro_test.csv" , header = T, sep = ";")
data_chiro$Masse<-as.numeric(data_chiro$Masse)
data_chiro$Age<-as.factor(data_chiro$Age)
plot(data_chiro$Age)

#Lune <- function(date){
#  sortie <- c()
#  for(i in 1:length(date)){
#  date_num <- as.numeric(as_date(date[i]))
#  sortie[i] <- (0.5*(cos((date_num-21)*((2*pi)/(29.530589)))#+1))
#  }
#  return(sortie)
#  }


length(data_rep$Date[6])



data_rep <- data_chiro[which(is.na(data_chiro$Repro)==F),]

# Lune(as.character(data_rep$Date[6]))



#test <- Lune(data_rep$Date)

data_rep$Date <-as.numeric(format(as_date(data_rep$Date),"%j"))


data <- data_rep[,c(1,3,4,6,7,8)]

data$Lune <- test

round_date <-floor(data$Date)


repro_sum <- c()
for (d in round_date){
  repro_sum <- c(repro_sum,length(data$Repro[which(data$Repro>0 & round_date==d)])/length(data$Repro[which(round_date==d)]))
}



#plot(unique(round_date),unique(repro_sum),pch=19,ylim=c(0,0.35))
```


```{r}
Lune <- function(date){
  sortie <- c()
  for(i in 1:length(date)){
  date_num <- as.numeric(as_date(date[i]))
  sortie[i] <- (0.5*(cos((date_num-21)*((2*pi)/(29.530589)))+1))
  }
  return(sortie)
  }


```
```{r}


mu <- mean(repro_sum)
sig <- var(repro_sum)

alpha <- mu*((mu*(1-mu))/(sig)-1)
beta <- alpha * (1-mu)/mu


x <- seq(0,1,0.05)
pdfB <- (x^(alpha-1)*(1-x)^(beta-1))/((gamma(alpha)*gamma(beta))/(gamma(alpha+beta)))
hist(repro_sum,probability = T,ylim = c(0,4),breaks=20)
lines(x,pdfB)


```

```{r}
plot(density(repro_sum,from=0,to=1,kernel = 'biweight'))
lines(x,pdfB)

```


-   EXPLORATION DU JEU DE DONNEE

    -   Valeurs aberrantes dans Y et dans les X

    ```{r}
    table()

    par(mfrow=c(1,3))

    # Cleveland plot
    dotchart(data,pch=16,col='',xlab='')
    # Histogram
    hist(data,col='',xlab="",main="")
    # Quantile-Quantile plot
    qqnorm(data,pch=16,col='',xlab='')
    qqline(data,col='',lwd=2)


    ## Voir si il faut faire une transformation des données


    ```

    -   Nombre de modalité et individus par modalité

    ```{r}
    summary()

    ```

    -   Relations potentielles entre Y et Xs

    ```{r}
    plot()

    mosaicplot()
    ```

    -   Eventuelles interactions entre les Xs

    ```{r}
    plot()
    points()

    #Avec courbes (exemple)
    coplot(Acarinarium~SQRTMites|Species,
           data = dataBombus ,
            panel = function(x, y, ...) {
             if(length(y[y>0])>5 & length(y[y==0])>5 ) {
               tmp <- glm(y ~ x, family=binomial, na.action = na.omit)
               MyDat<-data.frame(x=seq(from=min(x,na.rm=TRUE),
                                     to=max(x,na.rm=TRUE),
                                     length=25))
               P1<-predict(tmp,newdata=MyDat, type="response")
               lines(MyDat$x,P1,col='darkred',lwd=2)
             }
             points(x, y,pch=16,col='dodgerblue3') })
    ```

    -   Colinéarité entre les Xs

    ```{r}
    # Checking collinearity between both categorical independent variables
    table(var1,var2)

    # Checking collinearity between categorical and continuous independent variables
    par(mfrow=c(1,2))
    # Checker les couples de variable 2 à 2
    boxplot(var1~var2, varwidth = TRUE, ylab = "var1", xlab = "var2",col=c('dodgerblue3','darkred'), main = "")

    ```

-   ANALYSE STATISTIQUE

    -   Construction du modèle

    ```{r}
    ```

    -   Analyse des coefficients du modèle

    ```{r}
    ```

    -   Pouvoir explicatif du modèle

    ```{r}
    ```

-   VALIDATION DE LA MODELISATION

    -   Analyse des résidus

    ```{r}
    ```

    -   Vérification des individus influents

    ```{r}
    ```

    -   Simulations pour estimer la qualité d'ajustement du modèle

    ```{r}
    ```

-   CONCLUSION

```{r}
library(tidyverse)
```
