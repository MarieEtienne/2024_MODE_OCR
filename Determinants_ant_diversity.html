<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>The Companion book a M1 MODE student should have! - Determinants of Ant Species Density</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">The Companion book a M1 MODE student should have!</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://marieetienne.github.io/MODE_reproduciblescience/" rel="" target=""><i class="bi bi-home" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/MarieEtienne/2024_MODE_OCR" rel="" target=""><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://marieetienne.github.io/MODE_reproduciblescience/instructions.html" rel="" target="">
 <span class="menu-text">Instructions</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-courses-materials" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Courses Materials</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-courses-materials">    
        <li>
    <a class="dropdown-item" href="https://marieetienne.github.io/reproductibilite/_presentation/english_version.html" rel="" target="">
 <span class="dropdown-text">Git Intro</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-book-content" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Book content</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-book-content">    
        <li>
    <a class="dropdown-item" href="./fichier_r.html" rel="" target="">
 <span class="dropdown-text">Titre à trouver</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./Determinants_ant_diversity.html" rel="" target="">
 <span class="dropdown-text">Determinants of Ant Species Density</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">INTRODUCTION</a>
  <ul class="collapse">
  <li><a href="#article-presentation" id="toc-article-presentation" class="nav-link" data-scroll-target="#article-presentation"><strong>1. Article presentation</strong></a></li>
  <li><a href="#biological-context" id="toc-biological-context" class="nav-link" data-scroll-target="#biological-context"><strong>2. Biological context</strong></a></li>
  <li><a href="#datas-and-variables" id="toc-datas-and-variables" class="nav-link" data-scroll-target="#datas-and-variables"><strong>3. Datas and variables</strong></a></li>
  <li><a href="#research-question" id="toc-research-question" class="nav-link" data-scroll-target="#research-question"><strong>4. Research question</strong></a></li>
  <li><a href="#importing-the-dataset" id="toc-importing-the-dataset" class="nav-link" data-scroll-target="#importing-the-dataset"><strong>5. Importing the dataset</strong></a></li>
  <li><a href="#which-model-and-why" id="toc-which-model-and-why" class="nav-link" data-scroll-target="#which-model-and-why"><strong>6. Which model and why?</strong></a></li>
  <li><a href="#environment-configuration-and-packages" id="toc-environment-configuration-and-packages" class="nav-link" data-scroll-target="#environment-configuration-and-packages"><strong>7. Environment Configuration and Packages</strong></a></li>
  <li><a href="#checking-for-missing-data" id="toc-checking-for-missing-data" class="nav-link" data-scroll-target="#checking-for-missing-data"><strong>8. Checking for missing data</strong></a></li>
  <li><a href="#analysis-process" id="toc-analysis-process" class="nav-link" data-scroll-target="#analysis-process"><strong>9. Analysis process</strong></a></li>
  </ul></li>
  <li><a href="#data-exploration" id="toc-data-exploration" class="nav-link" data-scroll-target="#data-exploration">DATA EXPLORATION</a>
  <ul class="collapse">
  <li><a href="#data-overview" id="toc-data-overview" class="nav-link" data-scroll-target="#data-overview"><strong>1. Data overview</strong></a></li>
  <li><a href="#analysis-of-interactions-between-variables-y-and-xs" id="toc-analysis-of-interactions-between-variables-y-and-xs" class="nav-link" data-scroll-target="#analysis-of-interactions-between-variables-y-and-xs"><strong>2. Analysis of interactions between variables Y and Xs</strong></a></li>
  </ul></li>
  <li><a href="#statistical-analysis" id="toc-statistical-analysis" class="nav-link" data-scroll-target="#statistical-analysis">STATISTICAL ANALYSIS</a>
  <ul class="collapse">
  <li><a href="#model-construction" id="toc-model-construction" class="nav-link" data-scroll-target="#model-construction"><strong>1. Model construction</strong></a></li>
  <li><a href="#coefficients-analysis" id="toc-coefficients-analysis" class="nav-link" data-scroll-target="#coefficients-analysis"><strong>2. Coefficients analysis</strong></a></li>
  <li><a href="#explanatory-power-of-the-model" id="toc-explanatory-power-of-the-model" class="nav-link" data-scroll-target="#explanatory-power-of-the-model"><strong>3. Explanatory power of the model</strong></a></li>
  <li><a href="#model-validation" id="toc-model-validation" class="nav-link" data-scroll-target="#model-validation"><strong>4. Model validation</strong></a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">CONCLUSION</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Determinants of Ant Species Density</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="introduction" class="level1">
<h1>INTRODUCTION</h1>
<section id="article-presentation" class="level3">
<h3 class="anchored" data-anchor-id="article-presentation"><strong>1. Article presentation</strong></h3>
<p>Our data come from the article “Biogeography at a Regional Scale: Determinants of Ant Species Density in New England Bogs and Forests” by <span class="citation" data-cites="Gotelli_2002">Nicholas J. Gotelli (<a href="#ref-Gotelli_2002" role="doc-biblioref">2002</a>)</span>.</p>
</section>
<section id="biological-context" class="level3">
<h3 class="anchored" data-anchor-id="biological-context"><strong>2. Biological context</strong></h3>
<p>Gotelli and Ellison are two ecologists, the first one specializing in questions of organization of animal and plant communities, the second one in the disintegration and reassembly of ecosystems following natural and anthropogenic disturbances. Here, they focused on the influence of the latitudinal gradient on the species richness of ants in the state of New England in the northeastern United States. Their study was carried out on 22 sites where, for each, 25 traps were placed in an ombrotrophic peat bog and 25 in the surrounding forest. The species of ants contained in the traps are subsequently identified in the laboratory and, for a given site and habitat, they calculated the species richness (total number of species present).</p>
</section>
<section id="datas-and-variables" class="level3">
<h3 class="anchored" data-anchor-id="datas-and-variables"><strong>3. Datas and variables</strong></h3>
<p>The variables used are :<br>
- <em>Site</em> : the name of the sampled site<br>
- <em>Latitude</em> : site latitude (quantitative)<br>
- <em>Altitude</em> : site altitude (quantitative)<br>
- <em>Area</em> : the area of the peat bog of the site (quantitative)<br>
- <em>Location</em> : the location of the traps (“Bog” or “Forest”) (qualitative)<br>
- <em>Nsp</em> : the specific richness of ants, corresponding to the response variable</p>
</section>
<section id="research-question" class="level3">
<h3 class="anchored" data-anchor-id="research-question"><strong>4. Research question</strong></h3>
<p>Gotelli and Ellison address 3 questions in this study, but we focus here on two:</p>
<p>1) Is species density correlated with latitude over such a narrow latitudinal range?</p>
<p>2) Does the latitudinal gradient persist after statistically controlling for site differences in vegetation composition?</p>
<p>In other words: what are the quantitative (latitude, altitude, area) and qualitative (location) variables that determine ant species richness in New England peatlands?</p>
</section>
<section id="importing-the-dataset" class="level3">
<h3 class="anchored" data-anchor-id="importing-the-dataset"><strong>5. Importing the dataset</strong></h3>
<p>From then on, we can import the dataset located in file “BogAnts.txt”</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Session Configuration :</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) <span class="co"># Cleaning the work environment</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Importation</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>dataAnts <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"BogAnts.txt"</span>, <span class="at">dec=</span><span class="st">"."</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Transforming location into a factor</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>dataAnts<span class="sc">$</span>Location<span class="ot">&lt;-</span><span class="fu">as.factor</span>(dataAnts<span class="sc">$</span>Location)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Checking the type of variables</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dataAnts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   44 obs. of  6 variables:
 $ Site     : chr  "ARC" "ARC" "BH" "BH" ...
 $ Latitude : num  42.3 42.3 42.6 42.6 45 ...
 $ Elevation: int  95 95 274 274 133 133 210 210 362 362 ...
 $ Area     : int  1190 1190 105369 105369 38023 38023 73120 73120 38081 38081 ...
 $ Location : Factor w/ 2 levels "Bog","Forest": 2 1 2 1 2 1 2 1 2 1 ...
 $ Nsp      : int  9 8 10 8 6 5 9 4 6 2 ...</code></pre>
</div>
</div>
<p><u><strong>Conclusion</strong></u> <strong>:</strong></p>
<p>Qualitative or quantitative variables are well considered as such.</p>
</section>
<section id="which-model-and-why" class="level3">
<h3 class="anchored" data-anchor-id="which-model-and-why"><strong>6. Which model and why?</strong></h3>
<p>To model the relationship between a quantitative response variable <span class="math inline">\(Y\)</span> and explanatory variables <span class="math inline">\(X_{1}\)</span>,<span class="math inline">\(X_{2}\)</span>…<span class="math inline">\(X_{p}\)</span>, quantitative and/or qualitative we use general linear models, or <em>glm</em>, (linear regression, ANCOVA, ANOVA). To be able to use these <em>glm</em>, three conditions of application are necessary: ​​<em>homogeneity of variances</em>, <em>residual independence</em> and <em>residual normality</em>. However, the <span class="math inline">\(Y\)</span> responses analyzed in ecology can sometimes be discrete and deviate from the hypothesis of normality.</p>
<p>For discrete response variables (counts, binary data), the variance of <span class="math inline">\(Y\)</span> generally varies with the mean of <span class="math inline">\(Y\)</span>. This relationship then seems to indicate that the variance cannot be homogeneous in a data set, due to its dependence on the mean. However, general linear models have a constant variance as their application hypothesis (i.e.&nbsp;a homogeneity of the variance). Furthermore, when applying a general linear model to count data, the predicted values ​​obtained may be negative (which is impossible given the nature of <span class="math inline">\(Y\)</span>) and the residuals may not be normally distributed. Therefore, using a general linear model (<em>glm</em>) on discrete responses very generally generates deviations from the application conditions. In conclusion, it becomes necessary to use a method more suited to the analysis of discrete response variables such as generalized linear models (<em>glim</em>).</p>
<p><strong>Here are the steps to follow to establish a generalized linear model:</strong><br>
1. Formulate the hypothesis of the distribution law of the response variable <span class="math inline">\(Y_{i}\)</span><br>
2. Explore the data (outliers, distribution of values,) with <span class="citation" data-cites="Zuur_2010">Alain F. Zuur (<a href="#ref-Zuur_2010" role="doc-biblioref">2010</a>)</span> protocol<br>
3. Analyze the interactions between the variables Y and Xs (analysis of the relationships between X and Y, between Xs, and search for collinearity between Xs)<br>
4. Proceed with statistical analyses (construction of the model, analysis of the coefficients, explanatory power of the model)<br>
5. Conclude on the results</p>
<p>A generalized linear model is written as follows (equation 1): <span id="eq-1"><span class="math display">\[g(\mu_{y})= \alpha+ \beta_{1}.X_{i1}+ \beta_{2}.X_{i2}+\beta_{3}.X_{i3}+...\beta_{p}.X_{ip} = \eta  \tag{1}\]</span></span> The linear predictor, <span class="math inline">\(\eta\)</span>, is derived from the linear model as the sum of the <span class="math inline">\(p\)</span> terms associated with each of the <span class="math inline">\(\beta_{p}\)</span> parameters. Its value is obtained by transforming the value of <span class="math inline">\(Y\)</span> by the link function, and the predicted value of <span class="math inline">\(Y\)</span> is obtained by applying to <span class="math inline">\(\eta\)</span> the inverse function of the link function.</p>
<p>To illustrate this point, we are interested in counts. A count is a discrete and positive random variable. It is possible that the distribution of its values follows a Poisson distribution, a Negative Binomial distribution or even a Normal distribution when the values are very large.</p>
<p>Our example illustrates a distribution following the Poisson law.</p>
<p>The Poisson law is useful for describing rare and independent discrete events. Thus, a variable <span class="math inline">\(Y\)</span> that follows a Poisson law with parameter <span class="math inline">\(\lambda\)</span> is written as follows (equation 2): <span id="eq-2"><span class="math display">\[Pr(Y=y)=\frac{e^{-\lambda}.\ lambda^y}{y!} \tag{2}\]</span></span> where <span class="math inline">\(y\)</span> represents the observed number of occurrences (i.e., <span class="math inline">\(y\)</span>=0, 1, 2…} and <span class="math inline">\(\lambda\)</span> the mean and variance of the Poisson law (i.e.&nbsp;in the Poisson law: E(<span class="math inline">\(y\)</span>)= Var(<span class="math inline">\(y\)</span>)=<span class="math inline">\(\lambda\)</span>).</p>
<p>In a Poisson-type <em>glim</em>, the link function is the <strong>log</strong> function. Thus, the model is written (equation 3): <span id="eq-3"><span class="math display">\[log(\mu_{y})= \alpha+ \beta_{1}.X{i1}+ \beta_{2}.X{i2}+\beta_{3}.X{i3}+...\beta_{p}.X{ip} = \eta  \tag{3}\]</span></span> 150 / 5 000 The predicted values ​​of <span class="math inline">\(Y\)</span> are obtained by applying to <span class="math inline">\(\eta\)</span> the inverse function of the link function, here the <strong>log</strong> function (equation 4): <span id="eq-4"><span class="math display">\[\mu_{y}= e^{\alpha+ \beta_{1}.X{i1}+ \beta_{2}.X{i2}+\beta_{3}.X{i3}+...\beta_{p}.X{ip}} = e^{\eta}  \tag{4}\]</span></span></p>
<p>Generalized linear models of the Poisson type have an error structure that follows a Poisson distribution. This structure allows, among other things, to precisely define the relationship between the mean and the variance. This relationship is exploited by the maximum likelihood method to estimate the coefficients and standard errors of the parameters of the GLM model.</p>
</section>
<section id="environment-configuration-and-packages" class="level3">
<h3 class="anchored" data-anchor-id="environment-configuration-and-packages"><strong>7. Environment Configuration and Packages</strong></h3>
<p>To analyze our data we set up the session by cleaning the workspace. We will also need to load the following packages : <em>knitr</em>, <em>ggplot2</em>, <em>tinytext</em>, <em>corrplot</em>, <em>plot3D</em>, <em>DHARMa</em>, <em>rcompanion</em>, <em>lattice</em>, <em>patchwork</em>, <em>MASS</em> et <em>rcompanion</em></p>
</section>
<section id="checking-for-missing-data" class="level3">
<h3 class="anchored" data-anchor-id="checking-for-missing-data"><strong>8. Checking for missing data</strong></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Checking for missing data</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(dataAnts))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Site  Latitude Elevation      Area  Location       Nsp 
        0         0         0         0         0         0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dataAnts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Site              Latitude       Elevation          Area       
 Length:44          Min.   :41.97   Min.   :  1.0   Min.   :   248  
 Class :character   1st Qu.:42.17   1st Qu.: 95.0   1st Qu.:  8852  
 Mode  :character   Median :42.56   Median :223.0   Median : 38052  
                    Mean   :43.02   Mean   :232.7   Mean   :144528  
                    3rd Qu.:44.29   3rd Qu.:353.0   3rd Qu.: 89208  
                    Max.   :44.95   Max.   :543.0   Max.   :864970  
   Location       Nsp        
 Bog   :22   Min.   : 2.000  
 Forest:22   1st Qu.: 4.000  
             Median : 6.000  
             Mean   : 7.023  
             3rd Qu.: 8.250  
             Max.   :18.000  </code></pre>
</div>
</div>
<p>There are no missing values.</p>
</section>
<section id="analysis-process" class="level3">
<h3 class="anchored" data-anchor-id="analysis-process"><strong>9. Analysis process</strong></h3>
<p>From this, we will first examine the dataset (outliers, potential relationships between Y and Xs, …) in order to have a first impression. Subsequently, we will carry out our statistical analysis by building and refining our model. Finally, we will analyze its coefficients and its explanatory power in order to validate it or not.</p>
</section>
</section>
<section id="data-exploration" class="level1">
<h1>DATA EXPLORATION</h1>
<section id="data-overview" class="level3">
<h3 class="anchored" data-anchor-id="data-overview"><strong>1. Data overview</strong></h3>
<section id="a.-outliers-in-y-and-distribution-of-y-values" class="level5">
<h5 class="anchored" data-anchor-id="a.-outliers-in-y-and-distribution-of-y-values"><strong>a. Outliers in</strong> Y <strong>and distribution of</strong> Y <strong>values</strong></h5>
<p>The first step in exploring the dataset is to check for <strong>potential outliers</strong> in the response variable <span class="math inline">\(Y\)</span> and to examine the <strong>distribution</strong> of its values.</p>
<p><strong>Outliers:</strong> In ecological datasets, it is common to encounter individuals with extreme values for the response variable. These individuals, due to their unusual values, may disproportionately impact model construction. However, these extreme values may arise from either the natural variability of ecological phenomena or from errors (e.g., measurement or handling errors). Identifying these individuals prior to statistical analysis helps prevent errors and, if necessary, justifies the exclusion of certain outliers to improve the model’s robustness.</p>
<p>Outliers can be identified using a <strong>Boxplot</strong> or a <strong>Cleveland plot</strong> of the values of <span class="math inline">\(Y\)</span>.</p>
<div class="cell" data-paged.print="true">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplot </span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>bp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> dataAnts, <span class="fu">aes</span>(<span class="at">y =</span> Nsp))<span class="sc">+</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">"A. Boxplot"</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"species richness"</span>)<span class="sc">+</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">"white"</span>),</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>),</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>),</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">color =</span> <span class="st">"black"</span>),       </span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"black"</span>),                  </span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">face =</span> <span class="st">"italic"</span>, <span class="at">color =</span> <span class="st">"darkgrey"</span>)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Cleveland plot </span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>cp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> dataAnts, <span class="fu">aes</span>(<span class="at">x =</span> Nsp, <span class="at">y =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(dataAnts)))<span class="sc">+</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.1</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">"B. Cleveland plot"</span>,</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"species richness"</span>)<span class="sc">+</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>),</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">color =</span> <span class="st">"black"</span>),       </span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"black"</span>),                  </span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">face =</span> <span class="st">"italic"</span>, <span class="at">color =</span> <span class="st">"darkgrey"</span>)</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a><span class="do">## Display</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>(bp <span class="sc">+</span> cp) <span class="sc">+</span> </span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-plotYoutliers" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Determinants_ant_diversity_files/figure-html/fig-plotYoutliers-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;1: Analyse of Y outliers</figcaption>
</figure>
</div>
</div>
</div>
<p>According to <a href="#fig-plotYoutliers">Figure&nbsp;1</a>, <span class="math inline">\(Y\)</span> does not exhibit any extreme or outlier values.</p>
<p><strong>Distribution of values:</strong> Analyzing the distribution of the values of <span class="math inline">\(Y\)</span> allows us to preliminarily identify the probability distribution that best explains the ongoing ecological processes. This is particularly interesting if the data suggest a non-linear or asymmetric relationship.</p>
<p>The distribution of <span class="math inline">\(Y\)</span> values can be visualized using a <strong>histogram</strong> or a <strong>Normal Q-Q plot</strong>.</p>
<div class="cell" data-paged.print="true">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>hg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> dataAnts, <span class="fu">aes</span>(<span class="at">x =</span> Nsp))<span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">2</span>, <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">color =</span> <span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">"A. Histogram"</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"species richness"</span>,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"frequency"</span>)<span class="sc">+</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>),</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>),</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">color =</span> <span class="st">"black"</span>),       </span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"black"</span>),                  </span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">face =</span> <span class="st">"italic"</span>, <span class="at">color =</span> <span class="st">"darkgrey"</span>)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>qqp <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> dataAnts, <span class="fu">aes</span>(<span class="at">sample =</span> Nsp))<span class="sc">+</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq_line</span>(<span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="fl">1.2</span>)<span class="sc">+</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_qq</span>()<span class="sc">+</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">"B. Q-Q plot"</span>,</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"theorical quantiles"</span>,</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"observed quantiles"</span>)<span class="sc">+</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>),</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>),</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">color =</span> <span class="st">"black"</span>),       </span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"black"</span>),                  </span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">face =</span> <span class="st">"italic"</span>, <span class="at">color =</span> <span class="st">"darkgrey"</span>)</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Display</span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>(hg <span class="sc">+</span> qqp) <span class="sc">+</span></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">widths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-plotYdistribution" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Determinants_ant_diversity_files/figure-html/fig-plotYdistribution-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;2: Analyse of Y distribution</figcaption>
</figure>
</div>
</div>
</div>
<p>The distribution of <span class="math inline">\(Y\)</span> (negative exponential, <a href="#fig-plotYdistribution">Figure&nbsp;2</a> A) and the nature of the dataset (count data without aggregation) suggest that <span class="math inline">\(Y\)</span> follows a Poisson distribution. This hypothesis is supported by the deviation from normality of <span class="math inline">\(Y\)</span> observed values shown in <a href="#fig-plotYdistribution">Figure&nbsp;2</a> B.</p>
<p><u><strong>Conclusion</strong></u> <strong>:</strong></p>
<p>After analyzing the outliers and the distribution of the response variable $Y$, it appears appropriate to use <span class="math inline">\(Y\)</span> as is while applying a Poisson distribution.</p>
</section>
<section id="b.-x-quantitative-presence-of-outliers-and-distribution-of-x-values" class="level5">
<h5 class="anchored" data-anchor-id="b.-x-quantitative-presence-of-outliers-and-distribution-of-x-values"><strong>b.</strong> X <strong>quantitative: presence of outliers and distribution of</strong> X <strong>values</strong></h5>
<p>The dataset has three quantitative explanatory variables: <strong>Latitude, Elevation,</strong> and <strong>Area</strong>. Just like for the response variable <span class="math inline">\(Y\)</span>, it is necessary to examine the presence of <strong>outliers</strong> as well as the <strong>distribution</strong> of each of these explanatory variables.</p>
<p><u><strong>Latitude</strong></u> <strong>:</strong></p>
<div class="cell" data-paged.print="true">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dataAnts) <span class="sc">+</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>Latitude, <span class="at">y=</span><span class="fu">factor</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(dataAnts), <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(dataAnts))) <span class="sc">+</span> <span class="co"># display in the order of appearance</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width=</span><span class="dv">0</span>, <span class="at">height=</span><span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fl">41.5</span>, <span class="dv">45</span>, <span class="at">by =</span> <span class="fl">0.5</span>)) <span class="sc">+</span> <span class="co"># values of the X axis</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">"A. Cleveland Plot"</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span> <span class="st">"Latitude"</span>) <span class="sc">+</span>  <span class="co"># Titres</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),   <span class="co"># remove the labels from the Y axis</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),  <span class="co"># remove the ticks from the Y axis</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),  <span class="co"># remove the title from the X axis</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>),</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">color =</span> <span class="st">"black"</span>),</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"black"</span>)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>        )   </span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dataAnts) <span class="sc">+</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> Latitude) <span class="sc">+</span>  </span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.25</span>, <span class="at">fill =</span> <span class="st">"blue"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span>  <span class="co"># histogram</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fl">41.5</span>, <span class="dv">45</span>, <span class="at">by =</span> <span class="fl">0.5</span>)) <span class="sc">+</span>  <span class="co"># values of the X axis</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">2</span>)) <span class="sc">+</span>  <span class="co"># values of the Y axis </span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">"B. Histogram"</span>,</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Latitude"</span>) <span class="sc">+</span>  <span class="co"># title</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span>  <span class="co"># theme of the graph: minimal</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>), </span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>),</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"black"</span>)</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dataAnts, <span class="fu">aes</span>(<span class="at">sample =</span> Latitude)) <span class="sc">+</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="st">"C. Quantile-Quantile Plot"</span>,</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"From the dataset dataAnts"</span>,</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"theorical quantiles"</span>,</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"observed quantiles"</span>) <span class="sc">+</span></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span>  <span class="co"># observed quantiles</span></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>(<span class="at">col =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span>  <span class="co"># theorical quantiles</span></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>),</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>, <span class="at">color =</span> <span class="st">"darkblue"</span>),</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">color =</span> <span class="st">"black"</span>),       </span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">color =</span> <span class="st">"black"</span>),                  </span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">4</span>, <span class="at">face =</span> <span class="st">"italic"</span>, <span class="at">color =</span> <span class="st">"darkgrey"</span>) </span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>(p1 <span class="sc">/</span> p2) <span class="sc">|</span> p3 <span class="sc">+</span> </span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">guides =</span> <span class="st">"collect"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-plotLatitude" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Determinants_ant_diversity_files/figure-html/fig-plotLatitude-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;3: Analyse of explanatory variable Latitude</figcaption>
</figure>
</div>
</div>
</div>
<p>There are no outliers observed in the Cleveland plot (<a href="#fig-plotLatitude">Figure&nbsp;3</a> A) or in the histogram (<a href="#fig-plotLatitude">Figure&nbsp;3</a> B).</p>
<p>The Quantile plot (<a href="#fig-plotLatitude">Figure&nbsp;3</a> C) shows a deviation from normality. This suggests that it is more appropriate to use a generalized linear model (glm) rather than a classical linear model (lm).</p>
<p><u><strong>Elevation</strong></u> <strong>:</strong></p>
<div class="cell" data-paged.print="true">
<div class="cell-output-display">
<div id="fig-plotElevation" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Determinants_ant_diversity_files/figure-html/fig-plotElevation-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;4: Analyse of explanatory variable Elevation</figcaption>
</figure>
</div>
</div>
</div>
<p>No outliers are observed in the Cleveland plot (<a href="#fig-plotElevation">Figure&nbsp;4</a> A) or in the histogram (<a href="#fig-plotElevation">Figure&nbsp;4</a> B).</p>
<p>The Quantile plot (<a href="#fig-plotElevation">Figure&nbsp;4</a> C) shows a deviation from normality. This suggests that it is advisable to use a generalized linear model rather than a classical linear model.</p>
<p><u><strong>Area</strong></u> <strong>:</strong></p>
<div class="cell" data-paged.print="true">
<div class="cell-output-display">
<div id="fig-plotArea" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Determinants_ant_diversity_files/figure-html/fig-plotArea-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;5: Analyse of explanatory variable Area</figcaption>
</figure>
</div>
</div>
</div>
<p>We observe outliers in the Cleveland plot (<a href="#fig-plotArea">Figure&nbsp;5</a> A) and in the histogram (<a href="#fig-plotArea">Figure&nbsp;5</a> B) due to the presence of very extensive peatlands. We can apply a transformation to this variable and consider a <strong>logarithmic transformation</strong>.</p>
<div class="cell" data-paged.print="true">
<div class="cell-output-display">
<div id="fig-plotLogArea" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Determinants_ant_diversity_files/figure-html/fig-plotLogArea-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;6: Analyse of explanatory variable log(Area)</figcaption>
</figure>
</div>
</div>
</div>
<p>No outliers are observed in the Cleveland plot (<a href="#fig-plotLogArea">Figure&nbsp;6</a> A) or in the histogram (<a href="#fig-plotLogArea">Figure&nbsp;6</a> B).</p>
<p><u><strong>Conclusion</strong></u> <strong>:</strong></p>
<p>The analysis of outliers and the distribution of the variables suggest that, after modification, the three quantitative variables (covariates) <strong>Latitude, Elevation,</strong> and <strong>LogArea</strong> can be used in the construction of the model.</p>
</section>
<section id="c.-x-qualitative-number-of-modalities-and-number-of-individuals-per-modalities" class="level5">
<h5 class="anchored" data-anchor-id="c.-x-qualitative-number-of-modalities-and-number-of-individuals-per-modalities"><strong>c.&nbsp;X qualitative : number of modalities and number of individuals per modalities</strong></h5>
<p>When the dataset includes qualitative variables (factors), it is essential to analyze the balance of modalities: if there are more individuals in one modality compared to another, their weight in the model may lead to a biased final interpretation.</p>
<div class="cell" data-paged.print="true">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dataAnts<span class="sc">$</span>Location)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Bog Forest 
    22     22 </code></pre>
</div>
</div>
<p>Here, the data are well distributed between the two modalities (Bog = peatlands and Forest = forests).</p>
<p><u><strong>Conclusion</strong></u> <strong>:</strong></p>
<p>The analysis of outliers and the distribution of the qualitative variable suggest that it can be used in the construction of the model.</p>
</section>
</section>
<section id="analysis-of-interactions-between-variables-y-and-xs" class="level3">
<h3 class="anchored" data-anchor-id="analysis-of-interactions-between-variables-y-and-xs"><strong>2. Analysis of interactions between variables Y and Xs</strong></h3>
<section id="a.-analyze-the-potential-relationship-between-y-and-xs" class="level5">
<h5 class="anchored" data-anchor-id="a.-analyze-the-potential-relationship-between-y-and-xs"><strong>a. Analyze the potential relationship between Y and Xs</strong></h5>
<p>In order to test the possible relationship between the response variable <span class="math inline">\(Y\)</span> and the explanatory variables <span class="math inline">\(Xs\)</span>, it will be essential to carry out statistical modelling, as this is the only way to test the significance of the relationships. However, we can start by performing graphical analyses to better visualize the data and get an idea</p>
<div class="cell" data-paged.print="true">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># For the latitude variable</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dataAnts<span class="sc">$</span>Nsp<span class="sc">~</span>dataAnts<span class="sc">$</span>Latitude,<span class="at">pch=</span><span class="dv">16</span>,<span class="at">col=</span><span class="st">'deepskyblue4'</span>,<span class="at">xlab=</span><span class="st">'Latitude'</span>,<span class="at">ylab=</span><span class="st">'Ant species richness'</span>, <span class="at">main =</span> <span class="st">"A. Latitude"</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co"># For the altitude variable</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dataAnts<span class="sc">$</span>Nsp<span class="sc">~</span>dataAnts<span class="sc">$</span>Elevation,<span class="at">pch=</span><span class="dv">16</span>,<span class="at">col=</span><span class="st">'deepskyblue4'</span>,<span class="at">xlab=</span><span class="st">'Elevation'</span>,<span class="at">ylab=</span><span class="st">'Ant species richness'</span>, <span class="at">main =</span> <span class="st">"B. Elevation"</span>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="co"># For the variable peatland area</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dataAnts<span class="sc">$</span>Nsp<span class="sc">~</span>dataAnts<span class="sc">$</span>LogArea,<span class="at">pch=</span><span class="dv">16</span>,<span class="at">col=</span><span class="st">'deepskyblue4'</span>,<span class="at">xlab=</span><span class="st">'Peatland area'</span>,<span class="at">ylab=</span><span class="st">'Ant species richness'</span>, <span class="at">main =</span> <span class="st">"C. Peatland area"</span>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co"># For the location variable</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(dataAnts<span class="sc">$</span>Nsp<span class="sc">~</span>dataAnts<span class="sc">$</span>Location, <span class="at">varwidth =</span> <span class="cn">TRUE</span>, <span class="at">ylab =</span> <span class="st">"Ant species richness"</span>, <span class="at">xlab =</span> <span class="st">"Location"</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">'saddlebrown'</span>,<span class="st">'palegreen4'</span>), <span class="at">main =</span> <span class="st">"D. Location"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-plotYXS" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Determinants_ant_diversity_files/figure-html/fig-plotYXS-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;7: Analyse of relation between Y and explanatory variable</figcaption>
</figure>
</div>
</div>
</div>
<p>Relationship between ant species richness and latitude (<a href="#fig-plotYXS">Figure&nbsp;7</a> A): We can see that the higher the latitude, the lower the species richness. We can say that the further north we are, the fewer ant species there are.</p>
<p>Relationship between ant species richness and altitude (<a href="#fig-plotYXS">Figure&nbsp;7</a> B): In this graph, we can again see that the higher the altitude, the lower the species richness.</p>
<p>Relationship between ant species richness and bog area (<a href="#fig-plotYXS">Figure&nbsp;7</a> C): Here, there appears to be no relationship between ant species richness and bog area.</p>
<p>Relationship between ant species richness and location (<a href="#fig-plotYXS">Figure&nbsp;7</a> D.): Here, there appears to be a relationship between location and ant species richness, with higher species richness in forests than in bogs.</p>
<p><u><strong>Conclusion</strong></u> <strong>:</strong></p>
<p>It seems that the further north and the higher the relief, the lower the ant species richness. What’s more, if we’re in a forest, the species richness will be greater than in bogs.</p>
</section>
<section id="b.-analysis-of-potential-interactions-among-the-x-variables" class="level5">
<h5 class="anchored" data-anchor-id="b.-analysis-of-potential-interactions-among-the-x-variables"><strong>b. Analysis of Potential Interactions Among the X Variables</strong></h5>
<p>We aim to study interactions between the factor and the three covariates. Thus, we exclude any interaction among the quantitative explanatory variables. We use a graphical approach to estimate the potential interactive effect among these different variables.</p>
<div class="cell" data-paged.print="true">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Interactions between Latitude &amp; Location</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dataAnts<span class="sc">$</span>Nsp<span class="sc">~</span>dataAnts<span class="sc">$</span>Latitude,<span class="at">type=</span><span class="st">'n'</span>,<span class="at">ylab =</span> <span class="st">"Ant specific richness"</span>,<span class="at">xlab=</span><span class="st">"Latitude"</span>, <span class="at">main=</span><span class="st">"A."</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(dataAnts<span class="sc">$</span>Nsp[dataAnts<span class="sc">$</span>Location<span class="sc">==</span><span class="st">"Bog"</span>]<span class="sc">~</span>dataAnts<span class="sc">$</span>Latitude[dataAnts<span class="sc">$</span>Location<span class="sc">==</span><span class="st">"Bog"</span>],<span class="at">pch=</span><span class="dv">16</span>,<span class="at">cex=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">'saddlebrown'</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(dataAnts<span class="sc">$</span>Nsp[dataAnts<span class="sc">$</span>Location<span class="sc">==</span><span class="st">"Forest"</span>]<span class="sc">~</span>dataAnts<span class="sc">$</span>Latitude[dataAnts<span class="sc">$</span>Location<span class="sc">==</span><span class="st">"Forest"</span>],<span class="at">pch=</span><span class="dv">17</span>,<span class="at">cex=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">'palegreen4'</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Interactions between Altitude &amp; Localisation</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dataAnts<span class="sc">$</span>Nsp<span class="sc">~</span>dataAnts<span class="sc">$</span>Elevation,<span class="at">type=</span><span class="st">'n'</span>,<span class="at">ylab =</span> <span class="st">"Ant specific richness"</span>,<span class="at">xlab=</span><span class="st">"Elevation"</span>, <span class="at">main=</span><span class="st">"B."</span>)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(dataAnts<span class="sc">$</span>Nsp[dataAnts<span class="sc">$</span>Location<span class="sc">==</span><span class="st">"Bog"</span>]<span class="sc">~</span>dataAnts<span class="sc">$</span>Elevation[dataAnts<span class="sc">$</span>Location<span class="sc">==</span><span class="st">"Bog"</span>],<span class="at">pch=</span><span class="dv">16</span>,<span class="at">cex=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">'saddlebrown'</span>)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(dataAnts<span class="sc">$</span>Nsp[dataAnts<span class="sc">$</span>Location<span class="sc">==</span><span class="st">"Forest"</span>]<span class="sc">~</span>dataAnts<span class="sc">$</span>Elevation[dataAnts<span class="sc">$</span>Location<span class="sc">==</span><span class="st">"Forest"</span>],<span class="at">pch=</span><span class="dv">17</span>,<span class="at">cex=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">'palegreen4'</span>)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Interactions between Superficie de la tourbière &amp; Localisation</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(dataAnts<span class="sc">$</span>Nsp<span class="sc">~</span>dataAnts<span class="sc">$</span>LogArea,<span class="at">type=</span><span class="st">'n'</span>,<span class="at">ylab =</span> <span class="st">"Ant specific richness"</span>,<span class="at">xlab=</span><span class="st">"Bog area"</span>, <span class="at">main=</span><span class="st">"C."</span>)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(dataAnts<span class="sc">$</span>Nsp[dataAnts<span class="sc">$</span>Location<span class="sc">==</span><span class="st">"Bog"</span>]<span class="sc">~</span>dataAnts<span class="sc">$</span>LogArea[dataAnts<span class="sc">$</span>Location<span class="sc">==</span><span class="st">"Bog"</span>],<span class="at">pch=</span><span class="dv">16</span>,<span class="at">cex=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">'saddlebrown'</span>)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(dataAnts<span class="sc">$</span>Nsp[dataAnts<span class="sc">$</span>Location<span class="sc">==</span><span class="st">"Forest"</span>]<span class="sc">~</span>dataAnts<span class="sc">$</span>LogArea[dataAnts<span class="sc">$</span>Location<span class="sc">==</span><span class="st">"Forest"</span>],<span class="at">pch=</span><span class="dv">17</span>,<span class="at">cex=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">'palegreen4'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-plotXS" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Determinants_ant_diversity_files/figure-html/fig-plotXS-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;8: Analyse of relation between explanatory variable</figcaption>
</figure>
</div>
</div>
</div>
<p>Generally if we look at <a href="#fig-plotXS">Figure&nbsp;8</a>, we can assume an interaction between covariates if the slopes formed by the two point clouds are different. Here, the clouds do not clearly reveal any similarity or difference in trend for each graph. It is therefore difficult to draw conclusions about these interactions.</p>
</section>
<section id="c.-checking-for-potential-collinearity-among-the-x-variables" class="level5">
<h5 class="anchored" data-anchor-id="c.-checking-for-potential-collinearity-among-the-x-variables"><strong>c.&nbsp;Checking for Potential Collinearity Among the X Variables</strong></h5>
<p>We aim to avoid collinearity among the explanatory variables in our modeling to prevent multiple variables from providing the same information. To do this, we must examine the statistical relationships that may exist among the variables by calculating the correlation between quantitative <span class="math inline">\(X\)</span> variables, and analyzing the influence of the qualitative <span class="math inline">\(X\)</span> on the quantitative <span class="math inline">\(X\)</span> variables using plot graphics.</p>
<div class="cell" data-paged.print="true">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Checking for collinearity between independent continuous variables</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a scatterplot for each pair of covariates</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>newdata<span class="ot">&lt;-</span><span class="fu">cbind</span>(dataAnts<span class="sc">$</span>Latitude,dataAnts<span class="sc">$</span>Elevation,dataAnts<span class="sc">$</span>LogArea)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(newdata)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">'Latitude'</span>,<span class="st">'Elevation'</span>,<span class="st">'Log Bog area'</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>newdata<span class="ot">&lt;-</span><span class="fu">data.frame</span>(newdata)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(newdata,<span class="at">pch=</span><span class="dv">16</span>,<span class="at">col=</span><span class="st">'deepskyblue4'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-plotcollinearityscatter" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Determinants_ant_diversity_files/figure-html/fig-plotcollinearityscatter-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;9: Analyse of collinearity between independant continuous variables, scatterplot for each pair of covariates</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-paged.print="true">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating correlation for each pair of covariates</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>M<span class="ot">&lt;-</span><span class="fu">cor</span>(newdata)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot.mixed</span>(M,<span class="at">upper=</span><span class="st">"square"</span>,<span class="at">lower.col=</span><span class="st">"black"</span>, <span class="at">tl.col=</span><span class="st">"black"</span>,<span class="at">cl.cex =</span> <span class="fl">0.8</span>,<span class="at">tl.cex =</span> <span class="fl">0.7</span>,<span class="at">number.cex =</span><span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-plotcollinearityCOR" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Determinants_ant_diversity_files/figure-html/fig-plotcollinearityCOR-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;10: Analyse of collinearity between independant continuous variables, correlation for each pair of covariates</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-paged.print="true">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Checking for collinearity between categories and continuous variables</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Latitude and Location</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(dataAnts<span class="sc">$</span>Latitude<span class="sc">~</span>dataAnts<span class="sc">$</span>Location, <span class="at">varwidth =</span> <span class="cn">TRUE</span>, <span class="at">ylab =</span> <span class="st">"Latitude"</span>, <span class="at">xlab =</span> <span class="st">"Location"</span>,<span class="at">col=</span><span class="fu">c</span>(<span class="st">'saddlebrown'</span>,<span class="st">'palegreen4'</span>))</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Altitude and Location</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(dataAnts<span class="sc">$</span>Elevation<span class="sc">~</span>dataAnts<span class="sc">$</span>Location, <span class="at">varwidth =</span> <span class="cn">TRUE</span>, <span class="at">ylab =</span> <span class="st">"Elevation"</span>, <span class="at">xlab =</span> <span class="st">"Location"</span>,<span class="at">col=</span><span class="fu">c</span>(<span class="st">'saddlebrown'</span>,<span class="st">'palegreen4'</span>))</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Bog Area and Location</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(dataAnts<span class="sc">$</span>LogArea<span class="sc">~</span>dataAnts<span class="sc">$</span>Location, <span class="at">varwidth =</span> <span class="cn">TRUE</span>, <span class="at">ylab =</span> <span class="st">"Bog area"</span>, <span class="at">xlab =</span> <span class="st">"Location"</span>,<span class="at">col=</span><span class="fu">c</span>(<span class="st">'saddlebrown'</span>,<span class="st">'palegreen4'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-plotcollinearityCATCONT" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Determinants_ant_diversity_files/figure-html/fig-plotcollinearityCATCONT-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;11: Analyse of collinearity between categories and continuous variables</figcaption>
</figure>
</div>
</div>
</div>
<p>In the first graph (<a href="#fig-plotcollinearityscatter">Figure&nbsp;9</a>), we can see that the point clouds do not appear to show any trend toward collinearity. This impression is confirmed by the calculated values in the following figure (<a href="#fig-plotcollinearityCOR">Figure&nbsp;10</a>), where the values are well below 0.7, which is commonly used as a threshold for collinearity (above this, variables are considered correlated). The almost complete overlap of the boxplots (<a href="#fig-plotcollinearityCATCONT">Figure&nbsp;11</a>) further supports the non-collinearity of these factors.</p>
<p><u><strong>Conclusion</strong></u> <strong>:</strong></p>
<p>There does not appear to be any collinearity among the variables, so we can retain them all.</p>
</section>
</section>
</section>
<section id="statistical-analysis" class="level1">
<h1>STATISTICAL ANALYSIS</h1>
<section id="model-construction" class="level3">
<h3 class="anchored" data-anchor-id="model-construction"><strong>1. Model construction</strong></h3>
<p>We aim to produce the best model for predicting the number of species. The response variable is a count (a discrete quantitative variable) with small numbers (&lt;30), so the appropriate distribution is the <strong>Poisson</strong> distribution. We’re going to model it using a generalized linear Poisson model.</p>
<p>To arrive at the “candidate” model to be tested, we’ll start with the “complete” model, i.e.&nbsp;with all the explanatory variables and their interactions, and use <strong>Backward selection</strong> to select the variables and interactions to be retained.</p>
<p>Let’s start with the complete model:</p>
<div class="cell" data-paged.print="true">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># model formulation with the fonction glm() and family=poisson(link="log")</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>mod1<span class="ot">&lt;-</span><span class="fu">glm</span>(Nsp<span class="sc">~</span> Location</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> Latitude</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> Elevation</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> LogArea</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> Location<span class="sc">:</span>Latitude</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> Location<span class="sc">:</span>Elevation</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> Location<span class="sc">:</span>LogArea</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>        ,<span class="at">data=</span>dataAnts</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>        ,<span class="at">family=</span><span class="fu">poisson</span>(<span class="at">link=</span><span class="st">"log"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Based on this complete model, we will eliminate the insignificant interactions step by step.</p>
<div class="cell" data-paged.print="true">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(mod1,<span class="at">test=</span><span class="st">"Chi"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Single term deletions

Model:
Nsp ~ Location + Latitude + Elevation + LogArea + Location:Latitude + 
    Location:Elevation + Location:LogArea
                   Df Deviance    AIC     LRT Pr(&gt;Chi)
&lt;none&gt;                  39.973 216.33                 
Location:Latitude   1   39.981 214.34 0.00801   0.9287
Location:Elevation  1   40.370 214.72 0.39675   0.5288
Location:LogArea    1   40.075 214.43 0.10247   0.7489</code></pre>
</div>
</div>
<p>All three interactions are insignificant. We remove the ‘Location:Latitude’ interaction as it is the ‘least significant’. We can also see that the drop1() function informs us that it’s by removing this interaction that we get the best AIC.</p>
<p>We obtain the following model:</p>
<div class="cell" data-paged.print="true">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>mod1<span class="ot">&lt;-</span><span class="fu">glm</span>(Nsp<span class="sc">~</span> Location</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> Latitude</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> Elevation</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> LogArea</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> Location<span class="sc">:</span>Elevation</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> Location<span class="sc">:</span>LogArea</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>        ,<span class="at">data=</span>dataAnts</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>        ,<span class="at">family=</span><span class="fu">poisson</span>(<span class="at">link=</span><span class="st">"log"</span>))</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(mod1,<span class="at">test=</span><span class="st">"Chi"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Single term deletions

Model:
Nsp ~ Location + Latitude + Elevation + LogArea + Location:Elevation + 
    Location:LogArea
                   Df Deviance    AIC     LRT  Pr(&gt;Chi)    
&lt;none&gt;                  39.981 214.34                      
Latitude            1   55.094 227.45 15.1134 0.0001012 ***
Location:Elevation  1   40.426 212.78  0.4446 0.5049344    
Location:LogArea    1   40.078 212.43  0.0974 0.7550075    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>In the same way, we remove the ‘Location:LogArea’ interaction.</p>
<div class="cell" data-paged.print="true">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 3</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>mod1<span class="ot">&lt;-</span><span class="fu">glm</span>(Nsp<span class="sc">~</span> Location</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> Latitude</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> Elevation</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> LogArea</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> Location<span class="sc">:</span>Elevation</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>        ,<span class="at">data=</span>dataAnts</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>        ,<span class="at">family=</span><span class="fu">poisson</span>(<span class="at">link=</span><span class="st">"log"</span>))</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(mod1,<span class="at">test=</span><span class="st">"Chi"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Single term deletions

Model:
Nsp ~ Location + Latitude + Elevation + LogArea + Location:Elevation
                   Df Deviance    AIC     LRT  Pr(&gt;Chi)    
&lt;none&gt;                  40.078 212.43                      
Latitude            1   55.176 225.53 15.0976 0.0001021 ***
LogArea             1   40.273 210.63  0.1943 0.6593240    
Location:Elevation  1   40.499 210.85  0.4208 0.5165445    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>We also remove the ‘Location:Elevation’ interaction. We now look at the significance of the explanatory variables.</p>
<div class="cell" data-paged.print="true">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 4</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>mod1<span class="ot">&lt;-</span><span class="fu">glm</span>(Nsp<span class="sc">~</span> Location</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> Latitude</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> Elevation</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> LogArea</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>        ,<span class="at">data=</span>dataAnts</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>        ,<span class="at">family=</span><span class="fu">poisson</span>(<span class="at">link=</span><span class="st">"log"</span>))</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(mod1,<span class="at">test=</span><span class="st">"Chi"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Single term deletions

Model:
Nsp ~ Location + Latitude + Elevation + LogArea
          Df Deviance    AIC     LRT  Pr(&gt;Chi)    
&lt;none&gt;         40.499 210.85                      
Location   1   70.185 238.54 29.6856 5.081e-08 ***
Latitude   1   55.621 223.97 15.1221 0.0001008 ***
Elevation  1   49.909 218.26  9.4100 0.0021580 ** 
LogArea    1   40.690 209.04  0.1913 0.6618646    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>As the ‘LogArea’ variable does not have a siginificative effect, we eliminate it from the model.</p>
<div class="cell" data-paged.print="true">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 5</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>mod1<span class="ot">&lt;-</span><span class="fu">glm</span>(Nsp<span class="sc">~</span> Location</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> Latitude</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> Elevation</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>        ,<span class="at">data=</span>dataAnts</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>        ,<span class="at">family=</span><span class="fu">poisson</span>(<span class="at">link=</span><span class="st">"log"</span>))</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(mod1,<span class="at">test=</span><span class="st">"Chi"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Single term deletions

Model:
Nsp ~ Location + Latitude + Elevation
          Df Deviance    AIC     LRT  Pr(&gt;Chi)    
&lt;none&gt;         40.690 209.04                      
Location   1   70.376 236.73 29.6856 5.081e-08 ***
Latitude   1   56.649 223.00 15.9590 6.473e-05 ***
Elevation  1   50.284 216.64  9.5938  0.001952 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>The remaining explanatory variables are significant, so we retain this model as a candidate.</p>
<p>We will then identify the candidate model using an approach other than the significance of the p-values: the AIC with the stepwise mode.</p>
<div class="cell" data-paged.print="true">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># complete model construction</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>modelcomplet<span class="ot">&lt;-</span> <span class="fu">glm</span>(Nsp<span class="sc">~</span> Location</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> Latitude</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> Elevation</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> LogArea</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> Location<span class="sc">:</span>Latitude</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> Location<span class="sc">:</span>Elevation</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>        <span class="sc">+</span> Location<span class="sc">:</span>LogArea</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>        ,<span class="at">data=</span>dataAnts</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>        ,<span class="at">family=</span><span class="fu">poisson</span>(<span class="at">link=</span><span class="st">"log"</span>))</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="co"># model selection</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>modfinal<span class="ot">&lt;-</span><span class="fu">stepAIC</span>(modelcomplet,<span class="at">direction=</span><span class="st">"both"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=216.33
Nsp ~ Location + Latitude + Elevation + LogArea + Location:Latitude + 
    Location:Elevation + Location:LogArea

                     Df Deviance    AIC
- Location:Latitude   1   39.981 214.34
- Location:LogArea    1   40.075 214.43
- Location:Elevation  1   40.370 214.72
&lt;none&gt;                    39.973 216.33

Step:  AIC=214.34
Nsp ~ Location + Latitude + Elevation + LogArea + Location:Elevation + 
    Location:LogArea

                     Df Deviance    AIC
- Location:LogArea    1   40.078 212.43
- Location:Elevation  1   40.426 212.78
&lt;none&gt;                    39.981 214.34
+ Location:Latitude   1   39.973 216.33
- Latitude            1   55.094 227.45

Step:  AIC=212.43
Nsp ~ Location + Latitude + Elevation + LogArea + Location:Elevation

                     Df Deviance    AIC
- LogArea             1   40.273 210.63
- Location:Elevation  1   40.499 210.85
&lt;none&gt;                    40.078 212.43
+ Location:LogArea    1   39.981 214.34
+ Location:Latitude   1   40.075 214.43
- Latitude            1   55.176 225.53

Step:  AIC=210.63
Nsp ~ Location + Latitude + Elevation + Location:Elevation

                     Df Deviance    AIC
- Location:Elevation  1   40.690 209.04
&lt;none&gt;                    40.273 210.63
+ LogArea             1   40.078 212.43
+ Location:Latitude   1   40.270 212.62
- Latitude            1   56.212 224.57

Step:  AIC=209.04
Nsp ~ Location + Latitude + Elevation

                     Df Deviance    AIC
&lt;none&gt;                    40.690 209.04
+ Location:Elevation  1   40.273 210.63
+ LogArea             1   40.499 210.85
+ Location:Latitude   1   40.650 211.00
- Elevation           1   50.284 216.64
- Latitude            1   56.649 223.00
- Location            1   70.376 236.73</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># final model</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(modfinal,<span class="at">test=</span><span class="st">"Chi"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Single term deletions

Model:
Nsp ~ Location + Latitude + Elevation
          Df Deviance    AIC     LRT  Pr(&gt;Chi)    
&lt;none&gt;         40.690 209.04                      
Location   1   70.376 236.73 29.6856 5.081e-08 ***
Latitude   1   56.649 223.00 15.9590 6.473e-05 ***
Elevation  1   50.284 216.64  9.5938  0.001952 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modfinal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Nsp ~ Location + Latitude + Elevation, family = poisson(link = "log"), 
    data = dataAnts)

Coefficients:
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)    11.9368121  2.6214970   4.553 5.28e-06 ***
LocationForest  0.6354389  0.1195664   5.315 1.07e-07 ***
Latitude       -0.2357930  0.0616638  -3.824 0.000131 ***
Elevation      -0.0011411  0.0003749  -3.044 0.002337 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 102.76  on 43  degrees of freedom
Residual deviance:  40.69  on 40  degrees of freedom
AIC: 209.04

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
<p>Note: it is recommended to use AIC with more than 40 individuals per parameter, otherwise there is AICc (<span class="citation" data-cites="YannickOutreman">Outreman (<a href="#ref-YannickOutreman" role="doc-biblioref">2023</a>)</span>).</p>
<p><u><strong>Conclusion</strong></u> <strong>:</strong></p>
<p>Both methods arrive at the same candidate model: <em>Nsp~Latitude+Elevation+LogArea</em>.</p>
</section>
<section id="coefficients-analysis" class="level3">
<h3 class="anchored" data-anchor-id="coefficients-analysis"><strong>2. Coefficients analysis</strong></h3>
<p>The next step is to analyze the coefficients. We’ll be looking at the precise effect of the selected explanatory variables (Latitude, Elevation, LogArea) on ant species richness.</p>
<div class="cell" data-paged.print="true">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficients </span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Nsp ~ Location + Latitude + Elevation, family = poisson(link = "log"), 
    data = dataAnts)

Coefficients:
                 Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)    11.9368121  2.6214970   4.553 5.28e-06 ***
LocationForest  0.6354389  0.1195664   5.315 1.07e-07 ***
Latitude       -0.2357930  0.0616638  -3.824 0.000131 ***
Elevation      -0.0011411  0.0003749  -3.044 0.002337 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for poisson family taken to be 1)

    Null deviance: 102.76  on 43  degrees of freedom
Residual deviance:  40.69  on 40  degrees of freedom
AIC: 209.04

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">#                 Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="co">#(Intercept)    11.9368121  2.6214970   4.553 5.28e-06 ***</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="co">#LocationForest  0.6354389  0.1195664   5.315 1.07e-07 ***</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Latitude       -0.2357930  0.0616638  -3.824 0.000131 ***</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Elevation      -0.0011411  0.0003749  -3.044 0.002337 ** </span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Null deviance: 102.76  on 43  degrees of freedom</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Residual deviance:  40.69  on 40  degrees of freedom</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The model’s summary() allows us to see the coefficients corresponding to each variable, as well as the intercept (based on the population mean). For a factor (qualitative variable), the coefficient corresponds to the comparison between the given modality and the so-called “reference” modality, whose coefficient is equal to 0. The deviance scores will be used in the following section. This table shows the different coefficients:</p>
<p><strong>Location factor</strong><br>
- <span class="math inline">\(Location_{Bog}\)</span> = 0 (reference modality for Location)<br>
- <span class="math inline">\(Location_{Forest}\)</span> = <span class="math inline">\(+0.63^{**}\)</span><br>
<strong>Latitude covariate</strong><br>
- <span class="math inline">\(\beta_{Latitude}\)</span> = <span class="math inline">\(-0.23^{***}\)</span><br>
<strong>Elevation covariate</strong><br>
- <span class="math inline">\(\beta_{Elevation}\)</span> = <span class="math inline">\(-0.001^{***}\)</span></p>
<p>The candidate model with the coefficients is written (equation 5): <span id="eq-5"><span class="math display">\[ log(Species\:Richness) = 11.93^{***} + (Location_{Bog} = 0 ;\:Location_{Forest} = +0.63^{***})\:- 0.23^{***}.Latitude\: -0.001^{***}. Elevation   \tag{5}\]</span></span></p>
<p>Reminder: to model a discrete quantitative variable with a generalized linear model, we use a link function. Here, with Poisson distribution, we use the log() function.</p>
</section>
<section id="explanatory-power-of-the-model" class="level3">
<h3 class="anchored" data-anchor-id="explanatory-power-of-the-model"><strong>3. Explanatory power of the model</strong></h3>
<p>To determine the quality of our model, we’ll calculate the distance between the candidate model and the null model. The null model is a model that summarizes the data with a single parameter: the mean of <span class="math inline">\(Y\)</span>. This model does not explain the data.</p>
<p>One way of determining model quality is to calculate a pseudo R²*. To do this, we determine the distance between the deviance of the null model and the residual deviance of the candidate model (equation 6).</p>
<p><span id="eq-6"><span class="math display">\[Pseudo\:R^2=100\:.\:\frac{Null\:Deviance- Residual\:Deviance}{Null\:Deviance} \tag{6}\]</span></span></p>
<p>We can calculate the <em>pseudo R²</em> in three different ways: with the McFadden method, the Cox and Snell method or the Nagelkerke method. The last two methods require the ‘rcompagnon’ package.</p>
<p>In our example, as seen in the previous section, the null model has a deviance of 102.76 and the residual deviance is 40.69.</p>
<p>We will therefore calculate the quality of the model with the following lines:</p>
<div class="cell" data-paged.print="true">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate of deviance explained</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>(mod1<span class="sc">$</span>null.deviance<span class="sc">-</span>mod1<span class="sc">$</span>deviance)<span class="sc">/</span>mod1<span class="sc">$</span>null.deviance</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6040372</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Some others estimates of deviance explained - package 'rcompanion'</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rcompanion)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">nagelkerke</span>(mod1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Models
                                                                                      
Model: "glm, Nsp ~ Location + Latitude + Elevation, poisson(link = \"log\"), dataAnts"
Null:  "glm, Nsp ~ 1, poisson(link = \"log\"), dataAnts"                              

$Pseudo.R.squared.for.model.vs.null
                             Pseudo.R.squared
McFadden                             0.235913
Cox and Snell (ML)                   0.756039
Nagelkerke (Cragg and Uhler)         0.757956

$Likelihood.ratio.test
 Df.diff LogLik.diff  Chisq    p.value
      -3     -31.036 62.073 2.1197e-13

$Number.of.observations
         
Model: 44
Null:  44

$Messages
[1] "Note: For models fit with REML, these statistics are based on refitting with ML"

$Warnings
[1] "None"</code></pre>
</div>
</div>
<p>Here, the estimate of deviance explained is 60% or 75%, depending on the method used.</p>
<div class="cell" data-paged.print="true">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">fitted</span>(mod1)<span class="sc">~</span>dataAnts<span class="sc">$</span>Nsp,<span class="at">col=</span><span class="st">'dodgerblue3'</span>,<span class="at">pch=</span><span class="dv">16</span>,<span class="at">ylab=</span><span class="st">"Estimated values"</span>,<span class="at">xlab=</span><span class="st">"Observed values"</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-plotpredict" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Determinants_ant_diversity_files/figure-html/fig-plotpredict-1.png" class="img-fluid figure-img" width="576"></p>
<figcaption class="figure-caption">Figure&nbsp;12: Representation of predict values</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="model-validation" class="level3">
<h3 class="anchored" data-anchor-id="model-validation"><strong>4. Model validation</strong></h3>
<p>The <em>independence of residuals</em> is the only limitation of the generalized linear model. Analysis of the residuals therefore enables us to identify possible trends and check for the presence of influential statistical units.</p>
<p>To begin with, checking for <strong>overdispersion</strong> is essential when running a Poisson generalized linear model. For all generalized linear models using count data, we need to check for the absence of overdispersion.</p>
<p>To do this, we calculate a parameter called the ‘scale parameter’. If its value is significantly greater than 1 (from 1.6 or 1.7), there is overdispersion. The model is therefore invalid.</p>
<section id="a.-checking-for-overdispersion" class="level5">
<h5 class="anchored" data-anchor-id="a.-checking-for-overdispersion"><strong>a. Checking for overdispersion</strong></h5>
<p>When the dispersion index is greater than 1.5, there are various explanations.</p>
<p>It may be due to :</p>
<ul>
<li><p>Outliers are present in the data set. They need to be eliminated.</p></li>
<li><p>Missing covariates. They need to be added to the model.</p></li>
<li><p>Missing interactions. Add them to the model.</p></li>
<li><p>Zero inflation occurs. Use negative Binomial regression with zero inflation (<span class="citation" data-cites="Long_1997">Long (<a href="#ref-Long_1997" role="doc-biblioref">1997</a>)</span>)</p></li>
<li><p>A dependency between the data and a factor or variable is present. A general linear mixed model should be used. (<span class="citation" data-cites="Johnson_et_al_2015">Johnson P. (<a href="#ref-Johnson_et_al_2015" role="doc-biblioref">2015</a>)</span>)</p></li>
<li><p>Relationship between data and variables or factors is not linear. A generalized additive model must be used. (<span class="citation" data-cites="Irz_et_Levi-Valensin_2016">Irz P. (<a href="#ref-Irz_et_Levi-Valensin_2016" role="doc-biblioref">2015</a>)</span>)</p></li>
<li><p>The link function is bad. The link function must be changed.</p></li>
<li><p>The variation of <span class="math inline">\(Y\)</span> is large. We must use a generalized linear model following a negative binomial distribution. (<span class="citation" data-cites="Chahine_1965">J. (<a href="#ref-Chahine_1965" role="doc-biblioref">1965</a>)</span>)</p></li>
</ul>
<p>In our example, we will calculate the scale parameter. To do this, we will use the command :</p>
<div class="cell" data-paged.print="true">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scale parameter calculation</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>E1 <span class="ot">&lt;-</span> <span class="fu">resid</span>(mod1, <span class="at">type =</span> <span class="st">"pearson"</span>) <span class="co"># (Y - mu) / sqrt(mu)</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>N  <span class="ot">&lt;-</span> <span class="fu">nrow</span>(dataAnts)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>p  <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">coef</span>(mod1))</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(E1<span class="sc">^</span><span class="dv">2</span>) <span class="sc">/</span> (N <span class="sc">-</span> p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.029116</code></pre>
</div>
</div>
<p><u><strong>Conclusion</strong></u> <strong>:</strong></p>
<p>Here, dispersion is 1.02, there is no overdispersion.</p>
</section>
<section id="b.-residual-analysis" class="level5">
<h5 class="anchored" data-anchor-id="b.-residual-analysis"><strong>b. Residual analysis</strong></h5>
<p>Although the assumptions of normality and homogeneity of residuals are not expected in generalized linear models, we can analyze them graphically. By plotting the residuals against the model’s significant <span class="math inline">\(Xs\)</span>, we need to validate the absence of a trend in their distribution. If we find a trend, the modeling may be problematic: it may be due to a lack of fit, data dependency or influential observations. Remember that in generalized linear models, we use <strong>Pearson residuals</strong> because they include heterogeneity of variance and are easy to calculate and understand.</p>
<div class="cell" data-paged.print="true">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>resid<span class="ot">&lt;-</span><span class="fu">residuals</span>(mod1, <span class="at">type=</span><span class="st">"pearson"</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>))</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Histogram</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(resid,<span class="at">col=</span><span class="st">'dodgerblue3'</span>,<span class="at">xlab=</span><span class="st">"residuals"</span>,<span class="at">main=</span><span class="st">"A."</span>)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Quantile-Quantile plot</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(resid,<span class="at">pch=</span><span class="dv">16</span>,<span class="at">col=</span><span class="st">'dodgerblue3'</span>,<span class="at">xlab=</span><span class="st">''</span>, <span class="at">main=</span><span class="st">"B."</span>)</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(resid,<span class="at">col=</span><span class="st">'red'</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Residuals vs fitted</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(resid<span class="sc">~</span><span class="fu">fitted</span>(mod1)</span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>      , <span class="at">col=</span><span class="st">'dodgerblue3'</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>      , <span class="at">pch=</span><span class="dv">16</span>, <span class="at">main=</span><span class="st">"C."</span>)</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>)</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Residuals against Location factor</span></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(resid<span class="sc">~</span> dataAnts<span class="sc">$</span>Location, </span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">varwidth =</span> <span class="cn">TRUE</span>,</span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">ylab =</span> <span class="st">"Residuals"</span>,</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab =</span> <span class="st">"Location"</span>,</span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">main =</span> <span class="st">"D."</span>)</span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Residuals against Latitude</span></span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(resid<span class="sc">~</span> dataAnts<span class="sc">$</span>Latitude, </span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>         <span class="at">pch=</span><span class="dv">16</span>,</span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>         <span class="at">col=</span><span class="st">"dodgerblue3"</span>,</span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a>         <span class="at">ylab =</span> <span class="st">"Residuals"</span>,</span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab =</span> <span class="st">"Latitude"</span>,</span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a>         <span class="at">main =</span> <span class="st">"E."</span>)</span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>)</span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Residuals against Elevation</span></span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(resid<span class="sc">~</span> dataAnts<span class="sc">$</span>Elevation, </span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a>         <span class="at">pch=</span><span class="dv">16</span>,</span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a>         <span class="at">col=</span><span class="st">"dodgerblue3"</span>,</span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a>         <span class="at">ylab =</span> <span class="st">"Residuals"</span>,</span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a>         <span class="at">xlab =</span> <span class="st">"Elevation"</span>,</span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true" tabindex="-1"></a>         <span class="at">main =</span> <span class="st">"F."</span>)</span>
<span id="cb44-39"><a href="#cb44-39" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-plotresiduals" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Determinants_ant_diversity_files/figure-html/fig-plotresiduals-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;13: Analyse of residuals</figcaption>
</figure>
</div>
</div>
</div>
<p>The histogram of residuals (<a href="#fig-plotresiduals">Figure&nbsp;13</a> A) and the Q-Q plot (<a href="#fig-plotresiduals">Figure&nbsp;13</a> B) show relatively normal residuals. The following four graphs (<a href="#fig-plotresiduals">Figure&nbsp;13</a> C, D ,E and F) show the distribution of residuals according to model estimates and the three explanatory variables. We can see that the residuals remain homogeneous whatever the values of the explanatory variables.</p>
<p><u><strong>Conclusion</strong></u> <strong>:</strong></p>
<p>We can conclude there is no tendency in the residuals.</p>
</section>
<section id="c.-checking-for-influent-individuals" class="level5">
<h5 class="anchored" data-anchor-id="c.-checking-for-influent-individuals"><strong>c.&nbsp;Checking for influent individuals</strong></h5>
<div class="cell" data-paged.print="true">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">cooks.distance</span>(mod1), <span class="at">type =</span> <span class="st">"h"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">main=</span><span class="st">"Figure 26"</span>)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="dv">2</span>,<span class="at">lwd =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-plotINDIV" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Determinants_ant_diversity_files/figure-html/fig-plotINDIV-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;14: Analyse of influent individuals</figcaption>
</figure>
</div>
</div>
</div>
<p><u><strong>Conclusion</strong></u> <strong>:</strong></p>
<p>Here (<a href="#fig-plotINDIV">Figure&nbsp;14</a>), there are no overly influential individuals.</p>
</section>
<section id="d.-residual-analysis-with-dharma" class="level5">
<h5 class="anchored" data-anchor-id="d.-residual-analysis-with-dharma"><strong>d.&nbsp;Residual analysis with DHARMa</strong></h5>
<p>For a different graphical representation, we can use the ‘DHARMa’ package. This package can be used to analyze residuals, in particular overdispersion and outliers. Residuals that do not comply with expected values are highlighted in red.</p>
<div class="cell" data-paged.print="true">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># TestDispersion(mod1)</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DHARMa)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>simulationOutput <span class="ot">&lt;-</span> <span class="fu">simulateResiduals</span>(<span class="at">fittedModel =</span> mod1, <span class="at">plot =</span> F)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="fu">residuals</span>(simulationOutput)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.18239618 0.80151718 0.58807555 0.91926545 0.47936926 0.80054278
 [7] 0.21988509 0.20392550 0.63926446 0.23771974 0.93979633 1.00000000
[13] 0.55147536 0.10846697 0.10852467 0.18784519 0.67846792 0.26581684
[19] 0.48230426 0.36551653 0.66505642 0.91389210 0.90974035 0.32702672
[25] 0.27414285 0.55547244 0.04495447 0.01279264 0.77714308 0.53842229
[31] 0.80358226 0.69900441 0.77700439 0.54884684 0.66172468 0.46419915
[37] 0.30537691 0.14932406 0.82094811 0.23204016 0.13914854 0.38413168
[43] 0.14453694 0.91036913</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(simulationOutput)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">residuals</span>(simulationOutput, <span class="at">quantileFunction =</span> qnorm, <span class="at">outlierValues =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">7</span>,<span class="dv">7</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] -0.90627115  0.84705290  0.22259735  1.40014770 -0.05173666  0.84356157
 [7] -0.77258135 -0.82768134  0.35649343 -0.71365672  1.55306609  7.00000000
[13]  0.12938973 -1.23472214 -1.23441223 -0.88586483  0.46341887 -0.62551412
[19] -0.04437121 -0.34375165  0.42630289  1.36511850  1.33915783 -0.44813823
[25] -0.60033094  0.13949991 -1.69587828 -2.23244931  0.76258012  0.09645977
[31]  0.85448653  0.52153923  0.76211526  0.12274843  0.41717468 -0.08986022
[37] -0.50899774 -1.03933681  0.91898431 -0.73214458 -1.08415273 -0.29464726
[43] -1.06015545  1.34303160</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-plotDharma" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Determinants_ant_diversity_files/figure-html/fig-plotDharma-1.png" class="img-fluid figure-img" width="576"></p>
<figcaption class="figure-caption">Figure&nbsp;15: Dharma</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-paged.print="true">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Residuals with covariate</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plotResiduals</span>(simulationOutput, <span class="at">form =</span> dataAnts<span class="sc">$</span>Latitude)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-plotDharma2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Determinants_ant_diversity_files/figure-html/fig-plotDharma2-1.png" class="img-fluid figure-img" width="576"></p>
<figcaption class="figure-caption">Figure&nbsp;16: Dharma</figcaption>
</figure>
</div>
</div>
</div>
<p><u><strong>Conclusion</strong></u> <strong>:</strong></p>
<p>In our example, the residuals are not overdispersed and show no outliers (<a href="#fig-plotDharma">Figure&nbsp;15</a>, <a href="#fig-plotDharma2">Figure&nbsp;16</a>).</p>
</section>
</section>
</section>
<section id="conclusion" class="level1">
<h1>CONCLUSION</h1>
<p>The selected model is (equation 5):</p>
<p><span class="math display">\[ log(Species\:Richness) = 11.93^{***} + (Location_{Bog} = 0 ;\:Location_{Forest} = +0.63^{***})\:- 0.23^{***}.Latitude\: -0.001^{***}. Elevation  \]</span></p>
<p>Its dispersion index is estimated at 1.02, indicating the absence of overdispersion, which validates our model.</p>
<p>Furthermore, we detect no influential data points that could bias the model.</p>
<p>The estimated pseudo R² of 0.60 suggests that this model effectively explains our data (the null model deviance is 102.76, while the residual deviance is 40.69).</p>
<p>We conclude that ant species richness in the New England bogs depends on:</p>
<ul>
<li><p><strong>Location</strong>: Species richness is higher in forests than in bogs, linked to vegetation cover and available light;</p></li>
<li><p><strong>Latitude</strong>: Species richness decreases with increasing latitude;</p></li>
<li><p><strong>Elevation</strong>: Although its effect is smaller, elevation also influences species richness.</p></li>
</ul>
<p>In both forests and bogs, latitude is the most significant predictor of species density.</p>
<p>However, further research on a larger scale is necessary to generalize these findings, as this study covers only a limited geographical area with two habitat types.</p>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-Zuur_2010" class="csl-entry" role="listitem">
Alain F. Zuur, Chris S. Elphick, Elena N. Ieno. 2010. <span>“A Protocol for Data Exploration to Avoid Commonstatistical Problems.”</span> <em>METHODS IN ECOLOGY AND EVOLUTION</em> 1: 3–14.
</div>
<div id="ref-Irz_et_Levi-Valensin_2016" class="csl-entry" role="listitem">
Irz P., Levi-Valensin M. 2015. <span>“Tendance Nationale de l’indice Poisson Rivière (IPR) Estimée Par Un Modèle Additif Généralisé (GAM),”</span> February.
</div>
<div id="ref-Chahine_1965" class="csl-entry" role="listitem">
J., Chahine. 1965. <span>“Une Généralisation de La Loi Binomiale Négative.”</span> <em>REVUE DE STATISTIQUE APPLIQUÉE</em> 13 (4): 33–43.
</div>
<div id="ref-Johnson_et_al_2015" class="csl-entry" role="listitem">
Johnson P., Ferguson H., Barry S. 2015. <span>“Power Analysis for Generalized Linear Mixed Models in Ecology and Evolution.”</span> <em>Methods in Ecology and Evolution</em> 6 (2): 133–42.
</div>
<div id="ref-Long_1997" class="csl-entry" role="listitem">
Long, J. S. 1997. <span>“Regression Models for Categorical and Limited Dependent Variables”</span> 7 (January).
</div>
<div id="ref-Gotelli_2002" class="csl-entry" role="listitem">
Nicholas J. Gotelli, Aaron M. Ellison. 2002. <span>“Biogeography at a Regional Scale : Determinants of Ant Species Density in New England Bogs and Forests.”</span> <em>ECOLOGY</em> 83 (6): 1604–9.
</div>
<div id="ref-YannickOutreman" class="csl-entry" role="listitem">
Outreman, Y. 2023. <span>“Courses on Linear Mixed Model.”</span>
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>