---

title: "Exploration données sur les manchots"
group: "CHOULETTE Klervi, DENIS Manon, DUPORT Maureen, MOTTE Arthur, POYARD Antoine, SESIA Marion, TANGUY Céline" 

bibliography: references.bib
execute: 
  freeze: auto
output: 
  html_document:
   toc: true
   toc_float: true
---

```{r}
library(factoextra)
library(FactoMineR)
library(tidyverse)
library(dplyr)
library(ggplot2)
```


## Dataset presentation : 

**Columns name :**

 - studyName :Sampling expedition from which data were collected, generated, etc.  
 - Sample Number : an integer denoting the continuous numbering sequence for each sample  
 - Species : a character string denoting the penguin species  
 - Region : a character string denoting the region of Palmer LTER sampling grid  
 - Island : a character string denoting the island near Palmer Station where samples were collected  
 - Stage : a character string denoting reproductive stage at sampling  
 - Individual ID : a character string denoting the unique ID for each individual in dataset  
 - Clutch Completion : a character string denoting if the study nest observed with a full clutch, i.e., 2 eggs  
 - Date Egg : a date denoting the date study nest observed with 1 egg (sampled)  
 - Culmen Length : a number denoting the length of the dorsal ridge of a bird's bill (millimeters)  
 - Culmen Depth : a number denoting the depth of the dorsal ridge of a bird's bill (millimeters)  
 - Flipper Length : an integer denoting the length penguin flipper (millimeters)  
 - Body Mass : an integer denoting the penguin body mass (grams)  
 - Sex : a character string denoting the sex of an animal  
 - Delta 15 N : a number denoting the measure of the ratio of stable isotopes 15N:14N  
 - Delta 13 C : a number denoting the measure of the ratio of stable isotopes 13C:12C  
 - Comments : a character string with text providing additional relevant information for data  


```{r}
data <- read.table("penguins_raw.csv", sep = "," , header = TRUE, stringsAsFactors = T)
summary(data)
dim(data)
```

Change species names :  
```{r}
data = data %>%
  mutate(Species = recode(Species, "Adelie Penguin (Pygoscelis adeliae)" = "Adelie", "Chinstrap penguin (Pygoscelis antarctica)" = "Chinstrap", "Gentoo penguin (Pygoscelis papua)" = "Gentoo"))
```


Distribution of species between the islands :  

```{r}
table(data$Island, data$Species)
```

Some graphs :

```{r}
ggplot(data, aes(x = Flipper.Length..mm., y = Body.Mass..g., color = Species))+
  geom_point()+
  theme_classic()
```

```{r}
ggplot(data, aes(x = Culmen.Length..mm., y = Culmen.Depth..mm., color = Species))+
  geom_point()+
  theme_classic()
```

```{r}
ggplot(data, aes(x = Delta.15.N..o.oo., y = Delta.13.C..o.oo., color = Species, shape = Island))+
  geom_point()+
  theme_classic()
```

```{r}
#Selection of quantitative data
data_numeric <- select_if(data, is.numeric)

#Removal of quantitative variables that are qualitative
#Correlation between body mass and flipper ( 80%), flipper suppression
data_numeric <- data_numeric[,-c(1,2,5)]

#focus and reduce data
data_scales <- scale(data_numeric)

#PCA realization
acp_data= PCA(data_scales, graph = F)
summary(acp_data)
#cercle des corrélations
fviz_pca_var(acp_data)

#Variances pour chaque composantes
fviz_eig(acp_data)

#contribution des variables pour chaque axe
fviz_contrib(acp_data, choice="var", axes=1) #axe 1
fviz_contrib(acp_data, choice="var", axes=2) #axe 1

#Projection des individus et coloration en fonction de l'espèce
fviz_pca_ind(acp_data, geom.ind = "point", habillage = data$Species, addEllipses = T, pointshape = 19)

#Projection of variables and individuals according to species
fviz_pca_biplot(acp_data, label="var", habillage=data$Species, title = "Projection of variables and individuals according to species", ylim=c(-3,3.5), xlim = c(-3.5,3.5))

#Projection des individus et coloration en fonction de l'île
fviz_pca_ind(acp_data, geom.ind = "point", habillage = data$Island, addEllipses = T, pointshape = 19)
#Projection of variables and individuals according to island
fviz_pca_biplot(acp_data, label="var", habillage=data$Island, title = "Projection of variables and individuals according to island", ylim=c(-3,3.5),xlim = c(-3.5,3.5))

```
```{r}
```


```{r NA}

data2 <-data[,1:17]
data2
NA_df <- (colSums(is.na(data2)) / nrow(data2)) * 100

color_pal <- colorRampPalette(c("limegreen", "yellow", "firebrick"), bias = 20)(10)
NA_col <- color_pal[as.integer(NA_df/length(NA_df)*9)+1]

# Graphique
barplot(NA_df, main = "NA quantity per column",
        ylab = "NA", col = NA_col, las=2, cex.names=0.4)

NA_mean<-mean(NA_df)
# 0.78% 

abline(h=NA_mean, col = "red", lwd = 2)

```


```{r violin}

# Violin plot for Culmen Length (beak length)
ggplot(data, aes(x = Species, y = Culmen.Length..mm., fill = Species)) +
  geom_violin(trim = FALSE) +
  geom_jitter(shape = 16, position = position_jitter(0.2), color = "black", alpha = 0.3) +
    stat_summary(fun = mean, geom = "point", shape = 20, size = 3, fill = "red", color = "red") +
  labs(title = "Distribution of Culmen Length by Species",
       x = "Species",
       y = "Culmen Length (mm)") +
  theme_minimal() +
  theme(legend.position = "none")

# Violin plot for Flipper Length
ggplot(data, aes(x = Species, y = Flipper.Length..mm., fill = Species)) +
  geom_violin(trim = FALSE) +
  geom_jitter(shape = 16, position = position_jitter(0.2), color = "black", alpha = 0.3) +
    stat_summary(fun = mean, geom = "point", shape = 20, size = 3, fill = "red", color = "red") +
  labs(title = "Distribution of Flipper Length by Species",
       x = "Species",
       y = "Flipper Length (mm)") +
  theme_minimal() +
  theme(legend.position = "none")

# Violin plot for Body Mass
ggplot(data, aes(x = Species, y = Body.Mass..g., fill = Species)) +
  geom_violin(trim = FALSE) +
  geom_jitter(shape = 16, position = position_jitter(0.2), color = "black", alpha = 0.3) +
    stat_summary(fun = mean, geom = "point", shape = 20, size = 3, fill = "red", color = "red") +
  labs(title = "Distribution of Body Mass by Species",
       x = "Species",
       y = "Body Mass (g)") +
  theme_minimal() +
  theme(legend.position = "none")

```

